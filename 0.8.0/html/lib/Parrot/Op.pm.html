<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
    <HEAD>
        <TITLE>Parrot Operation</TITLE>
        <LINK REL="stylesheet" TYPE="text/css"
            HREF="../../../resources/perl.css"
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY>
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">Parrot Operation</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../../html/index.html">Contents</a> | <a href="../../../html/perl.html">Perl Modules</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<h1><a name="NAME"
>NAME <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h1>

<p>Parrot::Op &#45; Parrot Operation</p>

<h1><a name="SYNOPSIS"
>SYNOPSIS <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h1>

<pre lang='und' xml:lang='und'>  use Parrot::Op;</pre>

<h1><a name="DESCRIPTION"
>DESCRIPTION <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h1>

<p><code lang='und' xml:lang='und'>Parrot::Op</code> represents a Parrot operation (op, for short), as read from an ops file via <code lang='und' xml:lang='und'><a href='OpsFile.pm.html'>Parrot::OpsFile</a></code>, or perhaps even generated by some other means. It is the Perl equivalent of the <code lang='und' xml:lang='und'>op_info_t</code> C <code lang='und' xml:lang='und'>struct</code> defined in <em lang='und' xml:lang='und'>include/parrot/op.h</em>.</p>

<h2><a name="Op_Type"
>Op Type <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h2>

<p>Ops are either <i>auto</i> or <i>manual</i>. Manual ops are responsible for having explicit next&#45;op <code lang='und' xml:lang='und'>RETURN()</code> statements, while auto ops can count on an automatically generated next&#45;op to be appended to the op body.</p>

<p>Note that <em lang='und' xml:lang='und'><a href="../../tools/build/ops2c.pl.html">tools/build/ops2c.pl</a></em> supplies either &#39;inline&#39; or &#39;function&#39; as the op&#39;s type, depending on whether the <code lang='und' xml:lang='und'>inline</code> keyword is present in the op definition. This has the effect of causing all ops to be considered manual.</p>

<h2><a name="Op_Arguments"
>Op Arguments <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h2>

<p>Note that argument 0 is considered to be the op itself, with arguments 1..9 being the arguments passed to the op.</p>

<p>Op argument direction and type are represented by short one or two letter descriptors.</p>

<p>Op Direction:</p>

<pre lang='und' xml:lang='und'>    i   The argument is incoming
    o   The argument is outgoing
    io  The argument is both incoming and outgoing</pre>

<p>Op Type:</p>

<pre lang='und' xml:lang='und'>    i   The argument is an integer register index.
    n   The argument is a number register index.
    p   The argument is a PMC register index.
    s   The argument is a string register index.
    ic  The argument is an integer constant (in&#45;line).
    nc  The argument is a number constant index.
    pc  The argument is a PMC constant index.
    sc  The argument is a string constant index.
    kc  The argument is a key constant index.
    ki  The argument is a key integer register index.
    kic  The argument is a key integer constant (in&#45;line).</pre>

<h2><a name="Class_Methods"
>Class Methods <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h2>

<dl>
<dt><a name="new($code,_$type,_$name,_$args,_$argdirs,_$labels,_$flags)"
><b><code lang='und' xml:lang='und'>new($code, $type, $name, $args, $argdirs, $labels, $flags)</b></code></a></dt><p class="pad"></p>

<dd>Allocates a new bodyless op. A body must be provided eventually for the op to be usable.</dd><p class="pad"></p>

<dd><code lang='und' xml:lang='und'>$code</code> is the integer identifier for the op.</dd><p class="pad"></p>

<dd><code lang='und' xml:lang='und'>$type</code> is the type of op (see the note on op types above).</dd><p class="pad"></p>

<dd><code lang='und' xml:lang='und'>$name</code> is the name of the op.</dd><p class="pad"></p>

<dd><code lang='und' xml:lang='und'>$args</code> is a reference to an array of argument type descriptors.</dd><p class="pad"></p>

<dd><code lang='und' xml:lang='und'>$argdirs</code> is a reference to an array of argument direction descriptors. Element <i>x</i> is the direction of argument <code lang='und' xml:lang='und'>$args&#45;&#62;[<i>x</i>]</code>.</dd><p class="pad"></p>

<dd><code lang='und' xml:lang='und'>$labels</code> is a reference to an array of boolean values indicating whether each argument direction was prefixed by &#39;<code lang='und' xml:lang='und'>label</code>&#39;.</dd><p class="pad"></p>

<dd><code lang='und' xml:lang='und'>$flags</code> is a hash reference containing zero or more <i>hints</i> or <i>directives</i>.</dd><p class="pad"></p>
</dl>

<h2><a name="Instance_Methods"
>Instance Methods <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h2>

<dl>
<dt><a name="code()"
><b><code lang='und' xml:lang='und'>code()</b></code></a></dt><p class="pad"></p>

<dd>Returns the op code.</dd><p class="pad"></p>

<dt><a name="type()"
><b><code lang='und' xml:lang='und'>type()</b></code></a></dt><p class="pad"></p>

<dd>The type of the op, either &#39;inline&#39; or &#39;function&#39;.</dd><p class="pad"></p>

<dt><a name="name()"
><b><code lang='und' xml:lang='und'>name()</b></code></a></dt><p class="pad"></p>

<dd>The (short or root) name of the op.</dd><p class="pad"></p>

<dt><a name="full_name()"
><b><code lang='und' xml:lang='und'>full_name()</b></code></a></dt><p class="pad"></p>

<dd>For argumentless ops, it&#39;s the same as <code lang='und' xml:lang='und'>name()</code>. For ops with arguments, an underscore followed by underscore&#45;separated argument types are appended to the name.</dd><p class="pad"></p>

<dt><a name="func_name()"
><b><code lang='und' xml:lang='und'>func_name()</b></code></a></dt><p class="pad"></p>

<dd>The same as <code lang='und' xml:lang='und'>full_name()</code>, but with &#39;<code lang='und' xml:lang='und'>Parrot_</code>&#39; prefixed.</dd><p class="pad"></p>

<dt><a name="arg_types()"
><b><code lang='und' xml:lang='und'>arg_types()</b></code></a></dt><p class="pad"></p>

<dd>Returns the types of the op&#39;s arguments.</dd><p class="pad"></p>

<dt><a name="arg_type($index)"
><b><code lang='und' xml:lang='und'>arg_type($index)</b></code></a></dt><p class="pad"></p>

<dd>Returns the type of the op&#39;s argument at <code lang='und' xml:lang='und'>$index</code>.</dd><p class="pad"></p>

<dt><a name="arg_dirs()"
><b><code lang='und' xml:lang='und'>arg_dirs()</b></code></a></dt><p class="pad"></p>

<dd>Returns the directions of the op&#39;s arguments.</dd><p class="pad"></p>

<dt><a name="labels()"
><b><code lang='und' xml:lang='und'>labels()</b></code></a></dt><p class="pad"></p>

<dd>Returns the labels.</dd><p class="pad"></p>

<dt><a name="flags(@flags)"
><b><code lang='und' xml:lang='und'>flags(@flags)</b></code></a></dt><p class="pad"></p>

<dt><a name="flags()"
><b><code lang='und' xml:lang='und'>flags()</b></code></a></dt><p class="pad"></p>

<dd>Sets/gets the op&#39;s flags. This returns a hash reference, whose keys are any flags (passed as &#34;:flag&#34;) specified for the op.</dd><p class="pad"></p>

<dt><a name="arg_dir($index)"
><b><code lang='und' xml:lang='und'>arg_dir($index)</b></code></a></dt><p class="pad"></p>

<dd>Returns the direction of the op&#39;s argument at <code lang='und' xml:lang='und'>$index</code>.</dd><p class="pad"></p>

<dt><a name="body($body)"
><b><code lang='und' xml:lang='und'>body($body)</b></code></a></dt><p class="pad"></p>

<dt><a name="body()"
><b><code lang='und' xml:lang='und'>body()</b></code></a></dt><p class="pad"></p>

<dd>Sets/gets the op&#39;s code body.</dd><p class="pad"></p>

<dt><a name="jump($jump)"
><b><code lang='und' xml:lang='und'>jump($jump)</b></code></a></dt><p class="pad"></p>

<dt><a name="jump()"
><b><code lang='und' xml:lang='und'>jump()</b></code></a></dt><p class="pad"></p>

<dd>Sets/gets a string containing one or more <code lang='und' xml:lang='und'>op_jump_t</code> values joined with <code lang='und' xml:lang='und'>|</code> (see <em lang='und' xml:lang='und'>include/parrot/op.h</em>). This indicates if and how an op may jump.</dd><p class="pad"></p>

<dt><a name="full_body()"
><b><code lang='und' xml:lang='und'>full_body()</b></code></a></dt><p class="pad"></p>

<dd>For manual ops, <code lang='und' xml:lang='und'>full_body()</code> is the same as <code lang='und' xml:lang='und'>body()</code>. For auto ops this method adds a final <code lang='und' xml:lang='und'>goto NEXT()</code> line to the code to represent the auto&#45;computed return value. See the note on op types above.</dd><p class="pad"></p>

<dt><a name="rewrite_body($body,_$trans)"
><b><code lang='und' xml:lang='und'>rewrite_body($body, $trans)</b></code></a></dt><p class="pad"></p>

<dd>Performs the various macro substitutions using the specified transform, correctly handling nested substitions, and repeating over the whole string until no more substitutions can be made.</dd><p class="pad"></p>

<dd><code lang='und' xml:lang='und'>VTABLE_</code> macros are enforced by converting <code lang='und' xml:lang='und'><i>x</i>&#45;&#62;vtable&#45;&#62;<i>method</i></code> to <code lang='und' xml:lang='und'>VTABLE_<i>method</i></code>.</dd><p class="pad"></p>

<dt><a name="source($trans)"
><b><code lang='und' xml:lang='und'>source($trans)</b></code></a></dt><p class="pad"></p>

<dd>Returns the <a href='TODO'><code lang='und' xml:lang='und'>full_body()</code></a> of the op with substitutions made by <code lang='und' xml:lang='und'>$trans</code> (a subclass of <code lang='und' xml:lang='und'><a href='OpTrans.pm.html'>Parrot::OpTrans</a></code>).</dd><p class="pad"></p>

<dt><a name="size()"
><b><code lang='und' xml:lang='und'>size()</b></code></a></dt><p class="pad"></p>

<dd>Returns the op&#39;s number of arguments. Note that this also includes the op itself as one argument.</dd><p class="pad"></p>
</dl>

<h1><a name="SEE_ALSO"
>SEE ALSO <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h1>

<dl>
<dt><a name="Parrot::OpsFile"
><b><code lang='und' xml:lang='und'><a href='OpsFile.pm.html'>Parrot::OpsFile</a></b></code></a></dt><p class="pad"></p>

<dt><a name="Parrot::OpTrans"
><b><code lang='und' xml:lang='und'><a href='OpTrans.pm.html'>Parrot::OpTrans</a></b></code></a></dt><p class="pad"></p>

<dt><a name="tools/build/ops2c.pl"
><em lang='und' xml:lang='und'><a href="../../tools/build/ops2c.pl.html">tools/build/ops2c.pl</a></em></a></dt><p class="pad"></p>

<dt><a name="tools/build/ops2pm.pl"
><em lang='und' xml:lang='und'><a href="../../tools/build/ops2pm.pl.html">tools/build/ops2pm.pl</a></em></a></dt><p class="pad"></p>

<dt><a name="tools/build/pbc2c.pl"
><em lang='und' xml:lang='und'>tools/build/pbc2c.pl</em></a></dt><p class="pad"></p>
</dl>

<h1><a name="HISTORY"
>HISTORY <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h1>

<p>Author: Gregor N. Purdy &#60;gregor@focusresearch.com&#62;</p>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../../resources/parrot_small.png"
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
