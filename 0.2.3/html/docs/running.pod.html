<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>  
    <HEAD>
        <TITLE>Running Parrot</TITLE>
        <LINK REL="stylesheet" TYPE="text/css" 
            HREF="../../resources/perl.css" 
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY> 
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">Running Parrot</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../html/index.html">Contents</a> | <a href="../../html/docs.html">Documentation</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<h1><a name="NAME"
>NAME <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h1>

<p>docs/running.pod &#45; Running Parrot</p>

<h1><a name="Running_Parrot_code"
>Running Parrot code <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h1>

<p>This file briefly describes the current set of executables and what they&#39;re for.</p>

<dl>
<dt><a name="parrot"
><b><code lang='und' xml:lang='und'>parrot</b></code></a></dt><p class="pad"></p>

<dd>Interprets a Parrot bytecode file:</dd><p class="pad"></p>

<pre lang='und' xml:lang='und'>  parrot foo.pbc</pre>

<dd>or a Parrot assembly file:</dd><p class="pad"></p>

<pre lang='und' xml:lang='und'>  parrot foo.pasm</pre>

<dd>In the latter case, the file is assembled into an internally&#45;resident bytecode file and then immediately run. To alternatively create a bytecode file on disk, use the <code lang='und' xml:lang='und'>&#45;o</code> flag:</dd><p class="pad"></p>

<pre lang='und' xml:lang='und'>  parrot &#45;o foo.pbc foo.pasm</pre>

<dd>This creates a bytecode file called <code lang='und' xml:lang='und'>foo.pbc</code>, but does not execute it.</dd><p class="pad"></p>

<dd>Any command line arguments from the filename on (i.e. the rest of <code lang='und' xml:lang='und'>argv</code>) are placed into an SArray PMC which is passed into the program in PMC register P5. For the invocation:</dd><p class="pad"></p>

<pre lang='und' xml:lang='und'>  parrot foo.pbc &#45;&#45;foo_arg process_me.foo</pre>

<dd>the PMC in P5 would have three string elements: <code lang='und' xml:lang='und'>foo.pbc</code>, <code lang='und' xml:lang='und'>&#45;&#45;foo_arg</code>, and <code lang='und' xml:lang='und'>process_me.foo</code>.</dd><p class="pad"></p>

<dd><code lang='und' xml:lang='und'>parrot</code> has four different opcode dispatchers: normal, computed goto, prederef, and JIT. The default mode is normal, or computed goto if that is supported by your compiler (gcc supports it). You may pass the <code lang='und' xml:lang='und'>&#45;g</code> flag to <code lang='und' xml:lang='und'>parrot</code> to use the normal dispatcher even if you have computed goto available. Prederef mode is specified with <code lang='und' xml:lang='und'>&#45;P</code>, JIT mode with <code lang='und' xml:lang='und'>&#45;j</code>.</dd><p class="pad"></p>

<dd>Prederef mode previously only worked as a shared library. To revert to that state, add <code lang='und' xml:lang='und'>#define DYNAMIC_OPLIBS</code> to the top of <em lang='und' xml:lang='und'>interpreter.c</em>. Then, on most Unix platforms:</dd><p class="pad"></p>

<pre lang='und' xml:lang='und'>  make clean
  make shared
  LD_LIBRARY_PATH=blib/lib ./parrot &#45;P foo.pbc</pre>

<dd>You will not be able to use any of the automatic testing targets after running <code lang='und' xml:lang='und'>make shared</code>.</dd><p class="pad"></p>

<dd><code lang='und' xml:lang='und'>parrot</code> also has several debugging and tracing flags; see the usage description (generated by <code lang='und' xml:lang='und'>parrot &#45;h</code>) for details.</dd><p class="pad"></p>

<dd>For example <code lang='und' xml:lang='und'>parrot &#45;t</code> will trace the execution of the Parrot opcodes. The values of the registers are shown as they are before the opcode is executed.</dd><p class="pad"></p>

<dt><a name="make_test"
><b>make test</b></a></dt><p class="pad"></p>

<dd><code lang='und' xml:lang='und'>make test</code> will compile anything that needs to be compiled and run all standard regression tests, with garbage collection/memory management debugging enabled. (Collectively called GC_DEBUG, this is accomplished by either passing the &#45;&#45;gc&#45;debug flag to the parrot binary, or setting the environment variable $PARROT_GC_DEBUG.)</dd><p class="pad"></p>

<dd>To look at a test more closely, run the appropriate test file in the t/ directory:</dd><p class="pad"></p>

<pre lang='und' xml:lang='und'>  perl &#45;Ilib t/op/basic.t</pre>

<dd>To avoid keeping copies of all of the test <code lang='und' xml:lang='und'>.pasm</code> and <code lang='und' xml:lang='und'>.pbc</code> files generated, set the environment variable $POSTMORTEM to 0:</dd><p class="pad"></p>

<pre lang='und' xml:lang='und'>  env POSTMORTEM=0 perl &#45;Ilib t/op/basic.t
  ls t/op/basic*</pre>

<dd>To run makefile tests with a different dispatcher, set the $TEST_PROG_ARGS variable:</dd><p class="pad"></p>

<pre lang='und' xml:lang='und'>  make test TEST_PROG_ARGS=&#45;P # Use prederef mode</pre>

<dd>For running individual tests, set the environment variable $TEST_PROG_ARGS:</dd><p class="pad"></p>

<pre lang='und' xml:lang='und'>  env TEST_PROG_ARGS=&#45;j perl &#45;Ilib t/op/basic.t</pre>

<dd>To run the tests under all available dispatchers, use the &#39;fulltest&#39; target:</dd><p class="pad"></p>

<pre lang='und' xml:lang='und'>  make fulltest</pre>
</dl>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../resources/parrot.small.png" 
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
