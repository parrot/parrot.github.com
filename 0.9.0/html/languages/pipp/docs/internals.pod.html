<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
    <HEAD>
        <TITLE>Design and Implementation of Pipp</TITLE>
        <LINK REL="stylesheet" TYPE="text/css"
            HREF="../../../../resources/perl.css"
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY>
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">Design and Implementation of Pipp</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../../../html/index.html">Contents</a> | <a href="../../../../html/languages.html">Language Implementations</a> | <a href="../../../../html/pipp.html">Pipp</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<h1><a name="TITLE"
>TITLE <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>internals &#45; Design and Implementation of Pipp</p>

<h1><a name="Source_code"
>Source code <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>See <a href='TODO'>pipp.pod</a> on where to get the code.</p>

<h1><a name="Issue_tracking"
>Issue tracking <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>Not decided yet.
Will be documented in <a href='TODO'>pipp.pod</a>.
See also <em>../ROADMAP</em>.</p>

<h1><a name="Testing"
>Testing <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>See <a href='TODO'>testing.pod</a>.</p>

<h1><a name="Parsing"
>Parsing <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>Parsing is done with Parrot Compiler Toolkit,
PCT.</p>

<h1><a name="Bytecode_generation"
>Bytecode generation <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>The parse tree is transformed to a Parrot Abstrace Syntax Tree.
PIR und Bytecode is then generated from the PAST.</p>

<h1><a name="Variables"
>Variables <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>List of scopes and types of variables.</p>

<dl>
<dt><a name="globals_in_top_file"
>globals in top file</a></dt>
Lexical.
Might need extra treatment.
<dt><a name="globals_in_included_files"
>globals in included files</a></dt>
Lexical in scope of the included file.
<dt><a name="Class_constants"
>Class constants</a></dt>
Class constants are stored a package variables in the namespace $?NS ~ &#39;\\&#39; ~ $?CLASS ~ &#39;::&#39;.
The trailing &#39;::&#39; guarantees that there is no conflict with namespace constants.TODO: make them readonly
<dt><a name="Static_class_members"
>Static class members</a></dt>
Like class constants,
but writable.
<dt><a name="Class_members"
>Class members</a></dt>

<dt><a name="function_and_method_scope"
>function and method scope</a></dt>
Lexical is scope of the function or method.
<dt><a name="$this"
>$this</a></dt>
Bound to register <code>self</code>.
<dt><a name="constants"
>constants</a></dt>
Currently constants are stored in the hash [&#39;pipp&#39;; &#39;php_constants&#39;].
The functions <code>define</code> and <code>defined</code> access this package scoped hash.
This approach works good enough for constants in the global namespace.
For namespaced constants the above approach could be extended to consider the namespace part of the constant,
the current namespace and the active namespace aliases.Another approach is to treat constants as namespaced variables and work with standard PAST techniques.
Experiments using that approach are underway.</dl>

<h1><a name="Functions_and_closures"
>Functions and closures <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>TODO: type hints in function declarations</p>

<h2><a name="Builtin_functions"
>Builtin functions <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<h2><a name="Closures"
>Closures <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>There is a major bug in the implementation.
TODO: see <code>t/php/closures.t</code></p>

<h2><a name="Internal_functions"
>Internal functions <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<h1><a name="Object_orientation"
>Object orientation <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<h1><a name="Namespaces"
>Namespaces <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>A namespace is introduced with the keyword <b>namespace</b>.
The namespaced code can be enclosed in brackets.
The namespace declaration needs to be the first statement in the file.
With brackets,
there can be multiple namespaces per file.
Nesting is not possible.
Namespaces don&#39;t carry over to included files.
<b>define()</b> doesn&#39;t define in the current namespace.
The backslash character serves as the namespace separator.
Short names can be defined with <b>use</b>.
Only classes,
functions and constants are namespaced.
The current namespace can be queried with <b>__NAMESPACE__</b>.
Namespaces are case insensitive.
No global code can precede the first <b>namespace</b> directive.</p>

<h2><a name="Implementation_in_Pipp"
>Implementation in Pipp <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>In order to ease implementation and testing,
there are some divergences in Pipp.</p>

<dl>
<dt><a name="Only_the_bracketed_syntax_is_supported."
>Only the bracketed syntax is supported.</a></dt>

<dt><a name="Code_outside_the_scope_of_namespaces_directives_is_allowed."
>Code outside the scope of namespaces directives is allowed.</a></dt>

<dt><a name="&#39;const&#39;_outside_a_declared_namespace_is_allowed."
>&#39;const&#39; outside a declared namespace is allowed.</a></dt>
</dl>

<h2><a name="SEE_ALSO"
>SEE ALSO <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<dl>
<dt><a name="http://docs.php.net/manual/en/language.namespaces.php"
><a href='http://docs.php.net/manual/en/language.namespaces.php'><a href="http://docs.php.net/manual/en/language.namespaces.php">http://docs.php.net/manual/en/language.namespaces.php</a></a></a></dt>

<dt><a name="http://docs.php.net/manual/en/language.namespaces.faq.php"
><a href='http://docs.php.net/manual/en/language.namespaces.faq.php'><a href="http://docs.php.net/manual/en/language.namespaces.faq.php">http://docs.php.net/manual/en/language.namespaces.faq.php</a></a></a></dt>

<dt><a name="http://wiki.php.net/rfc/namespaces"
><a href='http://wiki.php.net/rfc/namespaces'><a href="http://wiki.php.net/rfc/namespaces">http://wiki.php.net/rfc/namespaces</a></a></a></dt>

<dt><a name="http://wiki.php.net/rfc/namespaceseparator"
><a href='http://wiki.php.net/rfc/namespaceseparator'><a href="http://wiki.php.net/rfc/namespaceseparator">http://wiki.php.net/rfc/namespaceseparator</a></a></a></dt>

<dt><a name="http://wiki.php.net/rfc/backslashnamespaces"
><a href='http://wiki.php.net/rfc/backslashnamespaces'><a href="http://wiki.php.net/rfc/backslashnamespaces">http://wiki.php.net/rfc/backslashnamespaces</a></a></a></dt>

<dt><a name="http://wiki.php.net/rfc/namespacecurlies"
><a href='http://wiki.php.net/rfc/namespacecurlies'><a href="http://wiki.php.net/rfc/namespacecurlies">http://wiki.php.net/rfc/namespacecurlies</a></a></a></dt>

<dt><a name="http://wiki.php.net/rfc/namespaceref"
><a href='http://wiki.php.net/rfc/namespaceref'><a href="http://wiki.php.net/rfc/namespaceref">http://wiki.php.net/rfc/namespaceref</a></a></a></dt>

<dt><a name="http://inside.webfactory.de/en/blog/php&#45;namespaces&#45;explained.html"
><a href='http://inside.webfactory.de/en/blog/php&#45;namespaces&#45;explained.html'><a href="http://inside.webfactory.de/en/blog/php&#45;namespaces&#45;explained.html">http://inside.webfactory.de/en/blog/php&#45;namespaces&#45;explained.html</a></a></a></dt>

<dt><a name="http://marc.info/?l=php&#45;internals&#38;m=121527668606247"
><a href='http://marc.info/?l=php&#45;internals&#38;m=121527668606247'><a href="http://marc.info/?l=php&#45;internals&#38;m=121527668606247">http://marc.info/?l=php&#45;internals&#38;m=121527668606247</a></a></a></dt>

<dt><a name="http://bugs.php.net/bug.php?id=46304"
><a href='http://bugs.php.net/bug.php?id=46304'><a href="http://bugs.php.net/bug.php?id=46304">http://bugs.php.net/bug.php?id=46304</a></a></a></dt>

<dt><a name="http://loveandtheft.org/2008/10/26/set&#45;sail&#45;for&#45;fail&#45;php&#45;namespaces/"
><a href='http://loveandtheft.org/2008/10/26/set&#45;sail&#45;for&#45;fail&#45;php&#45;namespaces/'><a href="http://loveandtheft.org/2008/10/26/set&#45;sail&#45;for&#45;fail&#45;php&#45;namespaces/">http://loveandtheft.org/2008/10/26/set&#45;sail&#45;for&#45;fail&#45;php&#45;namespaces/</a></a></a></dt>
</dl>

<h1><a name="Including_and_requiring"
>Including and requiring <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p><code>require_once()</code> is supported,
but might have issues with variables.</p>

<h1><a name="Extensions"
>Extensions <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<h2><a name="Implementation_in_Pipp"
>Implementation in Pipp <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>Currently,
Pipp has no support at all for extensions.</p>

<h2><a name="SEE_ALSO"
>SEE ALSO <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<pre>  TODO: Embedding and Extending PHP, by Sahrah ...
  L&#60;<a href="http://www.php.net/manual/en/internals2.php&#62;">http://www.php.net/manual/en/internals2.php&#62;</a></pre>

<h1><a name="Interaction_with_the_Parrot_world"
>Interaction with the Parrot world <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>Using Modules from other HLLs. Inlining PIR and other languages.</p>

<h1><a name="Compatability"
>Compatability <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>See <a href='TODO'>pipp.pod</a> for a list of divergences.</p>

<h1><a name="Related_projects."
>Related projects. <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>See the Wiki. Roadsend, Zend, PHC.</p>

<h1><a name="AUTHOR"
>AUTHOR <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>Bernhard Schmalhofer &#45; &#60;Bernhard.Schmalhofer@gmx.de&#62;</p>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../../../resources/parrot_small.png"
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
