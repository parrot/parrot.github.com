<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
    <HEAD>
        <TITLE>Untitled</TITLE>
        <LINK REL="stylesheet" TYPE="text/css"
            HREF="../../../../resources/perl.css"
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY>
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">Untitled</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../../../html/index.html">Contents</a> | <a href="../../../../html/languages.html">Language Implementations</a> | <a href="../../../../html/tcl.html">TCL</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<h1><a name="contributing_to_tcl/parrot"
>contributing to tcl/parrot <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>A brief overview on how to help out,
if you&#39;re interested.
In general,
it&#39;s ok to send patches for tcl to the RT system for anything that isn&#39;t &#34;BIG STUFF&#34; &#45; those,
please bounce off the MAINTAINERS first.
We&#39;d prefer <code lang='und' xml:lang='und'>diff &#45;u</code> patches,
but are happy to take complete files as well.</p>

<p>Since partcl is bundled with the parrot source,
svn access is handled via the same mechanism as for parrot itself.</p>

<h1><a name="BIG_STUFF"
>BIG STUFF <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<dl>
<dt><a name="Writing_Builtins"
>Writing Builtins</a></dt><p class="pad"></p>

<dd>partcl is a compiler.
Given a section of tcl code,
it translates that code into an AST (in the form of a Tcl* object from lib/*).
Once a section of code has been translated,
the object&#39;s <code lang='und' xml:lang='und'>compile</code> method is invoked,
which then generates PIR which can be compiled by parrot.</dd><p class="pad"></p>

<dd>The commands themselves are all dispatched at runtime.
These are all written in PIR,
and can be found,
e.g.
in <em lang='und' xml:lang='und'>runtime/builtins/while.pir</em>.
These variants take a variable number of already compiled arguments at runtime.</dd><p class="pad"></p>

<dt><a name="speed"
>speed</a></dt><p class="pad"></p>

<dd>We&#39;re currently slow,
compared to tclsh.
It&#39;s not worth worrying about this in terms of specific numbers until we can run <code lang='und' xml:lang='und'>tcltest</code> natively.
That said,
any patches that improve speed without harming maintainability will of course be applied.</dd><p class="pad"></p>

<dt><a name="features"
>features</a></dt><p class="pad"></p>

<dd>We&#39;re currently missing some things that require support from parrot.
See <a href='TODO'>hacks.pod</a> for a list.
In general,
though,
a lot of what we need to do is possible with parrot.</dd><p class="pad"></p>

<dd>If you&#39;re looking for something to to do,
see <a href='TODO'>TODO</a> one level up.</dd><p class="pad"></p>
</dl>

<h1><a name="DOCUMENTATION"
>DOCUMENTATION <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<dl>
<dt><a name="pod"
>pod</a></dt><p class="pad"></p>

<dd>Every PIR .sub that&#39;s defined should probably have some POD to go along with it to document the arguments and return values.
Only exceptions to this should be subs which correspond directly to Tcl builtins &#45;&#45; those are already documented at <a href='http://www.tcl.tk/man/tcl8.5/TclCmd/contents.htm'><a href="http://www.tcl.tk/man/tcl8.5/TclCmd/contents.htm">http://www.tcl.tk/man/tcl8.5/TclCmd/contents.htm</a></a></dd><p class="pad"></p>
</dl>

<h1><a name="PIR"
>PIR <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<dl>
<dt><a name="Missing_Commands"
>Missing Commands</a></dt><p class="pad"></p>

<dd>Every builtin command corresponds to an appropriately named file in <code lang='und' xml:lang='und'>src/builtin</code> or <code lang='und' xml:lang='und'>runtime/builtin</code>.
Use a similar command as a template</dd><p class="pad"></p>

<dd>If the return value would be TCL_OK,
then simply <code lang='und' xml:lang='und'>.return</code> the value from the sub.
For a standard error,
just use parrot&#39;s <code lang='und' xml:lang='und'>die</code> opcode.
For any other contrl flow type,
use one of the custom ops defined in <a href='TODO#ops%2Ftcl.ops'>&#34;ops/tcl.ops&#34; in src</a>,
e.g.: <code lang='und' xml:lang='und'>tcl_break</code></dd><p class="pad"></p>

<dd>Before adding new functionality,
add a test (or a test in an existing) file in <code lang='und' xml:lang='und'>t/</code> &#45; tests for <code lang='und' xml:lang='und'>puts</code>,
for example,
go in <code lang='und' xml:lang='und'>t/cmd_puts.t</code>.
We are in the process of transitioning all our tests from the perl based Parrot::Test to a tcl&#45;based version that generates TAP output.
All new tests should be written using the tcl&#45;based version.
See <code lang='und' xml:lang='und'>t/cmd_expr.t</code> for an example.</dd><p class="pad"></p>

<dd>Our final goal will be to pass (most of) the tcl test suite: run <code lang='und' xml:lang='und'>make spectest</code> to checkout the latest version of of the tcl test suite and run it.
Warning: slow...</dd><p class="pad"></p>

<dd>Long term goal is remove any tests in <code lang='und' xml:lang='und'>t/</code> that are testing things that are already tested in the official tcl suite.
Partcl&#39;s checked in test suite should just be checking partcl&#45;specific functionality.</dd><p class="pad"></p>
</dl>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../../../resources/parrot_small.png"
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
