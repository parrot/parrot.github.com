<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
    <HEAD>
        <TITLE>struct library</TITLE>
        <LINK REL="stylesheet" TYPE="text/css"
            HREF="../../../../../resources/perl.css"
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY>
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">struct library</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../../../../html/index.html">Contents</a> | <a href="../../../../../html/languages.html">Language Implementations</a> | <a href="../../../../../html/lua.html">Lua</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<h1><a name="NAME"
>NAME <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h1>

<p>lib/struct.pir &#45; struct library</p>

<h1><a name="DESCRIPTION"
>DESCRIPTION <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h1>

<p>See original on <a href='http://www.inf.puc&#45;rio.br/~roberto/struct/'><a href="http://www.inf.puc&#45;rio.br/~roberto/struct/">http://www.inf.puc&#45;rio.br/~roberto/struct/</a></a></p>

<p>NOT UNDER TEST</p>

<p>This library offers basic facilities to convert Lua values to and from C structs.
Its main functions are <code lang='und' xml:lang='und'>struct.pack</code>,
which packs multiple Lua values into a struct&#45;like string; and <code lang='und' xml:lang='und'>struct.unpack</code>,
which unpacks multiple Lua values from a given struct&#45;like string.</p>

<p>The fist argument to both functions is a <i>format string</i>,
which describes the layout of the structure.
The format string has the following syntax:</p>

<p>* First,
it may contain a endianness flag,
which governs all conversions for that structure.
<code lang='und' xml:lang='und'>&#34;&#60;&#34;</code> means little&#45;endian; <code lang='und' xml:lang='und'>&#34;</code>&#34;&#62; means big&#45;endian.
When no endian flag is given,
the functions use the machine&#39;s native endianness.</p>

<p>* The next optional item is a alignment flag,
in the form <code lang='und' xml:lang='und'>&#34;!n&#34;</code>,
where <i>n</i> is the maximum required alignment (necessarily a power of 2).
An absent <i>n</i> means the machine&#39;s native alignment.
An absent alignment flag means no alignment at all (which is the same as <code lang='und' xml:lang='und'>!1</code>).</p>

<p>* After those optional flags,
the format string contains a sequence of zero or more of the following conversion elements:</p>

<dl>
<dt><a name="&#34;x&#34;"
><b><code lang='und' xml:lang='und'>&#34;x&#34;</b></code></a></dt><p class="pad"></p>

<dd>a padding byte with no corresponding Lua value.</dd><p class="pad"></p>

<dt><a name="&#34;b&#34;"
><b><code lang='und' xml:lang='und'>&#34;b&#34;</b></code></a></dt><p class="pad"></p>

<dd>a <code lang='und' xml:lang='und'>signed char</code>.</dd><p class="pad"></p>

<dt><a name="&#34;B&#34;"
><b><code lang='und' xml:lang='und'>&#34;B&#34;</b></code></a></dt><p class="pad"></p>

<dd>an <code lang='und' xml:lang='und'>unsigned char</code>.</dd><p class="pad"></p>

<dt><a name="&#34;h&#34;"
><b><code lang='und' xml:lang='und'>&#34;h&#34;</b></code></a></dt><p class="pad"></p>

<dd>a <code lang='und' xml:lang='und'>signed short</code> (native size).</dd><p class="pad"></p>

<dt><a name="&#34;H&#34;"
><b><code lang='und' xml:lang='und'>&#34;H&#34;</b></code></a></dt><p class="pad"></p>

<dd>an <code lang='und' xml:lang='und'>unsigned short</code> (native size).</dd><p class="pad"></p>

<dt><a name="&#34;l&#34;"
><b><code lang='und' xml:lang='und'>&#34;l&#34;</b></code></a></dt><p class="pad"></p>

<dd>a <code lang='und' xml:lang='und'>signed long</code> (native size).</dd><p class="pad"></p>

<dt><a name="&#34;L&#34;"
><b><code lang='und' xml:lang='und'>&#34;L&#34;</b></code></a></dt><p class="pad"></p>

<dd>an <code lang='und' xml:lang='und'>unsigned long</code> (native size).</dd><p class="pad"></p>

<dt><a name="&#34;in&#34;"
><b><code lang='und' xml:lang='und'>&#34;in&#34;</b></code></a></dt><p class="pad"></p>

<dd>a signed integer with <i>n</i> bytes (where <i>n</i> must be a power of 2).
An absent <i>n</i> means the native size of an <code lang='und' xml:lang='und'>int</code>.</dd><p class="pad"></p>

<dt><a name="&#34;In&#34;"
><b><code lang='und' xml:lang='und'>&#34;In&#34;</b></code></a></dt><p class="pad"></p>

<dd>like <code lang='und' xml:lang='und'>&#34;in&#34;</code> but unsigned.</dd><p class="pad"></p>

<dt><a name="&#34;f&#34;"
><b><code lang='und' xml:lang='und'>&#34;f&#34;</b></code></a></dt><p class="pad"></p>

<dd>a <code lang='und' xml:lang='und'>float</code> (native size).</dd><p class="pad"></p>

<dt><a name="&#34;d&#34;"
><b><code lang='und' xml:lang='und'>&#34;d&#34;</b></code></a></dt><p class="pad"></p>

<dd>a <code lang='und' xml:lang='und'>double</code> (native size).</dd><p class="pad"></p>

<dt><a name="&#34;s&#34;"
><b><code lang='und' xml:lang='und'>&#34;s&#34;</b></code></a></dt><p class="pad"></p>

<dd>a zero&#45;terminated string.</dd><p class="pad"></p>

<dt><a name="&#34;cn&#34;"
><b><code lang='und' xml:lang='und'>&#34;cn&#34;</b></code></a></dt><p class="pad"></p>

<dd>a sequence of exactly <i>n</i> chars corresponding to a single Lua string.
An absent <i>n</i> means 1.
When packing,
the given string must have at least <i>n</i> characters (extra characters are discarded).</dd><p class="pad"></p>

<dt><a name="&#34;c0&#34;"
><b><code lang='und' xml:lang='und'>&#34;c0&#34;</b></code></a></dt><p class="pad"></p>

<dd>this is like <code lang='und' xml:lang='und'>&#34;cn&#34;</code>,
except that the <i>n</i> is given by other means.
When packing,
<i>n</i> is the length of the given string.
When unpacking,
<i>n</i> is the value of the previous unpacked value (which must be a number).
In that case,
this previous value is not returned.</dd><p class="pad"></p>
</dl>

<h2><a name="Functions"
>Functions <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h2>

<p>All functions are registered inside a table <code lang='und' xml:lang='und'>struct</code>.</p>

<dl>
<dt><a name="struct.pack_(fmt,_d1,_d2,_...)"
><b><code lang='und' xml:lang='und'>struct.pack (fmt, d1, d2, ...)</b></code></a></dt><p class="pad"></p>

<dd>Returns a string containing the values <code lang='und' xml:lang='und'>d1</code>,
<code lang='und' xml:lang='und'>d2</code>,
ect.
packed according to the format string <code lang='und' xml:lang='und'>fmt</code>.</dd><p class="pad"></p>

<dd>STILL INCOMPLETE.</dd><p class="pad"></p>

<dt><a name="struct.unpack_(fmt,_s,_[i])"
><b><code lang='und' xml:lang='und'>struct.unpack (fmt, s, [i])</b></code></a></dt><p class="pad"></p>

<dd>Returns the values packed in string <code lang='und' xml:lang='und'>s</code>according to the format string <code lang='und' xml:lang='und'>fmt</code>.
An optional <code lang='und' xml:lang='und'>i</code> marks where in <code lang='und' xml:lang='und'>s</code> to start reading (default is 1).
After the read values,
this function also returns the index in <code lang='und' xml:lang='und'>s</code> where it stopped reading,
which is also where you should start to read the rest of the string.</dd><p class="pad"></p>

<dd>STILL INCOMPLETE.</dd><p class="pad"></p>

<dt><a name="struct.size_(fmt)"
><b><code lang='und' xml:lang='und'>struct.size (fmt)</b></code></a></dt><p class="pad"></p>

<dd>Returns the size of a string formatted according to the format string <code lang='und' xml:lang='und'>fmt</code>.
For obvious reasons,
the format string cannot contains neither the option <code lang='und' xml:lang='und'>s</code> nor the option <code lang='und' xml:lang='und'>c0</code>.</dd><p class="pad"></p>
</dl>

<h1><a name="AUTHORS"
>AUTHORS <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h1>

<p>Francois Perrad</p>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../../../../resources/parrot_small.png"
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
