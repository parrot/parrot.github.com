<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Parrot  - Release manager guide</title>
        <link rel="stylesheet" type="text/css"
            href="../../../resources/parrot.css"
            media="all">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    </head>
    <body>
        <div id="wrapper">
            <div id="header">

                <a href="http://www.parrot.org">
                <img border=0 src="../../../resources/parrot_logo.png" id="logo" alt="parrot">
                </a>
            </div> <!-- "header" -->
            <div id="divider"></div>
            <div id="mainbody">
                <div id="breadcrumb">
                    <a href="../../../html/index.html">Home</a> &raquo; <a href="../../../html/developer.html">Developer Documentation</a> &raquo; Release manager guide
                </div>

<h1><a name="RELEASE_MANAGER_GUIDE"
>RELEASE MANAGER GUIDE</a></h1>

<p>The need for this document arised after a couple of improperly assembled releases.
The intent of this guide is to describe what must be done to prepare for a release so that such mistakes won&#39;t happen again.</p>

<h2><a name="I._Preparations_During_the_Month_Before_a_Release"
>I.
Preparations During the Month Before a Release</a></h2>

<ol>
<li>As soon as you become the release manager,
review the goals for the release on the Parrot roadmap (<a href='http://trac.parrot.org/parrot/roadmap'><a href="http://trac.parrot.org/parrot/roadmap">http://trac.parrot.org/parrot/roadmap</a></a>) and announce the tasks to the <code>parrot&#45;dev</code> mailing list.
Make sure everyone knows what they&#39;ve committed to accomplish in time for the release.</li>

<li>Right after the release preceding your release,
it is a good idea to start tracking Parrot news in <em>ChangeLog</em>.
A good resource are the individual reports posted in the weekly IRC meeting on <code>#parrotsketch</code>.
A complete log of these meetings is available at <a href='http://irclog.perlgeek.de/parrotsketch/'><a href="http://irclog.perlgeek.de/parrotsketch/">http://irclog.perlgeek.de/parrotsketch/</a></a>.</li>

<li>A couple of weeks in advance,
ask people to run <code>make fulltest</code> and report (and hopefully fix!) any problems they find.
Check in with language project leaders (e.g.
Rakudo) for potential release blockers to allow time to fix them.
Also ask people to review the tickets targeted for the upcoming release (<a href='https://trac.parrot.org/parrot/roadmap'>https://trac.parrot.org/parrot/roadmap</a>).</li>

<li>During the course of the release process,
you will need to be able to log in and operate on two different servers.
To oversimplify a bit,
you will need to be able to execute these two commands and their <code>scp</code> equivalents.</li>

<ul>
<li><code>ssh parrot@ftp&#45;osl.osuosl.org</code></li>

<p>Make sure your public SSH key(s) have been added to the FTP server <a href='TODO'>ftp&#45;osl.osuosl.org</a>.
You can open a support ticket for this by sending an email to <code>support@osuosl.org</code> with your public SSH keys as attachments.
Without them,
you won&#39;t be able to ship the release.</p>

<li><code>ssh &#60;username&#62;@parrot.org</code></li>

<p>Set up your account on <a href='http://parrot.org/'><a href="http://parrot.org/">http://parrot.org/</a></a>.
Any previous release manager may be able to help you but you may also need to open a support ticket at <code>support@osuosl.org</code> in order to be added to the <code>parrot</code> group.
The <code>parrot</code> group has permissions to create the new directories needed to hold documentation for new releases.</p>
</ul>

<li>A couple of days in advance,
announce the new release to <code>parrot&#45;dev@lists.parrot.org</code> and to the IRC channel <code>#parrot</code>.
Ask whether there are any showstopping bugs.
Check in again with the language project leads.
It&#39;s also good to ask for updates to <em>ChangeLog</em>,
<em>CREDITS</em>,
<em>PLATFORMS</em>,
<em>RESPONSIBLE_PARTIES</em>,
<em>api.yaml</em> and <a href='http://trac.parrot.org/parrot/wiki/Languages'><a href="http://trac.parrot.org/parrot/wiki/Languages">http://trac.parrot.org/parrot/wiki/Languages</a></a>.</li>

<li>On the Saturday before a release,
you should notify other developers to stop committing non&#45;release related code to the master branch.
This will help avoid complications.
They are of course free to commit to branches as much as they like.
You might also set the topic in <code>#parrot</code>,
announcing the time when you plan on starting the release procedure.
This will help the committers with timing their last minute commits.</li>

<li>You might also select a name (and optionally a quote) for your release.
For example,
you could select a name from <a href='http://en.wikipedia.org/wiki/List_of_parrots'><a href="http://en.wikipedia.org/wiki/List_of_parrots">http://en.wikipedia.org/wiki/List_of_parrots</a></a>.</li>

<li><b>NOTE:</b> You must have a recent version of Parrot already built for some of the subsequent steps.</li>
</ol>

<h2><a name="II._Get_the_Most_Recent_Changes"
>II.
Get the Most Recent Changes</a></h2>

<p>The day of the release has come.
Make sure you have the most recent version of the master branch checked out:</p>

<pre>    git checkout master
    git pull &#45;&#45;rebase</pre>

<p>Also, make sure you do not have any local commits that have not yet been pushed and tested thoroughly. You can do so by running:</p>

<pre>    git log origin/master..</pre>

<p>If there is no output from that command, then your local master and the remote master are in sync.</p>

<h2><a name="III._Update_the_Release_Version"
>III. Update the Release Version</a></h2>

<p>Update files with version&#45;specific information but before doing so, you should already have configured Parrot (<code>perl Configure.pl</code>) and ran <code>make</code> with the old version.</p>

<ol>
<li></li>

<dl>
<dt><a name="a"
>a</a></dt>
Use <code>tools/release/update_version.pl</code> to update the version string in several files:
<pre>  perl tools/release/update_version.pl 3.8.0</pre>
<b>IMPORTANT:</b> The version change you just made by running <em>tools/release/update_version.pl</em> invalidates any existing generated bytecode. Assuming that it was run in a directory with an existing build, you must now run <code>make reconfig</code> to clear out any invalid bytecode.
<dt><a name="c"
>c</a></dt>
Update the version number, date, and your name in <em>docs/parrothist.pod</em>.
<dt><a name="d"
>d</a></dt>
Update this file (<em>docs/project/release_manager_guide.pod</em>) to remove the pending release you&#39;re currently building.</dl>

<li>Update <em>ChangeLog</em> with the new version number and any other changes that have occurred since the last release. Hopefully, these files are being updated as committers work. If not, it&#39;s probably a good idea to gather the updates weekly rather than waiting until the day of the release.</li>

<li>Update release&#45;related information in <em>tools/release/release.json</em>. This will be used later when making release announcements. There are a few essential fields that must be updated at each release:</li>

<dl>
<dt><a name="release.*"
><b><code>release.*</b></code></a></dt>
The date of the next release (see <a href='#Appendix_1_%2D_Upcoming_Releases'>Appendix 1</a>).
<dt><a name="bugday.date"
><b><code>bugday.date</b></code></a></dt>
Enter the date of the Saturday before the next release.
<dt><a name="wiki.bugday"
><b><code>wiki.bugday</b></code></a></dt>
Enter the date part of the link to the wiki page for the next bugday.
<dt><a name="ftp.path"
><b><code>ftp.path</b></code></a></dt>
The URL of the FTP directory where the Parrot tarball can be found.</dl>

<li>Make sure <em>RESPONSIBLE_PARTIES</em> is still accurate.</li>

<li>Give yourself credit for the release in <em>CREDITS</em>.</li>

<li>Configure Parrot and run <code>make distro_tests</code>. Then either fix what those tests complain about or fix the tests so that they don&#39;t complain.</li>

<li><b>NOTE:</b> You may skip the following step if this is a developer release or there have been no new entries to <em>PBC_COMPAT</em>.</li>

<p>If this is a supported release and new entries to <em>PBC_COMPAT</em> have been added since the last supported release, add a new entry with a new major version number for this release at the top of the list:</p>

<pre>  3.0     2007.10.17      coke    released 0.4.17</pre>

<p>Delete all minor version numbers since the last major bytecode version number as these are only used in development and not relevant to the bytecode support policy. Those changes are all included within the major version number increase for the supported release.</p>

<p>Once you&#39;ve updated <em>PBC_COMPAT</em> &#45; running <code>sh tools/dev/mk_packfile_pbc</code> if necessary &#45; then run <code>sh tools/dev/mk_native_pbc</code> to update the PBC files used in the native PBC tests. Note that you must have Parrot already built for this to work and that this script will reconfigure and rebuild Parrot with various primitive size options.</p>

<li>Verify that the build process runs smoothly:</li>

<pre>    make realclean
    perl Configure.pl &#45;&#45;test ...
    make world html 2&#62;&#38;1 | tee make_world_html.log
    make fulltest   2&#62;&#38;1 | tee make_fulltest.log</pre>

<p>Note that running <code>make fulltest</code> takes a while and that separate harnesses are being run.</p>
</ol>

<h2><a name="IV._Push_Changes_to_the_GitHub_Repository"
>IV. Push Changes to the GitHub Repository</a></h2>

<p>When all is well, commit your changes:</p>

<pre>    git diff
    git add file1 file2 ...
    git commit &#45;m &#34;awesome and informative commit message&#34;</pre>

<p>Instead of adding files individually, you can also tell <code>git commit</code> that you want all modified and deleted files to be in your next commit via the <code>&#45;a</code> switch:</p>

<pre>    git commit &#45;a &#45;m &#34;awesome and informative commit message&#34;</pre>

<p>Be careful with <code>git commit &#45;a</code> as it could add files that you do not mean to include. Verify that the contents of your most recent commit look sane with:</p>

<pre>    git show</pre>

<p>If you want, you can note the SHA&#45;1 digest from this commit by running:</p>

<pre>    git rev&#45;parse master &#62; SHA1_TO_REMEMBER</pre>

<p>Update repository on GitHub:</p>

<pre>    git push origin master</pre>

<h2><a name="V._Prepare_the_Release_Tarballs"
>V. Prepare the Release Tarballs</a></h2>

<p>There are two possible approaches to preparing and testing the release tarball: using <code>make release</code> or using <code>make release_check</code>.</p>

<dl>
<dt><a name="1_Via_make_release"
>1 Via <b><code>make release</b></code></a></dt>

<dl>
<dt><a name="a"
>a</a></dt>
Begin by running:
<pre>    make release VERSION=a.b.c</pre>
where a.b.c is the version number (e.g. <code>3.8.0</code>). This will create the tarball named <em>parrot&#45;a.b.c.tar.gz</em>. The <em>DEVELOPING</em> file is automatically excluded from the release tarball.
<dt><a name="b"
>b</a></dt>
Extract <em>parrot&#45;a.b.c.tar.gz</em> into another directory:
<pre>    cp parrot&#45;a.b.c.tar.gz ~/another/directory
    cd ~/another/directory
    tar &#45;xvzf parrot&#45;a.b.c.tar.gz</pre>

<dt><a name="c"
>c</a></dt>
Verify that the build process runs smoothly:
<pre>    perl Configure.pl
    make world html 2&#62;&#38;1 | tee make_world_html.log
    make fulltest   2&#62;&#38;1 | tee make_fulltest.log</pre>
</dl>

<dt><a name="2_Via_make_release_check"
>2 Via <b><code>make release_check</b></code></a></dt>
As an alternative, you can package the release by running:
<pre>    perl Configure.pl
    make release_check</pre>
This target (or, for short, <code>make relcheck</code>), will prepare the tarball, copy it into a temporary directory, and then reconfigure, rebuild, re&#45;test (with <code>make test</code>) and re&#45;release.</dl>

<p>Whichever of these two approaches you take, verify that the version is correct and <b>does not</b> contain the suffix <code>devel</code>:</p>

<pre>    ./parrot &#45;V</pre>

<h2><a name="VI._Tag_the_Release_Commit"
>VI. Tag the Release Commit</a></h2>

<p>Tag the release as &#34;RELEASE_a_b_c&#34;, where a.b.c is the version number:</p>

<pre>    git tag RELEASE_a_b_c
    git push &#45;&#45;tags</pre>

<h2><a name="VII._Push_Tarballs_to_the_FTP_Server"
>VII. Push Tarballs to the FTP Server</a></h2>

<p>Log in to <a href='TODO'>ftp&#45;osl.osuosl.org</a>:</p>

<pre>    ssh parrot@ftp&#45;osl.osuosl.org</pre>

<p>As mentioned previously, your public SSH key must be added to the list of authorized keys before you can log in.</p>

<p>If this is a development release, create a new directory under <em>~/ftp/releases/devel</em>:</p>

<pre>    mkdir ~/ftp/releases/devel/a.b.c</pre>

<p>If this is a supported release, (see <a href='TODO'>Appendix 1</a>), create the new directory in <em>~/ftp/releases/supported</em> instead:</p>

<pre>    mkdir ~/ftp/releases/supported/a.b.c</pre>

<p>Copy all the tarballs and their respective digest files from your machine into the new directory:</p>

<pre>    scp parrot&#45;a.b.c.tar.gz \
        parrot&#45;a.b.c.tar.bz2 \
        parrot&#45;a.b.c.tar.gz.sha256 \
        parrot&#45;a.b.c.tar.bz2.sha256 \
        parrot@ftp&#45;osl.osuosl.org:~/ftp/releases/devel/a.b.c</pre>

<p>You don&#39;t necessarily have to use <code>scp</code> for this step. You can use whichever tool you prefer.</p>

<p>When you&#39;re finished making changes, run the trigger script to push the changes out to the FTP mirrors:</p>

<pre>    ~/trigger&#45;parrot</pre>

<p>Verify your changes at <em>ftp://ftp.parrot.org/pub/parrot/releases</em>. It should only take a few minutes for the mirrors to sync.</p>

<h2><a name="VIII._Release_Announcement"
>VIII. Release Announcement</a></h2>

<p>Compose the release announcement. Use <em>tools/release/crow.pir</em> to make this part easier. You can specify the format of your announcements like so:</p>

<pre>    ./parrot tools/release/crow.pir &#45;&#45;type=text
    ./parrot tools/release/crow.pir &#45;&#45;type=html</pre>

<p>Copy the output and paste it into the application you need. HTML works well for Perl and PerlMonks, and text for the rest. It&#39;s a good idea (although not necessary) to add a &#34;highlights&#34; section to draw attention to major new features. If you do, be sure to say the same thing in both text and HTML versions.</p>

<p>Be sure to include the SHA1 sums of the tarballs in the release announcement which are automatically generated by <code>make release</code>.</p>

<h2><a name="IX._Update_the_Website"
>IX. Update the Website</a></h2>

<p>Update the website. You will need an account with editor rights on <a href='http://www.parrot.org'><a href="http://www.parrot.org">http://www.parrot.org</a></a>.</p>

<ol>
<li>Create a new page for the release announcement by navigating to <i>Create content</i> &#45;&#62; <i>Story</i>. There&#39;s some additional stuff needed at the top of the page; use one of the old announcements as a guide.</li>

<p>The &#34;&#60;!&#45;&#45;break&#45;&#45;&#62;&#34; line marks the end of the text that will appear on the front page.</p>

<li>For the &#34;News&#34; category, select both &#34;Releases&#34; and &#34;News&#34;.</li>

<p>Add tags to the page for significant changes in this release (e.g. &#34;rakudo&#34; for significant Rakudo language updates or &#34;gc&#34; for significant garbage collection subsystem updates).</p>

<li>Under <i>URL path settings</i>, uncheck <i>Automatic alias</i> and set the path to <i>news/[year]/Parrot&#45;[release number]</i>.</li>

<li>Under <i>Publishing options</i>, make sure <i>Published</i> and <i>Promoted to front page</i> are both checked.</li>

<li>Under <i>Administer</i> &#45;&#62; <i>Site building</i> &#45;&#62; <i>URL Redirects</i>, change the URL for <code>release/current</code> to the FTP file for the new release (e.g. <em>ftp://ftp.parrot.org/pub/parrot/releases/devel/3.8.0/parrot&#45;3.8.0.tar.gz</em>). Also update the URL for <code>release/developer</code> or <code>release/supported</code> depending on which type of release this is.</li>

<li>Update <a href='http://docs.parrot.org'><a href="http://docs.parrot.org">http://docs.parrot.org</a></a>. Run <code>make html</code> in a release copy of Parrot, and save the <em>resources/</em> and <em>html/</em> directories created in <em>docs/</em>. Use SSH to login to <a href='TODO'>&#60;username&#62;@parrot.org</a> and expand these into a release directory (e.g. 3.8.0) in the webroot for <a href='http://docs.parrot.org'><a href="http://docs.parrot.org">http://docs.parrot.org</a></a>. In <code>&#60;webroot&#62;/parrot</code>, there are symbolic links for <code>latest</code>, <code>supported</code>, and <code>devel</code>. Update the <code>latest</code> symlink to point to your new directory. If this is a supported release, also update the <code>supported</code> symlink. Do not delete any old copies of the docs and don&#39;t update the other symlinks.</li>

<li>Preview the new page, and submit it.</li>
</ol>

<p>The old release announcement may be edited to uncheck <i>Promoted to front page</i> to keep the main page fresh.</p>

<h2><a name="X._Publicity"
>X. Publicity</a></h2>

<p>Publicize the release by publishing the announcement through the following channels (and any others you can think of):</p>

<ol>
<li>Send a text email to <code>parrot&#45;dev</code>, <code>parrot&#45;users</code>, <code>perl6&#45;language</code>, <code>perl6&#45;announce</code>, <code>perl5&#45;porters</code>, etc. You should also include <a href='TODO'>lwn.net</a> in this mailing; email to <code>lwn</code> at that domain.</li>

<li>Submit the announcement story to use Perl, Perl Monks, Slashdot, Newsforge, etc. Don&#39;t forget to set a <code>Reply&#45;To:</code> or <code>Followup&#45;To:</code> header, if your mail client lets you.</li>

<li>Modify the topic on <code>#parrot</code>:</li>

<pre>    /topic #parrot Parrot 0.4.8 Released | <a href="http://parrot.org/">http://parrot.org/</a></pre>

<li>Update the wiki frontpage at <a href='http://trac.parrot.org/parrot/'><a href="http://trac.parrot.org/parrot/">http://trac.parrot.org/parrot/</a></a>.</li>

<li>Update the Wikipedia entry at <a href='http://en.wikipedia.org/wiki/Parrot_virtual_machine'><a href="http://en.wikipedia.org/wiki/Parrot_virtual_machine">http://en.wikipedia.org/wiki/Parrot_virtual_machine</a></a>.</li>

<li>Update the C2 wiki entry at <a href='http://c2.com/cgi/wiki?ParrotCode'><a href="http://c2.com/cgi/wiki?ParrotCode">http://c2.com/cgi/wiki?ParrotCode</a></a>.</li>
</ol>

<h2><a name="XI._Changes_to_Trac"
>XI. Changes to Trac</a></h2>

<ol>
<li>Add the latest version to Trac so that new bug reports can be filed against the release. <a href='https://trac.parrot.org/parrot/admin/ticket/versions'>https://trac.parrot.org/parrot/admin/ticket/versions</a>.</li>

<li>Make the latest version the default version for new reports.</li>

<li>Remove any sufficiently old versions listed there.</li>
</ol>

<h2><a name="XII._Finish"
>XII. Finish</a></h2>

<p>You&#39;re done! Help yourself to a beer, cola, or other delicious celebratory drink.</p>

<h1><a name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><em>README</em>, <em>RESPONSIBLE_PARTIES</em>.</p>

<h1><a name="Appendix_1_&#45;_Upcoming_Releases"
>Appendix 1 &#45; Upcoming Releases</a></h1>

<p>To make a monthly release schedule possible, we spread the burden of releases across multiple release managers. Releases are scheduled for the 3rd Tuesday of each month.</p>

<p>The starred releases are Parrot&#39;s quarterly supported releases, see <em>docs/project/support_policy.pod</em>.</p>

<p>The calendar of releases is available at the <code>comp.lang.parrot</code> Google calendar, visible at <a href='http://www.google.com/calendar/render?cid=ldhctdamsgfg5a1cord52po9h8@group.calendar.google.com'><a href="http://www.google.com/calendar/render?cid=ldhctdamsgfg5a1cord52po9h8@group.calendar.google.com">http://www.google.com/calendar/render?cid=ldhctdamsgfg5a1cord52po9h8@group.calendar.google.com</a></a>.</p>

<p>Versions with an asterisk (*) are supported releases:</p>

<pre>    &#45; Nov 15, 2011 &#45; 3.10  &#45; Whiteknight
    &#45; Dec 20, 2011 &#45; 3.11  &#45; cotto
    &#45; Jan 17, 2012 &#45; 4.0   &#45; ??
    &#45; Feb 21, 2012 &#45; 4.1   &#45; ??
    &#45; Mar 20, 2012 &#45; 4.2   &#45; ??
    &#45; Apr 17, 2012 &#45; 4.3   &#45; ??
    &#45; May 15, 2012 &#45; 4.4   &#45; ??
    &#45; Jun 19, 2012 &#45; 4.5   &#45; ??
    &#45; Jul 17, 2012 &#45; 4.6   &#45; ??
    &#45; Aug 21, 2012 &#45; 4.7   &#45; ??
    &#45; Sep 18, 2012 &#45; 4.8   &#45; ??
    &#45; Oct 16, 2012 &#45; 4.9   &#45; ??
    &#45; Nov 20, 2012 &#45; 4.10  &#45; ??
    &#45; Dec 18, 2012 &#45; 4.11  &#45; ??</pre>
            </div> <!-- "mainbody" -->
            <div id="divider"></div>
            <div id="footer">
	        Copyright &copy; 2002-2011, Parrot Foundation.
            </div>
        </div> <!-- "wrapper" -->
    </body>
</html>
