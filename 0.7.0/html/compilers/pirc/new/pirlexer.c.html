<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
    <HEAD>
        <TITLE>pir.l</TITLE>
        <LINK REL="stylesheet" TYPE="text/css"
            HREF="../../../../resources/perl.css"
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY>
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">pir.l</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../../../html/index.html">Contents</a> | <a href="../../../../html/compilers.html">Compilers</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<h1><a name="NAME"
>NAME <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>pir.l</p>

<h1><a name="DESCRIPTION"
>DESCRIPTION <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>This is a complete rewrite of the PIR lexical analyzer,
as defined in IMCC.
Goal is to fix the issues with the current implementation of the PIR language.</p>

<p>The current approach is to create a three&#45;pass compiler,
but if any optimizations in this schedule can be made,
then this is preferred.
This needs more experimentation.</p>

<p>The first pass is the heredoc pre&#45;processor,
which converts all heredoc strings into normal strings (they are &#34;flattened).
Furthermore,
this phase strips all comments,
both POD and line comments.</p>

<p>The second pass is the macro pre&#45;processor,
which handles the <code lang='und' xml:lang='und'>.macro</code>,
<code lang='und' xml:lang='und'>.macro_const</code> and <code lang='und' xml:lang='und'>.include</code> directives.
The resulting output is the file that can be fed into the actual PIR parser.</p>

<p>The third pass is then the PIR parsing phase.
It takes the output of the macro pre&#45;processor,
which contains no heredoc strings and macros.
For that reason,
the PIR lexer is very simple and straightforward.</p>

<p>Each of the phases can be easily implemented.
When they must be combined,
the complexity grows quickly.
Therefore,
this approach,
which is probably not the most efficient,
is easier to maintain,
and preferable.</p>

<dl>
<dt><a name="dupstr"
><b><code lang='und' xml:lang='und'>dupstr</b></code></a></dt><p class="pad"></p>

<dd>The C89 standard does not define a strdup() in the C library,
so define our own strdup.
Function names beginning with &#34;str&#34; are reserved (I think),
so make it dupstr,
as that is what it does: duplicate a string.</dd><p class="pad"></p>

<dt><a name="dupstrn"
><b><code lang='und' xml:lang='und'>dupstrn</b></code></a></dt><p class="pad"></p>

<dd>See dupstr,
except that this version takes the number of characters to be copied.
Easy for copying a string except the quotes.</dd><p class="pad"></p>

<dt><a name="new_lexer"
><b><code lang='und' xml:lang='und'>new_lexer</b></code></a></dt><p class="pad"></p>

<dd>constructor for a lexer.
It&#39;s very important to initialize all fields.</dd><p class="pad"></p>
</dl>

<h1><a name="AUX._FUNCTIONS"
>AUX.
FUNCTIONS <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<dl>
<dt><a name="static_int_is_parrot_op(char_const_*_const_spelling)"
><b><code lang='und' xml:lang='und'>static int is_parrot_op(char const *const spelling)</b></code></a></dt><p class="pad"></p>
</dl>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../../../resources/parrot_small.png"
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
