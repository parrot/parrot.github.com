<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>  
    <HEAD>
        <TITLE>Untitled</TITLE>
        <LINK REL="stylesheet" TYPE="text/css" 
            HREF="../../../../../resources/perl.css" 
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY> 
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">Untitled</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../../../../html/index.html">Contents</a> | <a href="../../../../../html/languages.html">Language Implementations</a> | <a href="../../../../../html/perl6.html">Perl6</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<p>= NAME</p>

<p>Test &#45; Test support module for perl6</p>

<p>= SYNOPSIS</p>

<pre lang='und' xml:lang='und'>  use v6;
  require Test;

  plan 10;
  force_todo(1, 3 .. 5, 9);

  use_ok(&#39;Some::Module&#39;);
  use_ok(&#39;Some::Other::Module&#39;, todo =&#62; 1);

  ok(2 + 2 == 4, &#39;2 and 2 make 4&#39;);
  is(2 + 2, 4, &#39;2 and 2 make 4&#39;);
  isa_ok([1, 2, 3], &#39;List&#39;);

  ok(2 + 2 == 5, &#39;2 and 2 make 5&#39;, :todo(1));
  is(2 + 2, 5, desc =&#62; &#39;2 and 2 make 5&#39;, todo =&#62; 1);
  isa_ok({&#39;one&#39; =&#62; 1}, &#39;Hash&#39;, :todo(1));

  use_ok(&#39;My::Module&#39;);

  pass(&#39;This test passed&#39;);
  flunk(&#39;This test failed&#39;);

  skip(&#39;skip this test for now&#39;);

  flunk(&#39;this fails, but might work soon&#39;, :todo(1));

  diag(&#39;some misc comments and documentation&#39;);</pre>

<p>= DESCRIPTION</p>

<p>This module was built to facilitate the Pugs test suite. It has the distinction of being the very first module written for Pugs.</p>

<p>It provides a simple set of common test utility functions, and is an implementation of the TAP protocol.</p>

<p>This module, like Pugs, is a work in progress. As new features are added to Pugs, new test functions will be defined to facilitate the testing of those features. For more information see the FUTURE PLANS section of this document.</p>

<p>= FUNCTIONS</p>

<p>&#45; `plan (Int $number_of_tests) returns Void`</p>

<p>All tests need a plan. A plan is simply the number of tests which are expected to run. This should be specified at the very top of your tests.</p>

<p>&#45; `force_todo (*@todo_tests) returns Void`</p>

<p>If you have some tests which you would like to force into being TODO tests then you can pass them through this function. This is primarily a release tool, but can be useful in other contexts as well.</p>

<p>== Testing Functions</p>

<p>&#45; `use_ok (Str $module, Bool :$todo, Str :$depends) returns Bool`</p>

<p>*NOTE:* This function currently uses `require()` since Pugs does not yet have a proper `use()` builtin.</p>

<p>&#45; `ok (Bool $cond, Str $desc?, Bool :$todo, Str :$depends) returns Bool`</p>

<p>&#45; `is (Str $got, Str $expected, Str $desc?, Bool :$todo, Str :$depends) returns Bool`</p>

<p>&#45; `isnt (Str $got, Str $expected, Str $desc?, Bool :$todo, Str :$depends) returns Bool`</p>

<p>&#45; `like (Str $got, Rule $expected, Str $desc?, Bool :$todo, Str :$depends) returns Bool is export` &#45; `unlike (Str $got, Rule $expected, Str $desc?, Bool :$todo, Str :$depends) returns Bool is export`</p>

<p>These functions should work with most reg&#45;exps, but given that they are still a somewhat experimental feature in Pugs, it is suggested you don&#39;t try anything too funky.</p>

<p>&#45; `cmp_ok (Str $got, Code &#38;compare_func, Str $expected, Str $desc?, Bool :$todo, Str :$depends) returns Bool`</p>

<p>This function will compare `$got` and `$expected` using `&#38;compare_func`. This will eventually allow Test::More&#45;style cmp_ok() though the following syntax:</p>

<pre lang='und' xml:lang='und'>  cmp_ok(&#39;test&#39;, &#38;infix:&#60;gt&#62;, &#39;me&#39;, &#39;... testing gt on two strings&#39;);</pre>

<p>However the `&#38;infix:&#60;gt&#62;` is currently not implemented, so you will have to wait a little while. Until then, you can just write your own functions like this:</p>

<pre lang='und' xml:lang='und'>  cmp_ok(&#39;test&#39;, sub ($a, $b) { ?($a gt $b) }, &#39;me&#39;, &#39;... testing gt on two strings&#39;);</pre>

<p>&#45; `isa_ok ($ref, Str $expected_type, Str $desc?, Bool :$todo, Str :$depends) returns Bool`</p>

<p>This function currently on checks with ref() since we do not yet have object support. Once object support is created, we will add it here, and maintain backwards compatibility as well.</p>

<p>&#45; `eval_ok (Str $code, Str $desc?, Bool :$todo, Str :$depends) returns Bool`</p>

<p>&#45; `eval_is (Str $code, Str $expected, Str $desc?, Bool :$todo, Str :$depends) returns Bool`</p>

<p>These functions will eval a code snippet, and then pass the result to is or ok on success, or report that the eval was not successful on failure.</p>

<p>&#45; `throws_ok (Code &#38;code, Any $expected, Str $desc?, Bool :$todo, Str :$depends) returns Bool`</p>

<p>This function takes a block of code and runs it. It then smart&#45;matches (`~~`) any `$!` value with the `$expected` value.</p>

<p>&#45; `dies_ok (Code &#38;code, Str $desc?, Bool :$todo, Str :$depends) returns Bool`</p>

<p>&#45; `lives_ok (Code &#38;code, Str $desc?, Bool :$todo, Str :$depends) returns Bool`</p>

<p>These functions both take blocks of code, run the code, and test whether they live or die.</p>

<p>=== A Note about TODO&#45;ing tests</p>

<p>Sometimes a test is broken because something is not implemented yet. So in order to still allow that to be tested, and those tests to knowingly fail, we provide the `:todo(1)` named parameter for all these functions.</p>

<p>The `:depends(&#34;string&#34;)` parameter to most of the functions is a way to provide a comment that refers to another file or test which must be made to pass before this test can pass (or before an implementation could be started). This is most useful when writing modules and you find there is some language feature missing, or core bug that needs to be sorted out before you can continue.</p>

<p>It is also possible to use the `force_todo()` function to do large scale TODO&#45;ing of tests.</p>

<p>== Misc. Functions</p>

<p>&#45; `skip (Str $reason?) returns Bool` &#45; `skip (Int $count, Str $reason?) returns Bool`</p>

<p>If for some reason a test is to be skipped, you can use this function to do so.</p>

<p>&#45; `pass (Str $desc?) returns Bool`</p>

<p>Sometimes what you need to test does not fit into one of the standard testing functions. In that case, you can use the rather blunt pass() functions and its compliment the flunk() function.</p>

<p>&#45; `flunk (Str $desc?, Bool :$todo) returns Bool`</p>

<p>This is the opposite of pass()</p>

<p>&#45; `diag (Str $diag)`</p>

<p>This will print each string with a &#39;#&#39; character appended to it, this is ignored by the TAP protocol.</p>

<p>= FUTURE PLANS</p>

<p>This module is still a work in progress. As Pugs grows, so will it&#39;s testing needs. This module will be the code support for those needs. The following is a list of future features planned for this module.</p>

<p>&#45; better error handling for cmp_ok</p>

<p>The error handling capabilities need to be expanded more to handle the error reporting needs of the cmp_ok() function.</p>

<p>&#45; is_deeply</p>

<p>Once nested data structures are implemented, we will need an easy way to test them. So we will implement the Test::More function is_deeply. The plan currently is to implement this as a mutually recursive multi&#45; sub which will be able to handle structures of arbitrary depth and of an arbitrary type. The function signatures will likely look something like this:</p>

<pre lang='und' xml:lang='und'>  multi sub is_deeply (Array @got, Array @expected, Str $desc?) returns Bool;
  multi sub is_deeply (List  $got, List  $expected, Str $desc?) returns Bool;
  multi sub is_deeply (Hash  %got, Hash  %expected, Str $desc?) returns Bool;
  multi sub is_deeply (Pair  $got, Pair  $expected, Str $desc?) returns Bool;</pre>

<p>Because these functions will be mutually recursive, they will easily be able handle arbitrarily complex data structures automatically (at least that is what I hope).</p>

<p>= ENVIRONMENT</p>

<p>Setting the environment variable TEST_ALWAYS_CALLER to force Test.pm to always append the caller information to the test&#39;s `$desc`.</p>

<p>= SEE ALSO</p>

<p>The Perl 5 Test modules</p>

<p>&#45; Test</p>

<p>&#45; Test::More</p>

<p>Information about the TAP protocol can be found in the Test::Harness distribution.</p>

<p>= AUTHORS</p>

<p>Audrey Tang &#60;autrijus@autrijus.org&#62;</p>

<p>Benjamin Smith</p>

<p>Norman Nunley</p>

<p>Steve Peters</p>

<p>Stevan Little &#60;stevan@iinteractive.com&#62;</p>

<p>Brian Ingerson &#60;ingy@cpan.org&#62;</p>

<p>Jesse Vincent &#60;jesse@bestpractical.com&#62;</p>

<p>Yuval Kogman &#60;nothingmuch@woobling.org&#62;</p>

<p>Darren Duncan &#60;perl@DarrenDuncan.net&#62;</p>

<p>Nathan Gray &#60;kolibrie@graystudios.org&#62;</p>

<p>Max Maischein &#60;corion@cpan.org&#62;</p>

<p>Ingo Blechschmidt &#60;iblech@web.de&#62;</p>

<p>Gaal Yahas &#60;gaal@forum2.org&#62;</p>

<p>= COPYRIGHT</p>

<p>Copyright (c) 2005, 2006. Audrey Tang. All rights reserved.</p>

<p>This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>

<p>See <a href="http://www.perl.com/perl/misc/Artistic.html">http://www.perl.com/perl/misc/Artistic.html</a></p>

<h1><a name="POD_ERRORS"
>POD ERRORS <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h1>

<p>Hey! <b>The above document had some coding errors, which are explained below:</b></p>

<dl>
<dt><a name="Around_line_303:"
>Around line 303:</a></dt><p class="pad"></p>

<dd>Unknown directive: =kwid</dd><p class="pad"></p>
</dl>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../../../../resources/parrot.small.png" 
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
