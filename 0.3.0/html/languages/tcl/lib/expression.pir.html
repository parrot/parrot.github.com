<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>  
    <HEAD>
        <TITLE>Untitled</TITLE>
        <LINK REL="stylesheet" TYPE="text/css" 
            HREF="../../../../resources/perl.css" 
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY> 
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">Untitled</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../../../html/index.html">Contents</a> | <a href="../../../../html/languages.html">Language Implementations</a> | <a href="../../../../html/tcl.html">TCL</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<h1><a name="_Tcl::__expression_parse"
>_Tcl::__expression_parse <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>Given a string,
return an invokable PMC that will generate the appropriate value described by this Tcl expression.
An intermediate AST is generated,
and the functions ends with a tailcall to the compiler.</p>

<p>Convert the chunks into a stack.
For each level of precendence,
scan the chunk list for operators that match our level.
As we find one,
grab the left and right operands.
If the operand is null,
instead use the value from the same location in the program stack as the operand (as it is the result of a previous operator.).
If a value is pulled from the program_stack,
then null it there.</p>

<p>Now that we have an operand and two operators (unary ops are treated like operands during the parse phase.
Ternary op is currently ignored,
but we&#39;d special case it here.),
create a TclBinaryOp,
and put it in the same index in the program stack as the left op here.
Replace all three entries in the chunk list with a single NULL entry.</p>

<p>When our list of chunks to process is a single NULL entry,
we&#39;re done,
and now have a program list containing a single element,
which is something which supports <code lang='und' xml:lang='und'>compile</code>.
(In most cases,
a TclBinaryOp)</p>

<h1><a name="_Tcl::__expression_compile"
>_Tcl::__expression_compile <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>Given the AST generated by the expression parser,
render the various operands as PIR.</p>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../../../resources/parrot.small.png" 
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
