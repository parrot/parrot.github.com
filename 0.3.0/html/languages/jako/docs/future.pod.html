<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>  
    <HEAD>
        <TITLE>Untitled</TITLE>
        <LINK REL="stylesheet" TYPE="text/css" 
            HREF="../../../../resources/perl.css" 
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY> 
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">Untitled</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../../../html/index.html">Contents</a> | <a href="../../../../html/languages.html">Language Implementations</a> | <a href="../../../../html/jako.html">Jako</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<h1><a name="Introduction"
>Introduction <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>Jako is a simple malleable language.
It has very little built&#45;in functionality,
but it is very easy to build a reasonable language out of it.</p>

<h1><a name="Constructs"
>Constructs <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>The basic constructs of Jako are predefined,
but the ways in which they combine are programmer&#45;defined.</p>

<h2><a name="Words"
>Words <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>A word is a contiguous string of characters matching the Perl regular expression <code lang='und' xml:lang='und'>m/[A&#45;Za&#45;z][A&#45;Za&#45;z0&#45;9_]*/</code>.
Words can be used as the names of types,
variables and constants,
and can also be used as <i>key words</i>.</p>

<h2><a name="Symbols"
>Symbols <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>Symbols are</p>

<h2><a name="Expressions"
>Expressions <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<h2><a name="Blocks_/_Environments"
>Blocks / Environments <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>A named block can be executed by passing it to <code lang='und' xml:lang='und'>eval</code>.</p>

<p>The section &#34;A Mathematical Note&#34; of [MEYER&#45;2001] presents a model of a class as a set of name&#45;value bindings.</p>

<p>Lesson 3,
&#34;Semantic Building Blocks&#34; of [MEAD&#45;2001] describes the environment (or context) of a program at a specific point in its execution in a similar way.</p>

<p>A block is an environment.
Names not explicitly bound in that environment are implicitly bound if they are explicitly bound in an ancestor environment.</p>

<pre lang='und' xml:lang='und'>    bind env E word N any V := { E.N = V; }</pre>

<h2><a name="Blocklists"
>Blocklists <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>Parentheses are used to delimit blocklists. A parenthetical list of expressions is semantically equivalent to the same number of single&#45;expression blocks, one after the other. That is,</p>

<pre lang='und' xml:lang='und'>    (a &#60; b, 5, i++)</pre>

<p>is exactly the same as</p>

<pre lang='und' xml:lang='und'>    {a &#60; b} {5} {i++}</pre>

<h1><a name="Definitions"
>Definitions <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<pre lang='und' xml:lang='und'>  def</pre>

<h1><a name="Intrinsic_Flow_Control_Statements"
>Intrinsic Flow Control Statements <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<h2><a name="if"
>if <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<h2><a name="goto"
>goto <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<pre lang='und' xml:lang='und'>    def goto label L := ...</pre>

<h1><a name="Defining_Conventional_Constructs"
>Defining Conventional Constructs <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>Even though Jako doesn&#39;t have conventional constructs built&#45;in, it is very easy to define them using the facilities Jako does provide:</p>

<h2><a name="Eiffel&#45;like_loops"
>Eiffel&#45;like loops <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>Translating from Eiffel notation to a Perl&#45;like notation yields something like this:</p>

<pre lang='und' xml:lang='und'>    from {...} invariant (...) variant {...} until (...) loop {...} end;</pre>

<p>where each <code lang='und' xml:lang='und'>{...}</code> represents a block of statements and each <code lang='und' xml:lang='und'>(...)</code> represents a single boolean expression.</p>

<p>Since the body of the loop is delimited by the braces, we can get rid of the <code lang='und' xml:lang='und'>end</code> keyword:</p>

<pre lang='und' xml:lang='und'>    from {...} invariant (...) variant {...} until (...) loop {...};</pre>

<p>Since we are used to using <code lang='und' xml:lang='und'>redo</code> to go back to the top of the loop block and re&#45;do the current iteration, we&#39;ll replace <code lang='und' xml:lang='und'>loop</code> with <code lang='und' xml:lang='und'>do</code>:</p>

<pre lang='und' xml:lang='und'>    from {...} invariant (...) variant {...} until (...) do {...};</pre>

<p>Eiffel&#39;s <code lang='und' xml:lang='und'>variant</code> clause is equivalent to the Perl <code lang='und' xml:lang='und'>continue</code> clause:</p>

<pre lang='und' xml:lang='und'>    from {...} invariant (...) continue {...} until (...) do {...};</pre>

<p>But, we like to see that clause at the end:</p>

<pre lang='und' xml:lang='und'>    from {...} invariant (...) until (...) do {...} continue {...};</pre>

<p>Since we&#39;ve adopted the Perlish <code lang='und' xml:lang='und'>continue</code> in place of <code lang='und' xml:lang='und'>variant</code>, now <code lang='und' xml:lang='und'>invariant</code> seems out of place, but <code lang='und' xml:lang='und'>check</code> seems to fit nicely:</p>

<pre lang='und' xml:lang='und'>    from {...} check (...) until (...) do {...} continue {...};</pre>

<h2><a name="while"
>while <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>With this Jako definition:</p>

<pre lang='und' xml:lang='und'>    def while block W ( do? block D ( continue? block C )? )? := {
      var R: typeof(D); # TODO: typeof(D) == block, we want type of *last statement of* D.
      CONT: goto :LAST unless eval W;
      REDO: R = eval D;
      NEXT: eval C;
            goto :CONT;
      LAST: return R;
    }</pre>

<p>we can write Perlish while loops:</p>

<pre lang='und' xml:lang='und'>    i = 0;
    while (x[i] &#60; y[i]) do {
      print &#34;$i\n&#34;;
    } continue {
      i++
    }</pre>

<p>In fact, we can even write very concise <code lang='und' xml:lang='und'>while</code> loops, given the optionality of the <code lang='und' xml:lang='und'>do</code> and <code lang='und' xml:lang='und'>continue</code> blocks and the equivalence of <code lang='und' xml:lang='und'>(x;y)</code> to <code lang='und' xml:lang='und'>{x} {y}</code>:</p>

<pre lang='und' xml:lang='und'>    i = 0;
    while (x[i] &#60; y[i]; print &#34;$i\n&#34;; i++);</pre>

<p>(which almost looks like a <code lang='und' xml:lang='und'>for</code> loop).</p>

<h2><a name="for"
>for <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>This Jako definition:</p>

<pre lang='und' xml:lang='und'>    def for block F while? block W continue? block C do? block D := {
      var R: typeof(D); # TODO: typeof(D) == block, we want type of *last statement of* D.
      FOR:  eval F;
      CONT: goto :LAST unless eval W;
      REDO: R = eval D;
      NEXT: eval C;
            goto :CONT;
      LAST: return R;
    }</pre>

<p>allows us to write <code lang='und' xml:lang='und'>for</code> loops the way we are used to, such as:</p>

<pre lang='und' xml:lang='und'>    for (i = 0; i &#60; l; i++) { print x[i], &#34;\n&#34; }</pre>

<p>which is really shorthand for:</p>

<pre lang='und' xml:lang='und'>    for { i = 0 } { i &#60; l } { i++ } { print x[i], &#34;\n&#34; }</pre>

<p>or, more verbosely:</p>

<pre lang='und' xml:lang='und'>    for {
      i = 0;
    } while {
      i &#60; l
    } continue {
      i++
    } do {
      print x[i], &#34;\n&#34;
    }</pre>

<h2><a name="redo,_next_and_last"
>redo, next and last <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>We can define the familiar loop control statements given the consistency of label definitions above:</p>

<pre lang='und' xml:lang='und'>    def redo ( label L )? := {
      goto L:REDO; # if L not given, means &#34;goto :REDO&#34;
    }

    def next ( label L )? := {
      goto L:NEXT; # if L not given, means &#34;goto :NEXT&#34;
    }

    def last ( label L )? := {
      goto L:LAST; # if L not given, means &#34;goto :LAST&#34;
    }</pre>

<p>TODO: Allow <code lang='und' xml:lang='und'>x = next</code>? &#45;&#45; What would that mean?</p>

<h2><a name="if,_then,_elseif_and_else"
>if, then, elseif and else <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<pre lang='und' xml:lang='und'>    def if block I then? block T ( elsif block EI then? block ET )* (else block E)? := {
      var R: typeof(...);
      IF:    goto +:NEXT unless eval I; # &#34;+&#34; &#45;&#45;&#62; forward&#45;only
      REDO:  R = eval T;
             goto +:LAST;
      NEXT:  {
        *:IF:    goto :*:NEXT unless eval *EI;
        *:REDO:  R = eval *ET;
                 goto LAST;
        *:NEXT:
      } over elsif
      REDO:  R = eval E;
      LAST: return R;
    }</pre>

<h1><a name="Object&#45;Oriented_Programming"
>Object&#45;Oriented Programming <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>A class is an environment template. An instance is an environment built from such a template. Method application is the execution of code within the instance&#39;s environment. For example:</p>

<pre lang='und' xml:lang='und'>    y = foo.x</pre>

<p>means to find &#39;x&#39; in the environment &#39;foo&#39; and point &#39;y&#39; in the current environment at it.</p>

<p>Issues: Multiple inheritance for blocks that represent classes vs. single parents for blocks that represent general code sequences.</p>

<p>Analogy:</p>

<pre lang='und' xml:lang='und'>    closure : block  ::  instance : class</pre>

<p>Instantiation as environment cloning.</p>

<h2><a name="self"
>self <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>The word &#39;self&#39; means the enclosing environment (instance, in the case of an object method).</p>

<p>The word &#39;class&#39; means the enclosing environment&#39;s enclosing environment.</p>

<p>Problem:</p>

<pre lang='und' xml:lang='und'>    class {
        method x {
            {
                self.y;      # Looks in method
            }
            self.z;          # Looks in instance
        }
        int y;
        int z;
    }</pre>

<h1><a name="To_Do"
>To Do <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<ul>
<li>Templates and generic programming</li><p class="pad"></p>

<li>Multiple inheritance, renaming and redefinition.</li><p class="pad"></p>

<li>Run&#45;time definition and modification of environments.</li><p class="pad"></p>

<li></li><p class="pad"></p>
</ul>

<h1><a name="References"
>References <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<dl>
<dt><a name="[MEAD&#45;2001]"
>[MEAD&#45;2001]</a></dt><p class="pad"></p>

<dd>Mead, Jerud J. and Shende, Anil M. <i>Persuasive Programming</i>, A|B|F Content, Wilsonville, OR, 2001.</dd><p class="pad"></p>

<dt><a name="[MEYER&#45;1997]"
>[MEYER&#45;1997]</a></dt><p class="pad"></p>

<dd>Meyer, Bertrand. &#34;Object&#45;Oriented Software Construction, Second Edition,&#34; Prentice Hall PTR, Upper Saddle River, NJ, 1997.</dd><p class="pad"></p>

<dt><a name="[MEYER&#45;2001]"
>[MEYER&#45;2001]</a></dt><p class="pad"></p>

<dd>Meyer, Bertrand. &#34;Overloading vs. Object Technology,&#34; <i>Journal of Object&#45;Oriented Programming</i>, October/November 2001 (Vol 14, No. 4).</dd><p class="pad"></p>
</dl>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../../../resources/parrot.small.png" 
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
