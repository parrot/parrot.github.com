<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>  
    <HEAD>
        <TITLE>Untitled</TITLE>
        <LINK REL="stylesheet" TYPE="text/css" 
            HREF="../../../../../resources/perl.css" 
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY> 
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">Untitled</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../../../../html/index.html">Contents</a> | <a href="../../../../../html/languages.html">Language Implementations</a> | <a href="../../../../../html/dotnet.html">.Net</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<h1><a name="Translating_Object_Oriented_Features"
>Translating Object Oriented Features <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h1>

<p>This document discusses the support for object oriented programming that the .NET virtual machine provides,
the support that Parrot provides and how to map the .NET object model onto the Parrot one in a way that,
as far as possible,
will allow other Parrot languages to interoperate with .NET languages.</p>

<h2><a name="The_.NET_Model"
>The .NET Model <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h2>

<p>The .NET object model includes classes with many methods and fields.
Methods and fields may be static or per instance,
and instance methods may be virtual (that is,
subclasses may provide seperate implementations),
thus providing for polymorphism.</p>

<p>Only single inheritance of classes is supported,
however many interfaces may be inherited (or in .NET terminology,
implemented).
An interface is a class with no instance fields and where strictly every method is abstract.
Abstract methods are those with a declaration but no definition (that is,
they have no implementation).
Abstract classes are also available and allow one or more methods to be abstract while others may have an implementation.
They can only be singly inherited.</p>

<p>Details of object oriented constructs are stored in the meta&#45;data tables.
The classes table provides a parent field to reference the parent class.
Every class must have a parent except System.Object.
Interfaces may or may not have a parent.
Mappings of a class to the interfaces it implements are stored in another table and details of fields in yet another.</p>

<h2><a name="The_Parrot_Model"
>The Parrot Model <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h2>

<p>Parrot provides two PMCs that support object orientation,
namely ParrotClass (which represents a class) and ParrotObject (which represents an object; that is,
the instantiation of a class).
A class can inherit many other classes and the inheritance hierachy may change at runtime.</p>

<p>Class creation and definition of the inheritance hierachy are performed through a number of Parrot instructions.
This means that classes are not &#34;hard&#45;wired&#34; at compile time,
and only come into existence at runtime.
It also means that the parents of a particular class must all have been created before that class can be.</p>

<p>A ParrotClass may have many attributes (runtime storage locations per instance of the class that get inherited) and also many properties (runtime storage locations per instance of the class that do not get inherited).
These map to what .NET calls fields.</p>

<p>While Parrot does have some support for interfaces stubbed in,
this has not yet been implemented.</p>

<p>It is possible to find out at runtime the dynamic type of an object (that is,
the class it really is),
whether it is an instance of a particular class (for example,
if A inherits B then an object of type B is an instance of both A and B) and whether a class has a certain method.</p>

<h2><a name="Mapping_.NET_OOP_Onto_Parrot_OOP"
>Mapping .NET OOP Onto Parrot OOP <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h2>

<h3><a name="Classes"
>Classes</a></h3>

<h3><a name="Interfaces"
>Interfaces</a></h3>

<p>Since Parrot currently lacks interfaces,
they have to be &#34;faked out&#34; using classes and taking advantage of multiple inheritance.
An interface is translated just as a class would be,
but each of the methods simply contain code to throw an exception if they are invoked stating that an interface has not been fully implemented.
The constructor also throws an exception to prevent instantiation of interfaces.
This provides all of the required semantics.</p>

<h3><a name="Methods"
>Methods</a></h3>

<h3><a name="Fields"
>Fields</a></h3>

<h3><a name="Class_Inheritance"
>Class Inheritance</a></h3>

<h3><a name="Interface_Implementation"
>Interface Implementation</a></h3>

<p>Since interfaces are really just classes in the translated code,
implementing the interface looks just like inheriting a class.</p>

<h3><a name="Instantiation"
>Instantiation</a></h3>

<h3><a name="Constructors"
>Constructors</a></h3>

<h3><a name="Finalizers"
>Finalizers</a></h3>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../../../../resources/parrot.small.png" 
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
