<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>  
    <HEAD>
        <TITLE>Untitled</TITLE>
        <LINK REL="stylesheet" TYPE="text/css" 
            HREF="../../../resources/perl.css" 
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY> 
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">Untitled</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../../html/index.html">Contents</a> | <a href="../../../html/languages.html">Language Implementations</a> | <a href="../../../html/tap.html">TAP</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<h1><a name="TAP_Parser"
>TAP Parser <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h1>

<p>This is a TAP (Test Anything Protocol) parser.
It is designed to show how to use PGE to write a top&#45;down (recursive&#45;descent) parser.
It has not yet been decided as to whether this will also become a TAP generator.</p>

<p>This effort shows how TAP output is parsed,
and in the future may be used to (among other things) test that HLLs generate proper TAP output.
So,
creating useful test cases and extending the grammar to cover more of TAP is welcome.</p>

<h2><a name="Parsing"
>Parsing <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h2>

<p>The TAP parser lives in the TAP.pbc file.
To create this file,
simply issue the command</p>

<pre lang='und' xml:lang='und'>  $ make</pre>

<p>To invoke the parser from a shell on a TAP input file named &#34;foo.tap&#34;, use:</p>

<pre lang='und' xml:lang='und'>  $ parrot TAP.pbc &#45;&#45;target=parse foo.tap</pre>

<p>To run interactively, entering single&#45;line statements:</p>

<pre lang='und' xml:lang='und'>  $ parrot TAP.pbc &#45;&#45;target=parse</pre>

<h2><a name="Files"
>Files <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h2>

<p>The &#34;top&#34; file for the parser is <em lang='und' xml:lang='und'>TAP.pir</em> which is used to create the <em lang='und' xml:lang='und'>TAP.pbc</em> file. It initializes the overall parsing system and registers the parser as a Parrot &#34;TAP&#34; compiler.</p>

<p>The other files needed for the compiler are in the <em lang='und' xml:lang='und'>src/</em> subdirectory.</p>

<p>The <em lang='und' xml:lang='und'>src/TAP.pg</em> file defines the &#34;top&#45;down&#34; grammar used for TAP output structures, defined using rules in Perl 6 rules syntax. PGE&#39;s &#34;pgc.pir&#34; compiler is then used to compile the grammar file into <em lang='und' xml:lang='und'>src/TAP_gen.pir</em>, which is included by <em lang='und' xml:lang='und'>TAP.pir</em>.</p>

<p>The <em lang='und' xml:lang='und'>src/main.pir</em> file controls what happens when TAP.pbc is invoked directly from parrot (as opposed to being loaded via the load_bytecode op.)</p>

<p>The PIR files in <em lang='und' xml:lang='und'>src/</em> are included as part of compiling <em lang='und' xml:lang='und'>TAP.pir</em> to produce <em lang='und' xml:lang='und'>TAP.pbc</em>.</p>

<p>The <em lang='und' xml:lang='und'>TAP.pbc</em> file can also be used to parse TAP output from PIR:</p>

<pre lang='und' xml:lang='und'>    load_bytecode &#34;TAP.pbc&#34;
    $S0 = &#60;&#60;&#39;TAP&#39;
    1..2
    ok 1
    not ok 2 # todo
    TAP
    $P0 = compreg(&#34;TAP&#34;)                 # obtain the compiler
    $P1 = $P0($S0, &#39;target&#39;=&#62;&#39;parse&#39;)    # parse source code</pre>

<h1><a name="AUTHOR"
>AUTHOR <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h1>

<p>Chris Dolan (<a href='mailto:chris@clotho.net'>mailto:chris@clotho.net</a>) and Jerry Gay (<a href='mailto:jerry.gay@gmail.com'>mailto:jerry.gay@gmail.com</a>) are the authors and maintainers. Patches and suggestions should be sent to the Parrot Porters list (<a href='mailto:parrot&#45;porters@perl.org'>mailto:parrot&#45;porters@perl.org</a>).</p>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../../resources/parrot.small.png" 
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
