<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>  
    <HEAD>
        <TITLE>Preempt STDIN during testing.</TITLE>
        <LINK REL="stylesheet" TYPE="text/css" 
            HREF="../../../../../../../resources/perl.css" 
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY> 
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">Preempt STDIN during testing.</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../../../../../../html/index.html">Contents</a> | <a href="../../../../../../../html/tests.html">Tests</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<h1><a name="NAME"
>NAME <a href='#_top'><img alt='^' border=0 src='../../../../../../../resources/up.gif'></a></a></h1>

<p>Tie::Filehandle::Preempt::Stdin &#45; Preempt STDIN during testing.</p>

<h1><a name="SYNOPSIS"
>SYNOPSIS <a href='#_top'><img alt='^' border=0 src='../../../../../../../resources/up.gif'></a></a></h1>

<pre lang='und' xml:lang='und'>    use Tie::Filehandle::Preempt::Stdin;
    @prompts = qw| alpha beta gamma |;
    $object = tie *STDIN, &#39;Tie::Filehandle::Preempt::Stdin&#39;, @prompts;</pre>

<h1><a name="DESCRIPTION"
>DESCRIPTION <a href='#_top'><img alt='^' border=0 src='../../../../../../../resources/up.gif'></a></a></h1>

<p>Suppose a program requires manual input from the keyboard operator. How do we test that we have properly handled operator input? More specifically, how do we incorporate testing for user input in files built on Perl&#39;s standard testing apparatus (<code lang='und' xml:lang='und'>Test::Simple</code>, <code lang='und' xml:lang='und'>Test::More</code>, etc.)?</p>

<p>Tie::Filehandle::Preempt::Stdin offers one way to do it &#45;&#45; a relatively simple and unsophisticated todo it. The most difficult part is analyzing the program to be tested so that you recognize all the points at which input is needed via STDIN. This in turn requires an understanding of all the different branches your program flow can take in response to standard input. Once you know that, you construct a list of dummy data that will be fed to each test at the points the program, when put into production, would normally prompt for operator input. This list of dummy data &#39;pre&#45;empts&#39; standard input via a tie of filehandle STDIN; hence, the module&#39;s name.</p>

<h1><a name="USAGE"
>USAGE <a href='#_top'><img alt='^' border=0 src='../../../../../../../resources/up.gif'></a></a></h1>

<pre lang='und' xml:lang='und'>    @prompts = qw| alpha beta gamma |;
    $object = tie *STDIN, &#39;Tie::Filehandle::Preempt::Stdin&#39;, @prompts;

    print &#34;Enter item 1:  &#34;;
    chomp($entry = &#60;STDIN&#62;);
    # &#39;alpha&#39; is supplied in lieu of standard input;
    # do something with $entry

    print &#34;Enter item 2:  &#34;;
    chomp($entry = &#60;STDIN&#62;);
    # &#39;beta&#39; is supplied in lieu of standard input;
    # do something with $entry

    print &#34;Enter item 3:  &#34;;
    chomp($entry = &#60;STDIN&#62;);
    # &#39;gamma&#39; is supplied in lieu of standard input;
    # do something with $entry</pre>

<p>Should the number of elements in <code lang='und' xml:lang='und'>@prompts</code> be less than the number of points at which a given test prompts for operator input, you will get an error message:</p>

<pre lang='und' xml:lang='und'>    &#34;List of prompt responses has been exhausted&#34;</pre>

<p>and the program will <code lang='und' xml:lang='und'>croak</code>.</p>

<h1><a name="BUGS"
>BUGS <a href='#_top'><img alt='^' border=0 src='../../../../../../../resources/up.gif'></a></a></h1>

<p>Tie::Filehandle::Preempt::Stdin does not work properly when the source code being tested uses only the Perl diamond operator for standard input.</p>

<pre lang='und' xml:lang='und'>    print &#34;Enter room whose data you wish to enter:  &#34;;
    chomp ($try = &#60;&#62;);</pre>

<p>This doesn&#39;t work; your program will hang. You have to hard&#45;code <code lang='und' xml:lang='und'>STDIN</code> instead.</p>

<pre lang='und' xml:lang='und'>    chomp ($try = &#60;STDIN&#62;);</pre>

<p>I don&#39;t know why this happens. If this bothers you, look at <code lang='und' xml:lang='und'>IO::Scalar</code> which is reported to handle the diamond operator properly, but which, IMHO, has a more complex interface.</p>

<h1><a name="SUPPORT"
>SUPPORT <a href='#_top'><img alt='^' border=0 src='../../../../../../../resources/up.gif'></a></a></h1>

<p>Contact author or post on perl.qa@perl.org.</p>

<h1><a name="AUTHOR"
>AUTHOR <a href='#_top'><img alt='^' border=0 src='../../../../../../../resources/up.gif'></a></a></h1>

<p>James E Keenan. CPAN ID: JKEENAN. Mail to: jkeenan [at] cpan [dot] org.</p>

<h1><a name="ACKNOWLEDGEMENTS"
>ACKNOWLEDGEMENTS <a href='#_top'><img alt='^' border=0 src='../../../../../../../resources/up.gif'></a></a></h1>

<p>The author benefitted from &#45;&#45; but did not always agree with &#45;&#45; comments from the following members of Perlmonks: chromatic, Revelation, tmoertel, NiJo and dragonchild.</p>

<p>Thanks to Michael G Schwern and Kevin Scaldeferri for answering questions on the perl.qa mailing list.</p>

<h1><a name="COPYRIGHT"
>COPYRIGHT <a href='#_top'><img alt='^' border=0 src='../../../../../../../resources/up.gif'></a></a></h1>

<p>Copyright 2005 James E Keenan. This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p>

<p>The full text of the license can be found in the LICENSE file included with this module.</p>

<p>Last revision: Apr 17 2005.</p>

<h1><a name="SEE_ALSO"
>SEE ALSO <a href='#_top'><img alt='^' border=0 src='../../../../../../../resources/up.gif'></a></a></h1>

<p>perltie(1).</p>

<p><i>Programming Perl</i> (3rd ed.), Larry Wall, Tom Christiansen and Jon Orwant. O&#39;Reilly &#38; Associates, 1991. Chapter 14: Tied Variables: section on &#39;&#39;Tying Filehandles,&#39;&#39; p. 384 ff.</p>

<p>Perlmonks discussion starting at: <a href='http://www.perlmonks.org/index.pl?node_id=430997'><a href="http://www.perlmonks.org/index.pl?node_id=430997">http://www.perlmonks.org/index.pl?node_id=430997</a></a>.</p>

<p>Postings on perl.qa at: <a href='http://www.nntp.perl.org/group/perl.qa/4074'><a href="http://www.nntp.perl.org/group/perl.qa/4074">http://www.nntp.perl.org/group/perl.qa/4074</a></a> and <a href='http://www.nntp.perl.org/group/perl.qa/4076'><a href="http://www.nntp.perl.org/group/perl.qa/4076">http://www.nntp.perl.org/group/perl.qa/4076</a></a>.</p>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../../../../../../resources/parrot_small.png" 
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
