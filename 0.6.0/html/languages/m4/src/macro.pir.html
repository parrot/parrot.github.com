<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>  
    <HEAD>
        <TITLE>does macro substitution</TITLE>
        <LINK REL="stylesheet" TYPE="text/css" 
            HREF="../../../../resources/perl.css" 
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY> 
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">does macro substitution</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../../../html/index.html">Contents</a> | <a href="../../../../html/languages.html">Language Implementations</a> | <a href="../../../../html/m4.html">M4</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<h1><a name="NAME"
>NAME <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>src/macro.pir &#45; does macro substitution</p>

<h1><a name="DESCRIPTION"
>DESCRIPTION <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>Copyright: 2004&#45;2005 Bernhard Schmalhofer.
All Rights Reserved.
SVN Info: $Id$ History: Ported from GNU m4 1.4 References: <a href="http://www.gnu.org/software/m4/m4.html">http://www.gnu.org/software/m4/m4.html</a></p>

<h1><a name="SUBROUTINES"
>SUBROUTINES <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<h2><a name="void_expand_input(_Hash_state_)"
>void expand_input( Hash state ) <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>Loop through some input files.
TODO: read files in next_token()</p>

<h2><a name="void_expand_token(_Hash_state,_string_token_type,_string_token_data_)"
>void expand_token( Hash state,
string token_type,
string token_data ) <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>Expand one token,
according to its type.
Potential macro names (TOKEN_WORD) are looked up in the symbol table,
to see if they have a macro definition.
If they have,
they are expanded as macros,
otherwise the text are just copied to the output.</p>

<h2><a name="string_processed_token_expand_macro(_Hash_state,_Hash_symbol_)"
>string processed_token expand_macro( Hash state,
Hash symbol ) <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>The macro expansion is handled by expand_macro().
It parses the arguments in collect_arguments() and builds a ResizablePMCArray containing the arguments.
The arguments themselves are stored on a local obstack.
expand_macro() uses call_macro() to do the call of the macro.</p>

<p>expand_macro() is potentially recursive,
since it calls expand_argument(),
which might call expand_token (),
which might call expand_macro().</p>

<h2><a name="string_processed_token_call_macro(_ResizablePMCArray_macro,_string_token_)"
>string processed_token call_macro( ResizablePMCArray macro,
string token ) <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>Apply macro to a token.</p>

<p>TODO: distinguish between TOKEN_FUNC and TOKEN_WORD</p>

<h2><a name="void_collect_arguments"
>void collect_arguments <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>Collect all the arguments to a call of a macro.</p>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../../../resources/parrot_small.png" 
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
