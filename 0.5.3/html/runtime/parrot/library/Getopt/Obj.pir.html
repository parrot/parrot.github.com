<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
    <HEAD>
        <TITLE>parse long and short command line options</TITLE>
        <LINK REL="stylesheet" TYPE="text/css"
            HREF="../../../../../resources/perl.css"
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY>
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">parse long and short command line options</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../../../../html/index.html">Contents</a> | <a href="../../../../../html/libs.html">Libraries</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<h1><a name="NAME"
>NAME <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h1>

<p>library/Getopt/Obj.pir &#45; parse long and short command line options</p>

<h1><a name="SYNOPSIS"
>SYNOPSIS <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h1>

<pre lang='und' xml:lang='und'> .sub main :main
     .param pmc argv
     .local string prog_name
     prog_name = shift argv
     load_bytecode &#34;Getopt/Obj.pir&#34;
     .local pmc getopts
     getopts = new &#34;Getopt::Obj&#34;
     getopts.&#34;notOptStop&#34;(1)

     # these two are identical, with the exception of the call to name

     push getopts, &#34;foo|f:s&#34;

     $P0 = getopts.&#34;add&#34;()
     $P0.&#34;name&#34;(&#34;FooBar&#34;)
     $P0.&#34;long&#34;(&#34;foo&#34;)
     $P0.&#34;short&#34;(&#34;f&#34;)
     $P0.&#34;optarg&#34;(1)
     $P0.&#34;type&#34;(.String)

     # these two are identical

     push getopts, &#34;bar|b=s&#34;

     $P0 = getopts.&#34;add&#34;()
     $P0.&#34;long&#34;(&#34;bar&#34;)
     $P0.&#34;short&#34;(&#34;b&#34;)
     $P0.&#34;type&#34;(.String)

     .local pmc opts
     opts = getopts.&#34;get_options&#34;(argv)
     .local string foo
     foo = opts[&#34;Foobar&#34;]
 .end</pre>

<h1><a name="DESCRIPTION"
>DESCRIPTION <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h1>

<p>This library parses options from the command line. Options may take and of these forms, currently:</p>

<pre lang='und' xml:lang='und'> &#45;&#45;foo=bar         Set foo to bar
 &#45;f bar            Set f to bar (with conditions)
 &#45;fthis=that       If f is a Hash, set key &#39;this&#39; to &#39;that&#39;
 &#45;f this=that      If f is a Hash, set key &#39;this&#39; to &#39;that&#39;
 &#45;f                Set f (if it&#39;s Boolean or has an optional argument)
 &#45;fbar             Set f to bar if it&#39;s not a Boolean
 &#45;abc              If &#45;a &#45;b and &#45;c are all Booleans, set them all
 &#45;&#45;foo=this=that   If foo is a Hash, set key &#39;this&#39; to &#39;that&#39;
                   Both equal signs are required
 &#45;&#45;                Stop processing args, &#45;&#45; is removed from argv</pre>

<h1><a name="SUBROUTINES"
>SUBROUTINES <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h1>

<dl>
<dt><a name="__load()"
><b><code lang='und' xml:lang='und'>__load()</b></code></a></dt><p class="pad"></p>

<dd>States that Getopt::Obj and Getopt::Obj::Spec are classes to use and defines the attributes they&#39;ll use.</dd><p class="pad"></p>
</dl>

<h2><a name="Class_Getopt::Obj"
>Class Getopt::Obj <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h2>

<p>Our nice little module.</p>

<dl>
<dt><a name="init()"
><b><code lang='und' xml:lang='und'>init()</b></code></a></dt><p class="pad"></p>

<dd>Creates the Specs and notOptStop attribute, interal stuff.</dd><p class="pad"></p>

<dt><a name="HASH_get_options(ARRAY_ARGV)"
><b><code lang='und' xml:lang='und'>HASH get_options(ARRAY ARGV)</b></code></a></dt><p class="pad"></p>

<dd>Parses ARGV, modifying it inplace, and returns a hash with the keys and values wanted.</dd><p class="pad"></p>

<dt><a name="__push_string(STRING_format)"
><b><code lang='und' xml:lang='und'>__push_string(STRING format)</b></code></a></dt><p class="pad"></p>

<dd>A vtable method, invoked by e.g. <code lang='und' xml:lang='und'>push getopts, &#34;foo|f=s&#34;</code>. The format is as such.</dd><p class="pad"></p>

<dl>
<dt><a name="&#34;foo|f&#34;"
>&#34;foo|f&#34;</a></dt><p class="pad"></p>

<dd>A long option of &#34;foo&#34; and a short option of &#34;f&#34; is set to <code lang='und' xml:lang='und'>.Boolean</code>.</dd><p class="pad"></p>

<dt><a name="&#34;foo&#34;"
>&#34;foo&#34;</a></dt><p class="pad"></p>

<dd>A long option of &#34;foo&#34; is set to <code lang='und' xml:lang='und'>.Boolean</code>.</dd><p class="pad"></p>

<dt><a name="&#34;f&#34;"
>&#34;f&#34;</a></dt><p class="pad"></p>

<dd>A short option of &#34;f&#34; is set to <code lang='und' xml:lang='und'>.Boolean</code>.</dd><p class="pad"></p>

<dt><a name="&#34;f=s&#34;"
>&#34;f=s&#34;</a></dt><p class="pad"></p>

<dd>A short option of &#34;f&#34; is set to <code lang='und' xml:lang='und'>.String</code>. Use <code lang='und' xml:lang='und'>i</code> for <code lang='und' xml:lang='und'>.Integer</code>, <code lang='und' xml:lang='und'>f</code> for <code lang='und' xml:lang='und'>.Float</code>, <code lang='und' xml:lang='und'>@</code> for an <code lang='und' xml:lang='und'>.Array</code>, and <code lang='und' xml:lang='und'>%</code> for a <code lang='und' xml:lang='und'>.Hash</code>.</dd><p class="pad"></p>

<dt><a name="&#34;foo:s&#34;"
>&#34;foo:s&#34;</a></dt><p class="pad"></p>

<dd>A long option of &#34;foo&#34; is set to <code lang='und' xml:lang='und'>.String</code>, with &#34;optarg&#34; set to a true value.</dd><p class="pad"></p>
</dl>

<dt><a name="Getopt::Obj::Spec_add()"
><b><code lang='und' xml:lang='und'>Getopt::Obj::Spec add()</b></code></a></dt><p class="pad"></p>

<dd>Adds a new option to the parsing. You don&#39;t need to know what class it is (internal data), just that you get an object to invoke methods on.</dd><p class="pad"></p>

<dt><a name="STRING_getNameForKey(STRING_key)"
><b><code lang='und' xml:lang='und'>STRING getNameForKey(STRING key)</b></code></a></dt><p class="pad"></p>

<dd>Given a key, maybe long or short, or when storing, the name itself perhaps, return the name for the key.</dd><p class="pad"></p>

<dt><a name="INT_self.&#34;notOptStop&#34;()"
><b><code lang='und' xml:lang='und'>INT self.&#34;notOptStop&#34;()</b></code></a></dt><p class="pad"></p>

<dt><a name="INT_self.&#34;notOptStop&#34;(INT_val)"
><b><code lang='und' xml:lang='und'>INT self.&#34;notOptStop&#34;(INT val)</b></code></a></dt><p class="pad"></p>

<dd>Boolean method, so setting it to 2 is no different than setting it to 1. If notOptStop is set to a true value, then get_options will stop after it reaches an argument not specified by the program. This is either an unrecognized option, such as a mistyped argument, or an argument means to be passed on again later. Or of course, it&#39;s not an argument at all and perhaps a filename.</dd><p class="pad"></p>

<dt><a name="MissingRequired(STRING_arg)"
><b><code lang='und' xml:lang='und'>MissingRequired(STRING arg)</b></code></a></dt><p class="pad"></p>

<dd>When a required argument is missing, throws an exception with the message &#34;Missing a required argument for option &#39;foo&#39;&#34;.</dd><p class="pad"></p>
</dl>

<h2><a name="Class_Getopt::Obj::Spec"
>Class Getopt::Obj::Spec <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h2>

<p>Interal use only, at least don&#39;t do any new &#34;Getopt::Obj::Spec&#34; yourself... This makes an easy holder for each possible match.</p>

<dl>
<dt><a name="init()"
><b><code lang='und' xml:lang='und'>init()</b></code></a></dt><p class="pad"></p>

<dd>Set the defaults to all our attributes, more internal stuff. Sets the default &#34;type&#34; to <code lang='und' xml:lang='und'>.Boolean</code>.</dd><p class="pad"></p>

<dt><a name="STRING_self.&#34;name&#34;()"
><b><code lang='und' xml:lang='und'>STRING self.&#34;name&#34;()</b></code></a></dt><p class="pad"></p>

<dt><a name="STRING_self.&#34;name&#34;(STRING_val)"
><b><code lang='und' xml:lang='und'>STRING self.&#34;name&#34;(STRING val)</b></code></a></dt><p class="pad"></p>

<dd>If val is given, set the name to that. If val is not given, return either name, long, or short, in that order. Used for the return key. So if you define only a short option, but want a long name returned, set this. The partial intent of the method is to easily allow having an option have multiple long/short arguments instead of one of each.</dd><p class="pad"></p>

<dt><a name="STRING_self.&#34;long&#34;()"
><b><code lang='und' xml:lang='und'>STRING self.&#34;long&#34;()</b></code></a></dt><p class="pad"></p>

<dt><a name="STRING_self.&#34;long&#34;(STRING_val)"
><b><code lang='und' xml:lang='und'>STRING self.&#34;long&#34;(STRING val)</b></code></a></dt><p class="pad"></p>

<dd>If val is given, set the long value to that. If val is not given, return the string set as the long.</dd><p class="pad"></p>

<dt><a name="STRING_self.&#34;short&#34;()"
><b><code lang='und' xml:lang='und'>STRING self.&#34;short&#34;()</b></code></a></dt><p class="pad"></p>

<dt><a name="STRING_self.&#34;short&#34;(STRING_val)"
><b><code lang='und' xml:lang='und'>STRING self.&#34;short&#34;(STRING val)</b></code></a></dt><p class="pad"></p>

<dd>If val is given, set the short value to that. If val is not given, return the string set as the short.</dd><p class="pad"></p>

<dd>NOTE: There is no checking to ensure that short is only one character.</dd><p class="pad"></p>

<dt><a name="INT_self.&#34;type&#34;()"
><b><code lang='und' xml:lang='und'>INT self.&#34;type&#34;()</b></code></a></dt><p class="pad"></p>

<dt><a name="INT_self.&#34;type&#34;(INT_val)"
><b><code lang='und' xml:lang='und'>INT self.&#34;type&#34;(INT val)</b></code></a></dt><p class="pad"></p>

<dd>If val is given, set the type to that. If val is not given, return the int set as the type.</dd><p class="pad"></p>

<dd>NOTE: It doesn&#39;t verify it&#39;s a corrent type.</dd><p class="pad"></p>

<dd>Use the constants:</dd><p class="pad"></p>

<dl>
<dt><a name=".Boolean"
><b><code lang='und' xml:lang='und'>.Boolean</b></code></a></dt><p class="pad"></p>

<dd>A true/false value, the default.</dd><p class="pad"></p>

<dd>For a short argument, it&#39;s simply <code lang='und' xml:lang='und'>&#45;f</code>. Groups of <code lang='und' xml:lang='und'>.Boolean</code>&#39;s tied together, such as <code lang='und' xml:lang='und'>&#45;foobar</code>, if <code lang='und' xml:lang='und'>&#45;f</code>, <code lang='und' xml:lang='und'>&#45;o</code>, <code lang='und' xml:lang='und'>&#45;b</code>, <code lang='und' xml:lang='und'>&#45;a</code>, and <code lang='und' xml:lang='und'>&#45;r</code> are all <code lang='und' xml:lang='und'>.Boolean</code> values, then each will be set. If <code lang='und' xml:lang='und'>&#45;f</code> is a <code lang='und' xml:lang='und'>.Boolean</code> but one of the others is not, an exception is thrown.</dd><p class="pad"></p>

<dd>For a long argument, it takes the form <code lang='und' xml:lang='und'>&#45;&#45;foo</code>. Usage such as <code lang='und' xml:lang='und'>&#45;&#45;foo=this</code> or <code lang='und' xml:lang='und'>&#45;&#45;foo=</code> are allowed, but it just sets it to true, so no difference.</dd><p class="pad"></p>

<dt><a name=".String"
><b><code lang='und' xml:lang='und'>.String</b></code></a></dt><p class="pad"></p>

<dd>A string. This can take the form of <code lang='und' xml:lang='und'>&#45;&#45;foo=bar</code>, <code lang='und' xml:lang='und'>&#45;f bar</code>, or <code lang='und' xml:lang='und'>&#45;fbar</code>.</dd><p class="pad"></p>

<dt><a name=".Integer"
><b><code lang='und' xml:lang='und'>.Integer</b></code></a></dt><p class="pad"></p>

<dd>An integer, &#45;&#45;foo=3.14 is stored as 3. Type conversions are done by Parrot. Same forms as for <code lang='und' xml:lang='und'>.String</code>.</dd><p class="pad"></p>

<dt><a name=".Float"
><b><code lang='und' xml:lang='und'>.Float</b></code></a></dt><p class="pad"></p>

<dd>A float. Same forms apply here as well.</dd><p class="pad"></p>

<dt><a name=".Array"
><b><code lang='und' xml:lang='und'>.Array</b></code></a></dt><p class="pad"></p>

<dd>An array, done via multiple arguments. For something such as <code lang='und' xml:lang='und'>&#45;I./include &#45;I./src/include</code> for example, <code lang='und' xml:lang='und'>I</code> will be an array of <code lang='und' xml:lang='und'>./include</code> and <code lang='und' xml:lang='und'>./src/include</code>. If only used once, it&#39;s a one sized array.</dd><p class="pad"></p>

<dt><a name=".Hash"
><b><code lang='und' xml:lang='und'>.Hash</b></code></a></dt><p class="pad"></p>

<dd>A hash, such as defines. For a short argument, the form is <code lang='und' xml:lang='und'>&#45;Dfoo=bar</code>, <code lang='und' xml:lang='und'>&#45;Dfoo</code>, and <code lang='und' xml:lang='und'>&#45;&#45;define=foo=bar</code>(both equal signs required).</dd><p class="pad"></p>
</dl>

<dd>Do not hard code the integer values in, for the same reason as the rest of your code. There&#39;s no guarantees they won&#39;t be reassigned.</dd><p class="pad"></p>

<dt><a name="INT_self.&#34;optarg&#34;()"
><b><code lang='und' xml:lang='und'>INT self.&#34;optarg&#34;()</b></code></a></dt><p class="pad"></p>

<dt><a name="INT_self.&#34;optarg&#34;(INT_val)"
><b><code lang='und' xml:lang='und'>INT self.&#34;optarg&#34;(INT val)</b></code></a></dt><p class="pad"></p>

<dd>Boolean method, with explicit setting. If optarg is set to a true value, then the argument, e.g. <code lang='und' xml:lang='und'>bar</code> in <code lang='und' xml:lang='und'>&#45;&#45;foo=bar</code>, is not mandatory. In <code lang='und' xml:lang='und'>&#45;fbar</code>, <code lang='und' xml:lang='und'>&#45;f</code> is set to <code lang='und' xml:lang='und'>bar</code>. In <code lang='und' xml:lang='und'>&#45;f bar</code> it is NOT set.</dd><p class="pad"></p>
</dl>

<h1><a name="TODO"
>TODO <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h1>

<ul>
<li>Actually check what&#39;s being passed instead of using type conversions?</li><p class="pad"></p>

<li>Sub type, call a sub for a given argument, with <code lang='und' xml:lang='und'>argv</code> and <code lang='und' xml:lang='und'>return</code>.</li><p class="pad"></p>

<li>How to handle an unknown arg, currently kept in argv.</li><p class="pad"></p>

<li>Should a lonesome hyphen be a permited value as not an option. Currently kept in argv in case the program wants it, such as indicating stdin or stdout.</li><p class="pad"></p>

<li>For an arg to a short arg, e.g. &#45;C &#45;d, will put &#45;d as the value for &#45;C so long as &#45;C is not a <code lang='und' xml:lang='und'>.Boolean</code>. Should it be an error?</li><p class="pad"></p>
</ul>

<h1><a name="CAVEAT_EMPTOR"
>CAVEAT EMPTOR <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h1>

<p>It&#39;s new, not well tested, etc...</p>

<h1><a name="BUGS"
>BUGS <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h1>

<ul>
<li>If an option is considered optional, then with the short name, the next value is not checked for at all. If it&#39;s not optional, it&#39;s checked and all&#39;s well, as described for <code lang='und' xml:lang='und'>obj.&#34;type&#34;()</code>.</li><p class="pad"></p>

<p>Not positive this is a bug... And relates to the &#45;f &#45;b issue where if the argument to &#45;f is required, it will be given &#39;&#45;b&#39;.</p>

<li>Bundling of options will only work for <code lang='und' xml:lang='und'>.Boolean</code> options. So my little &#34;perl pie&#34; annoyance isn&#39;t handled, <code lang='und' xml:lang='und'>perl &#45;pie &#34;code&#34;</code>, although perl doesn&#39;t handle it in a DWIM manner...</li><p class="pad"></p>

<p>And it doesn&#39;t have good error correction....</p>
</ul>

<h1><a name="AUTHOR"
>AUTHOR <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h1>

<p>Joshua Isom &#45; <code lang='und' xml:lang='und'>loneowl@ritalin.shout.net</code></p>

<h1><a name="SEE_ALSO"
>SEE ALSO <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h1>

<p>The <em lang='und' xml:lang='und'>library/Getopt/Long.pir</em> Parrot library.</p>

<p><em lang='und' xml:lang='und'><a href="../../../../t/library/getopt_obj.t.html">t/library/getopt_obj.t</a></em></p>

<h1><a name="COPYRIGHT"
>COPYRIGHT <a href='#_top'><img alt='^' border=0 src='../../../../../resources/up.gif'></a></a></h1>

<p>Copyright (C) 2006&#45;2008, The Perl Foundation. This program is free software. It is subject to the same license as The Parrot Interpreter.</p>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../../../../resources/parrot_small.png"
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
