<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
    <HEAD>
        <TITLE>A plan for parrot 1.0 and beyond.</TITLE>
        <LINK REL="stylesheet" TYPE="text/css"
            HREF="../../resources/perl.css"
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY>
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">A plan for parrot 1.0 and beyond.</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../html/index.html">Contents</a> | <a href="../../html/info.html">Project Information</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<h1><a name="NAME"
>NAME <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h1>

<p>ROADMAP &#45; A plan for parrot 1.0 and beyond.</p>

<h1><a name="PURPOSE"
>PURPOSE <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h1>

<p>A high level overview of the work that is remaining to release parrot 1.0,
including both user&#45;visibile features and internals.</p>

<p>For detailed information regarding specific tasks,
we will refer to <a href='https://rt.perl.org/rt3'>https://rt.perl.org/rt3</a>.</p>

<p>For a high level overview of funded parrot milestones for 1.0,
please see: <a href='http://www.perlfoundation.org/parrot_grant_from_nlnet'><a href="http://www.perlfoundation.org/parrot_grant_from_nlnet">http://www.perlfoundation.org/parrot_grant_from_nlnet</a></a></p>

<p>This document also contains information about future direction after 1.0.</p>

<h1><a name="LAYOUT"
>LAYOUT <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h1>

<p>Each task is associated with a <b>major</b> release of parrot.
Additionally,
each task will refer to its current state,
and a link to any documentation regarding the task (i.e.
something on Launchpad,
RT,
or in the repository,
or on the wiki).
Tasks with no supporting documentation will be marked [Unspecifed].</p>

<h1><a name="1.0"
>1.0 <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h1>

<h2><a name="Features"
>Features <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h2>

<p><i>TBD</i></p>

<h2><a name="Quality"
>Quality <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h2>

<p>While the 1.0 release must pass all of these quality goals,
future releases will of course adhere to these standards as well.</p>

<ul>
<li>All known GC bugs must be resolved</li><p class="pad"></p>

<li>All known segfaults must be resolved</li><p class="pad"></p>

<li>All features must have comprehensive tests</li><p class="pad"></p>

<li>All features must have comprehensive documentation</li><p class="pad"></p>

<li>All tests must pass on all core platforms</li><p class="pad"></p>

<li>Remove obsolete code/documentation.</li><p class="pad"></p>

<p>Eliminate dead documentation.
Let historians dig through our subversion history.
We look forward toward successful deployment.
&#45;Chip</p>
</ul>

<h1><a name="2.0"
>2.0 <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h1>

<h2><a name="Build_System"
>Build System <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h2>

<ul>
<li>Eliminate perl5 build requirement.
[Unspecified]</li><p class="pad"></p>

<p>Parrot currently requires perl5 to build.
Eventually we wish to eliminate this requirement.</p>
</ul>

<h1><a name="UNREVIEWED_CONTENT"
>UNREVIEWED CONTENT <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h1>

<p>The contents of this file are outdated and must be reviewed.
See RT #48611.
All content beyond this point needs to be validated.</p>

<h1><a name="OVERVIEW"
>OVERVIEW <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h1>

<p>The remaining tasks are broken down into the following categories,
roughly listed in the order through which a task might progress.</p>

<h2><a name="DOCUMENTATION"
>DOCUMENTATION <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h2>

<ul>
<li>When docs and code disagree,
they must be brought into agreement immediately.
At the <i>very</i> least,
appropriately mark docs that are apparently wrong but may eventually become right,
e.g.: &#34;<code lang='und' xml:lang='und'>[NOTE: this does not currently work. Why? &#45;&#45;committer]</code>&#34;.</li><p class="pad"></p>

<p>PDDs are not exceptions to this rule!
Fix them when they&#39;re wrong.
Delete them when they&#39;re obsolete.
(Never delete docs lightly,
though.
Check first with someone who should know.)</p>

<li>Document project goals and priorities.</li><p class="pad"></p>
</ul>

<h2><a name="DESIGN"
>DESIGN <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h2>

<ul>
<li>MMD Roundup 2,
from the mailing list:</li><p class="pad"></p>

<p><a href='http://xrl.us/gvfw'><a href="http://xrl.us/gvfw">http://xrl.us/gvfw</a></a> (Link to groups&#45;beta.google.com)</p>

<p>Section 1 of that email needs a decision from the Architect.</p>

<li>Design the standard library to replace all those opcodes that should never have been opcodes in the first place,
e.g.
the IO and transcendental math features.</li><p class="pad"></p>

<p>(Note: Whatever tech we use to implement transcendental math should at *worst* compile to function calls under JIT.
And I&#39;ll consider making exceptions for the transcendantal math if someone can show me why.)</p>

<p>I expect PIR will still let you pretend they&#39;re opcodes,
though,
to avoid immediate howls of outrage.
(But only silicon&#45;based life forms write PASM,
so we&#39;re not worried about that.)</p>

<li>Finish event and IO specification.</li><p class="pad"></p>

<li>Finish specification of return continuation and sub being called slots in interpreter,
with introspection</li><p class="pad"></p>

<li>Spec out bytecode metadata system and introspection/modification system</li><p class="pad"></p>

<li>Specify what we need to serialize continuations</li><p class="pad"></p>

<li>Solidify design for Truly Evil speed hack for fast regex/string matching</li><p class="pad"></p>

<li>Describe the behavior of the serialization functions.
(freeze,
thaw,
thawfinish,
visit).
<a href='TODO'>PDD02</a></li><p class="pad"></p>

<li>Describe the behavior of <code lang='und' xml:lang='und'>share</code>.
<a href='TODO'>PDD02</a></li><p class="pad"></p>

<li>Describe the components of a <code lang='und' xml:lang='und'>struct PMC_EXT</code>.
<a href='TODO'>PDD04</a></li><p class="pad"></p>

<li>Define what bits of the Parrot internals should be exposed as part of the Parrot API for extension writers.</li><p class="pad"></p>
</ul>

<h2><a name="TODO"
>TODO <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h2>

<ul>
<li>IO: Add IO tables,
right now IO&#39;s just float around.</li><p class="pad"></p>

<li>Finish PMC for IO object</li><p class="pad"></p>

<li>IO&#39;s &#34;stdio&#34; layer: buffering,
seek/random access,
shared streams,
thread safe</li><p class="pad"></p>

<li>Copy&#45;on&#45;write IO stacks</li><p class="pad"></p>

<li>Make IO layer cache the vtable calls to the next layer.</li><p class="pad"></p>

<li>IO Filters</li><p class="pad"></p>

<li>IO mmap support</li><p class="pad"></p>

<li>Bottom level socket/pipe/process support in API</li><p class="pad"></p>

<li>UTF layers (or should we not bother and do as a filter?)</li><p class="pad"></p>

<li>Sample programs and test suite</li><p class="pad"></p>

<li>AIO &#45; On many platforms we must fake async IO,
are we doing a background thread/interp or an inline event queue function that is called every N ops?</li><p class="pad"></p>

<li>Get digest (probably SHA1) added to bytecode segments</li><p class="pad"></p>

<li>Speed up the OrderedHash implementation</li><p class="pad"></p>

<li>Rearchitect internals for the string specifications.</li><p class="pad"></p>

<li>To PerlClass or not to PerlClass,
that is the question.
The class hierarchy should be reworked (e.g.
Boolean&#45;&#62;PerlInt&#45;&#62;Scalar).</li><p class="pad"></p>

<li>Configuration &#45; missing tests for processor features</li><p class="pad"></p>

<li>Configuration &#45; duplication,
e.g.
nvsize/numvalsize</li><p class="pad"></p>

<li>IO &#45; Async core isn&#39;t there yet,
even though it is rumoured to be.</li><p class="pad"></p>

<li>Overflow detection/promotion to bigint/float types.</li><p class="pad"></p>

<li>Fill in the remaining functions from the EDA,
verify that the test suite still passes,
integrate the library into the rest of Parrot,
provide PMC types and suitable opcodes.
Conversion to and from Parrot strings,
conversion to and from floating point types,
sprintf output of bignumbers.
<a href='TODO'>PDD14</a></li><p class="pad"></p>

<p>[[What&#39;s an EDA?
&#45;&#45;Coke]]</p>

<li>TODO &#45; rewrite debugger.</li><p class="pad"></p>
</ul>

<h2><a name="BUGFIX"
>BUGFIX <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h2>

<ul>
<li>You can add parents to a class with children and objects,
and attributes to a class with children or objects.
This is silently allowed and quietly corrupts the child classes and instantiated objects.</li><p class="pad"></p>

<li>building miniparrot is broken</li><p class="pad"></p>

<li>GC issue (copying collector) &#45; immobile strings/buffers get freed during GC.</li><p class="pad"></p>

<li>Memory leak &#45; PIO subsystem leaks file handles (ParrotIO structures)</li><p class="pad"></p>

<li>Memory leak &#45; string_to_cstring returns a malloced string,
which isn&#39;t freed everywhere</li><p class="pad"></p>

<li>Memory Leaks &#45; imcc is currently leaking Unit structures and possibly more</li><p class="pad"></p>

<li>JIT &#45; 64 bit integers on 32 bit machines don&#39;t work</li><p class="pad"></p>

<li>JIT &#45; parrot register inspection is incomplete (P&#45;regs)</li><p class="pad"></p>

<li>This sequence:</li><p class="pad"></p>

<pre lang='und' xml:lang='und'>   loop: dec I0
         inc I1       # or add, sub, ...
         if I0, loop</pre>

<p>isn&#39;t handled correctly on JIT/i386.</p>

<li><code lang='und' xml:lang='und'>Parrot_destroy</code> currently leaks most of the memory that it is supposed to free. <a href='TODO'>embed.pod</a></li><p class="pad"></p>
</ul>

<h2><a name="PORTABILITY"
>PORTABILITY <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h2>

<ul>
<li>Portable fcntl() replacement for platforms without it</li><p class="pad"></p>

<li>See <em lang='und' xml:lang='und'>pdds/draft/pdd01_overview.pod</em>. Test suite should have no failure on supported platforms.</li><p class="pad"></p>

<li>Tests &#45; src/tests are not supported on all platforms</li><p class="pad"></p>

<li>ParrotIO uses integral file descriptors, which may not be portable. <em lang='und' xml:lang='und'><a href="../src/ops/io.ops.html">src/ops/io.ops</a></em></li><p class="pad"></p>

<li>conversion ops for machines without 1/2/4 byte integer data types</li><p class="pad"></p>

<li>32 bit pointer/64 bit integer and vv.</li><p class="pad"></p>

<li>dynamic library loading</li><p class="pad"></p>
</ul>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../resources/parrot_small.png"
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
