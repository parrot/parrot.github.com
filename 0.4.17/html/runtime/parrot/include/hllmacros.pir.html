<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>  
    <HEAD>
        <TITLE>Untitled</TITLE>
        <LINK REL="stylesheet" TYPE="text/css" 
            HREF="../../../../resources/perl.css" 
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY> 
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">Untitled</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../../../html/index.html">Contents</a> | <a href="../../../../html/dynapmc.html">Dynamic PMCs</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<h1><a name="High_Level_Language_Macros"
>High Level Language Macros <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>These macros are to make it easier to write readable and maintainable PIR by preprocessing common HLL forms into their low level PIR forms.
These are <b>not</b> actually high level constructs,
but merely preprocessor directives.</p>

<h2><a name="Conditionals"
>Conditionals <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>When a conditional is labeled as a parameter,
the valid syntax is limited.
Only code snippets such as <code lang='und' xml:lang='und'>$P0</code>,
<code lang='und' xml:lang='und'>$I0 &#60;= 42</code>,
<code lang='und' xml:lang='und'>null $P0</code>,
are allowed.
Groupings such as <code lang='und' xml:lang='und'>$I0 &#60;= 42 || $I0 &#62; 142</code> are not allowed,
although it is possible to write a macro that contains two parameters representing conditionals.</p>

<h2><a name="Code_blocks"
>Code blocks <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>The macro preprocessor is very simple.
But it allows using braces to delimit code that contains commas or right parenthesis,
<code lang='und' xml:lang='und'>)</code>,
without causing an error.
This allows for nesting macros to near infinite depths.
And macro parameter that uses a comma or right parenthesis must be enclosed in braces.</p>

<h1><a name="Macros"
>Macros <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<dl>
<dt><a name=".NL()"
><b><code lang='und' xml:lang='und'>.NL()</b></code></a></dt><p class="pad"></p>

<dd>This is the most simple of macros.
Because PIR statements are delimited by newlines,
putting multiple statements,
no matter how simple or short,
is not allowed.
Sometimes for readability you wish to have two on the same line.
Using <code lang='und' xml:lang='und'>.NL()</code> in a line will insert a linebreak.</dd><p class="pad"></p>

<dt><a name=".If(conditional,_code)"
><b><code lang='und' xml:lang='und'>.If(conditional, code)</b></code></a></dt><p class="pad"></p>

<dd>Runs the code in <code lang='und' xml:lang='und'>code</code> if <code lang='und' xml:lang='und'>conditional</code> is true.</dd><p class="pad"></p>

<dt><a name=".Unless(conditional,_code)"
><b><code lang='und' xml:lang='und'>.Unless(conditional, code)</b></code></a></dt><p class="pad"></p>

<dd>Runs the code in <code lang='und' xml:lang='und'>code</code> if <code lang='und' xml:lang='und'>conditional</code> is false.</dd><p class="pad"></p>

<dt><a name=".IfElse(conditional,_true,_false)"
><b><code lang='und' xml:lang='und'>.IfElse(conditional, true, false)</b></code></a></dt><p class="pad"></p>

<dd>Runs the code in <code lang='und' xml:lang='und'>true</code> if <code lang='und' xml:lang='und'>conditional</code> is true,
otherwise runs the code in <code lang='und' xml:lang='und'>false</code>.</dd><p class="pad"></p>

<dt><a name=".While(conditional,_code)"
><b><code lang='und' xml:lang='und'>.While(conditional, code)</b></code></a></dt><p class="pad"></p>

<dd>Runs the code in <code lang='und' xml:lang='und'>code</code> as long as <code lang='und' xml:lang='und'>conditional</code> is true.</dd><p class="pad"></p>

<dt><a name=".DoWhile(code,_conditional)"
><b><code lang='und' xml:lang='und'>.DoWhile(code, conditional)</b></code></a></dt><p class="pad"></p>

<dd>Runs the code in <code lang='und' xml:lang='und'>code</code> once,
and then as long as <code lang='und' xml:lang='und'>conditional</code> is true.</dd><p class="pad"></p>

<dt><a name=".Loop(code)"
><b><code lang='und' xml:lang='und'>.Loop(code)</b></code></a></dt><p class="pad"></p>

<dd>Runs the code in <code lang='und' xml:lang='und'>code</code> forever.</dd><p class="pad"></p>

<dt><a name=".For(start,_conditional,_continue,_code)"
><b><code lang='und' xml:lang='und'>.For(start, conditional, continue, code)</b></code></a></dt><p class="pad"></p>

<dd>First <code lang='und' xml:lang='und'>start</code> is executed,
such as <code lang='und' xml:lang='und'>i = 0</code>,
and then if the <code lang='und' xml:lang='und'>conditional</code> is true,
runs <code lang='und' xml:lang='und'>code</code>,
and then the <code lang='und' xml:lang='und'>continue</code> code,
such as <code lang='und' xml:lang='und'>inc i</code>.</dd><p class="pad"></p>

<dt><a name=".Foreach(name,_array,_code)"
><b><code lang='und' xml:lang='und'>.Foreach(name, array, code)</b></code></a></dt><p class="pad"></p>

<dd>A simple foreach loop.
Given the aggregate <code lang='und' xml:lang='und'>array</code>,
which <b>must</b> be a register,
it iterates through the array,
putting each value into <code lang='und' xml:lang='und'>name</code> to work with in <code lang='und' xml:lang='und'>code</code>.</dd><p class="pad"></p>
</dl>

<h1><a name="Examples"
>Examples <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<h2><a name="Good_morning!"
>Good morning! <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>&#34;Hello,
world!&#34; is so mundane,
make it more fun.</p>

<pre lang='und' xml:lang='und'>    .include &#34;tm.pasm&#34;
    .include &#34;hllmacros.pir&#34;
    .sub main :main
        $I0 = time
        $P0 = decodelocaltime $I0
        $I0 = $P0[.TM_HOUR]
        .IfElse($I0 &#60; 12,{
            print &#34;Good morning!\n&#34;
        },{
            .IfElse($I0 &#62; 18,{
                print &#34;Good night!\n&#34;
            },{
                print &#34;Good evening!\n&#34;
            })
        })
    .end</pre>

<h2><a name="Simple_looping"
>Simple looping <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>A simple demonstration of the For loop.</p>

<pre lang='und' xml:lang='und'>    .include &#34;hllmacros.pir&#34;
    .sub main :main
        print &#34;For\n&#34;
        .For(i = 0 , i &#60; 5, inc i,
            print &#34;\t&#34;
            print i
            print &#34;\n&#34;
        )
    .end</pre>

<p>A simple demonstration of the Foreach loop.</p>

<pre lang='und' xml:lang='und'>    .include &#34;hllmacros.pir&#34;
    .sub main :main
        print &#34;Foreach\n&#34;
        .local pmc array, letter
        array = new &#39;ResizablePMCArray&#39;
        push array, &#34;a&#34;
        push array, &#34;b&#34;
        push array, &#34;c&#34;
        .Foreach(letter, array, {
            print &#34;\t&#34;
            print letter
            print &#34; &#34;
            .IfElse(letter == &#39;b&#39;,
                print &#34;is b\n&#34;
            ,
                print &#34;isn&#39;t b\n&#34;
            )
        })
    .end</pre>

<p>Using <code lang='und' xml:lang='und'>.NL()</code></p>

<pre lang='und' xml:lang='und'>    .local int i, j
    .For({i = 0 .NL() j = 11}, i &#60; j, {inc i .NL() dec j }, {
        print i
        print &#34;\t&#34;
        print j
        print &#34;\n&#34;
    })</pre>

<h1><a name="Caveats"
>Caveats <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>The .Foreach macro is not nestable within itself currently. You can use other macros inside a .Foreach loop, and the .Foreach loop can be nested inside other macros.</p>

<pre lang='und' xml:lang='und'>    .Foreach(foo, bar, {
        .Foreach(foobar, foo, {
            print foobar
        })
    })</pre>

<p>Will not run as you would expect.</p>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../../../resources/parrot.small.png" 
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
