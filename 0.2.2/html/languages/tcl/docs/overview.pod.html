<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>  
    <HEAD>
        <TITLE>Untitled</TITLE>
        <LINK REL="stylesheet" TYPE="text/css" 
            HREF="../../../../resources/perl.css" 
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY> 
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">Untitled</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../../../html/index.html">Contents</a> | <a href="../../../../html/languages.html">Language Implementations</a> | <a href="../../../../html/tcl.html">TCL</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<h1><a name="OVERVIEW"
>OVERVIEW <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>This was originally written as a perl5 script.
Rather than doing bootstrapping,
I foolishly decided it would be fun to write the parser IN parrot assembly,
esp.
as this would help implementing &#34;eval&#34; and &#34;proc&#34; (Of course,
in retrospect,
I really wish I had kept with the bootstrapping effort,
as I think it would have generated usable results sooner.
Ah well,
I now know more than I want to about IMCC.
=&#45;)</p>

<p>This is a from&#45;scratch implementation,
based only on the tcl man page(s).
Another interesting project would have been to modify the tcl source and have it generate parrot directly.
Many people smarter than I am have declared this <i>hard</i>,
so I&#39;m rather happy I&#39;m working on it this way.</p>

<p>(Apparently Tcl&#39;s bytecode engine is very optimized for Tcl (big surprise).
So,
converting the tcl&#45;specific bytecodes there to parrot would apparently be a big deal.)</p>

<h1><a name="RUNNING_TCL"
>RUNNING TCL <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>When you make tcl,
you&#39;re generating three files.</p>

<dl>
<dt><a name="lib/tclword.pbc"
>lib/tclword.pbc</a></dt><p class="pad"></p>

<dd>This is a parrot class that is used by the parser as the intermediate representation after parsing.
So,
for example,
a line like</dd><p class="pad"></p>

<pre lang='und' xml:lang='und'> set a &#34;$b &#34; </pre>

<dd>would, after parsing, be comprised of three tclwords. The first, the constant <code lang='und' xml:lang='und'>set</code>, the second, the constant <code lang='und' xml:lang='und'>a</code>, and the third would consist of two elements: the variable reference for <code lang='und' xml:lang='und'>b</code>, followed by the constant <code lang='und' xml:lang='und'> </code>.</dd><p class="pad"></p>

<dt><a name="lib/tcllib.pbc"
>lib/tcllib.pbc</a></dt><p class="pad"></p>

<dd>This file is used to load all the various commands, ops, etc. into the appropriate namespaces, as well as declare and register the TCL compiler for the <code lang='und' xml:lang='und'>compile</code> opcode.</dd><p class="pad"></p>

<dd>This file is actually built in two steps. The first step uses <code lang='und' xml:lang='und'>tcl.pl</code> to generate <code lang='und' xml:lang='und'>lib/tcllib.imc</code>, using <code lang='und' xml:lang='und'>tcl.imc_template</code> as a template. The file is basically passed through unchanged, except for a few <code lang='und' xml:lang='und'>${ }</code> &#45;style substitutions. <code lang='und' xml:lang='und'>INCLUDES</code> make sure all the required <code lang='und' xml:lang='und'>.imc</code> files are included properly. It adds a <code lang='und' xml:lang='und'>HEADER</code>, and removes any <code lang='und' xml:lang='und'>XXX</code> comments.</dd><p class="pad"></p>

<dt><a name="tcl.pbc"
>tcl.pbc</a></dt><p class="pad"></p>

<dd>This is roughly equivalent to <code lang='und' xml:lang='und'>tclsh</code> &#45; It takes the command line arguments (currently, the name of the file you wish to parse), and reads in the file, and uses the tcl library to parse those contents as tcl.</dd><p class="pad"></p>
</dl>

<h1><a name="TESTS"
>TESTS <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>To run the test suite, <code lang='und' xml:lang='und'>make test</code>. If you want to also get output from the TODO tests, <code lang='und' xml:lang='und'>make devtest</code> instead. This is NOT the tcl test suite, it&#39;s a very small subset of features that I was sick of fixing everytime I made a small change to the parser.</p>

<h1><a name="EXAMPLES"
>EXAMPLES <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>There are examples in the <code lang='und' xml:lang='und'>examples</code> directory that are vaguely more interesting. To run one of the <code lang='und' xml:lang='und'>foo.tcl</code> files in that directory, type <code lang='und' xml:lang='und'>make foo</code>.</p>

<h1><a name="POD_ERRORS"
>POD ERRORS <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>Hey! <b>The above document had some coding errors, which are explained below:</b></p>

<dl>
<dt><a name="Around_line_55:"
>Around line 55:</a></dt><p class="pad"></p>

<dd>=back doesn&#39;t take any parameters, but you said =back 4</dd><p class="pad"></p>
</dl>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../../../resources/parrot.small.png" 
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
