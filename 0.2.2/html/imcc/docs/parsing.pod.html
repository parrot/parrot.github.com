<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>  
    <HEAD>
        <TITLE>parsing</TITLE>
        <LINK REL="stylesheet" TYPE="text/css" 
            HREF="../../../resources/perl.css" 
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY> 
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">parsing</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../../html/index.html">Contents</a> | <a href="../../../html/imcc.html">IMCC</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<h1><a name="NAME"
>NAME <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h1>

<p>IMCC &#45; parsing</p>

<h1><a name="VERSION"
>VERSION <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h1>

<dl>
<dt><a name="0.1_initial"
>0.1 initial</a></dt><p class="pad"></p>

<dt><a name="0.2_lexicals"
>0.2 lexicals</a></dt><p class="pad"></p>

<dt><a name="0.3_pod_markers"
>0.3 pod markers</a></dt><p class="pad"></p>

<dt><a name="0.4_deprecate_nested_subs_and_code_outside_compilation_units"
>0.4 deprecate nested subs and code outside compilation units</a></dt><p class="pad"></p>
</dl>

<h1><a name="OVERVIEW"
>OVERVIEW <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h1>

<p>This document describes the basic parsing functionality of IMCC.</p>

<h1><a name="DESCRIPTION"
>DESCRIPTION <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h1>

<p>IMCC parses and generates code in terms of <i>compilation units</i>.
These are self&#45;contained blocks of code very similar to subroutines.</p>

<p>Code for a compilation unit is created as soon (or not earlier) as the end of the unit is reached.</p>

<h1><a name="General_imcc_syntax"
>General imcc syntax <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h1>

<pre lang='und' xml:lang='und'>        program: subs

        subs: statements ...</pre>

<h2><a name="Comments"
>Comments <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h2>

<p>Comments start with <code lang='und' xml:lang='und'>#</code>, which may appear at any point on a line, and end at the end of the line.</p>

<h2><a name="POD_sections"
>POD sections <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h2>

<p>Everything enclosed in POD markers is ignored.</p>

<pre lang='und' xml:lang='und'>        =some_pod_marker in col 1
        ...
        =cut</pre>

<p>A POD section starts with a <b>=</b> in column 1 and ends with a <b>=cut</b> on a line on its own.</p>

<h1><a name="Compilation_units"
>Compilation units <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h1>

<h2><a name="Subroutines:_.sub_..._.end"
>Subroutines: .sub ... .end <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h2>

<p>This code:</p>

<pre lang='und' xml:lang='und'>        .sub name
                statements
                ...
        .end</pre>

<p>defines a subroutine with the entry point <code lang='und' xml:lang='und'>_name</code>. Subroutine entry points have to start with an underscore (as do all other global labels). The statements in the subroutine must be valid PIR or PASM.</p>

<h2><a name="Subroutines:_.pcc_sub_..._.end"
>Subroutines: .pcc_sub ... .end <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h2>

<pre lang='und' xml:lang='und'>        .sub name
                statements
                ...
        .end</pre>

<p>As above, but using the Parrot calling conventions. See <em lang='und' xml:lang='und'>docs/calling_conventions.pod</em> for more details.</p>

<h2><a name="Assembly_blocks_.emit_..._.eom"
>Assembly blocks .emit ... .eom <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h2>

<p>This code:</p>

<pre lang='und' xml:lang='und'>        .emit
        _sub1:
                pasm_statements
                ...
                ret
        ...
        .eom</pre>

<p>defines a compilation unit containing PASM statements only. Typical usage is for language initialization and builtins code.</p>

<h2><a name="Code_outside_compilation_units"
>Code outside compilation units <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h2>

<p>Any code appearing outside of a compilation unit will be ignored (if not now, then in the near future).</p>

<h2><a name="Nested_subs"
>Nested subs <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h2>

<p>Nested subroutines are deprecated and will be removed in the near future.</p>

<h1><a name="Symbols,_constants_and_labels"
>Symbols, constants and labels <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h1>

<p><i>Compilation units</i> maintain their own symbol table containing local labels and variable symbols. This symbol table, <code lang='und' xml:lang='und'>hash</code>, is not visible to code in different units.</p>

<p>If you need global variables, please use the <b>global</b> opcode.</p>

<p>Global labels and constants are kept in the global symbol table <code lang='und' xml:lang='und'>ghash</code>. This allows for global constant folding beyond the scope of individual subroutines.</p>

<p>Local labels in different <i>compilation units</i> with the same name are allowed, though assembling the generated PASM doesn&#39;t work. However, running this code inside imcc is ok. This will probably change in the future so that local labels are mangled to be unique.</p>

<h1><a name="SEE_ALSO"
>SEE ALSO <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h1>

<p><em lang='und' xml:lang='und'>docs/calling_conventions.pod</em></p>

<h1><a name="FILES"
>FILES <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h1>

<p><em lang='und' xml:lang='und'>imcc.y</em>, <em lang='und' xml:lang='und'>instructions.c</em>, <em lang='und' xml:lang='und'>t/syn/sub.t</em>, <em lang='und' xml:lang='und'>t/imcpasm/sub.t</em>, <em lang='und' xml:lang='und'>t/syn/scope.t</em></p>

<h1><a name="AUTHOR"
>AUTHOR <a href='#_top'><img alt='^' border=0 src='../../../resources/up.gif'></a></a></h1>

<p>Leopold Toetsch &#60;lt@toetsch.at&#62;</p>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../../resources/parrot.small.png" 
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
