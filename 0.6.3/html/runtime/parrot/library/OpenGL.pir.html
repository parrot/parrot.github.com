<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
    <HEAD>
        <TITLE>Parrot extension for OpenGL bindings</TITLE>
        <LINK REL="stylesheet" TYPE="text/css"
            HREF="../../../../resources/perl.css"
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY>
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">Parrot extension for OpenGL bindings</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../../../html/index.html">Contents</a> | <a href="../../../../html/libs.html">Libraries</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<h1><a name="NAME"
>NAME <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>OpenGL &#45; Parrot extension for OpenGL bindings</p>

<h1><a name="SYNOPSIS"
>SYNOPSIS <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>This covers only the basic OpenGL and GLUT initialization.
For more,
look in <em lang='und' xml:lang='und'>examples/opengl/</em>,
starting with <em lang='und' xml:lang='und'><a href="../../../examples/opengl/triangle.pir.html">examples/opengl/triangle.pir</a></em>.</p>

<pre lang='und' xml:lang='und'> # Include OpenGL constants
 .include &#39;opengl_defines.pasm&#39;

 .sub main :main
    .param pmc argv

    # Load OpenGL libary and a helper library for calling glutInit
    load_bytecode &#39;library/OpenGL.pbc&#39;
    load_bytecode &#39;library/NCI/call_toolkit_init.pbc&#39;

    # Import all OpenGL/GLU/GLUT functions
    .local pmc import_gl
    import_gl = get_global [&#39;OpenGL&#39;], &#39;_export_all_functions&#39;
    import_gl()

    # Initialize GLUT
    .local pmc call_toolkit_init
    call_toolkit_init = get_global [&#39;NCI&#39;], &#39;call_toolkit_init&#39;

    .const .Sub glutInit = &#39;glutInit&#39;
    argv = call_toolkit_init(glutInit, argv)

    # Set display mode, create GLUT window, save window handle
    .local int mode
    mode = .GLUT_DOUBLE | .GLUT_RGBA
    glutInitDisplayMode(mode)

    .local pmc window
    window = new &#39;Integer&#39;
    window = glutCreateWindow(&#39;My Window Title&#39;)
    set_global &#39;glut_window&#39;, window

    # Set up GLUT callbacks
    .const .Sub draw     = &#39;draw&#39;
    .const .Sub idle     = &#39;idle&#39;
    .const .Sub keyboard = &#39;keyboard&#39;
    glutDisplayFunc (draw)
    glutIdleFunc    (idle)
    glutKeyboardFunc(keyboard)

    # Enter the GLUT main loop
    glutMainLoop()
 .end</pre>

<h1><a name="DESCRIPTION"
>DESCRIPTION <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h1>

<p>This library is a straightforward Parrot NCI wrapper for OpenGL, GLU, and GLUT. It is still a work in progress; work will generally start with the oldest, most widely supported functions and progress to the most recently standardized calls. Generally you will find programming GLUT in PIR to be similar to GLUT in C &#45;&#45; for heavy drawing code, it is sometimes difficult to tell the difference except for the leading period on PIR constant names and lack of trailing semicolons on each line.</p>

<p>The following sections describe features of Parrot&#39;s OpenGL bindings that are not part of the core C binding, or where they differ non&#45;trivially.</p>

<h2><a name="Initialization"
>Initialization <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>The initialization routines are mostly for internal use only. They include:</p>

<dl>
<dt><a name="_opengl_init()"
>_opengl_init()</a></dt><p class="pad"></p>

<dd>At module load time, calls the other initialization routines in the proper order.</dd><p class="pad"></p>

<dt><a name="_load_opengl_libs()"
>_load_opengl_libs()</a></dt><p class="pad"></p>

<dd>Opens all relevent OpenGL system libraries. For portability, tries each of the known different filenames for each library in turn before giving up.</dd><p class="pad"></p>

<dt><a name="_load_lib_with_fallbacks(string_friendly_name,_pmc_fallback_list)"
>_load_lib_with_fallbacks(string friendly_name, pmc fallback_list)</a></dt><p class="pad"></p>

<dd>This function is more generally useful than just for this module &#45;&#45; it implements the search for a particular libary that may appear under any of several different filenames. The <code lang='und' xml:lang='und'>fallback_list</code> should be a simple array of strings, each naming one of the possible filenames, <i>without</i> the trailing shared library extension (e.g. <code lang='und' xml:lang='und'>.dll</code> or <code lang='und' xml:lang='und'>.so</code>). The <code lang='und' xml:lang='und'>friendly_name</code> is only used to fill in the error message in case no match can be found on the system.</dd><p class="pad"></p>

<dt><a name="_wrap_all_opengl_entry_points()"
>_wrap_all_opengl_entry_points()</a></dt><p class="pad"></p>

<dd>Create NCI wrappers for all GL, GLU, and GLUT functions</dd><p class="pad"></p>

<dt><a name="_wrap_nci_list(pmc_namespace,_pmc_library,_pmc_nci_list)"
>_wrap_nci_list(pmc namespace, pmc library, pmc nci_list)</a></dt><p class="pad"></p>

<dd>Create NCI wrappers for every <code lang='und' xml:lang='und'>library</code> entry point in <code lang='und' xml:lang='und'>nci_list</code>, and store the results in <code lang='und' xml:lang='und'>namespace</code> . The list should consist of alternating function names and Parrot NCI signatures.</dd><p class="pad"></p>
</dl>

<h2><a name="Symbol_Export"
>Symbol Export <a href='#_top'><img alt='^' border=0 src='../../../../resources/up.gif'></a></a></h2>

<p>These routines allow OpenGL symbols to exported to other namespaces to more directly replicate the normal OpenGL coding style. Most calling programs will want to use at least one of these, probably immediately after loading this library.</p>

<dl>
<dt><a name="_export_all_functions(pmc_to_namespace_:optional)"
>_export_all_functions(pmc to_namespace :optional)</a></dt><p class="pad"></p>

<dd>Export all OpenGL/GLU/GLUT functions to the target <code lang='und' xml:lang='und'>namespace</code>. Unmangles callback names, so that the receiving namespace sees the standard names instead of the mangled versions. If <code lang='und' xml:lang='und'>to_namespace</code> is missing, then the caller&#39;s namespace is assumed.</dd><p class="pad"></p>
</dl>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../../../resources/parrot_small.png"
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
