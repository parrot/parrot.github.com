<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
    "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
    <HEAD>
        <TITLE>Parrot extension interface</TITLE>
        <LINK REL="stylesheet" TYPE="text/css"
            HREF="../../resources/perl.css"
            TITLE="Default CSS2" media="screen">
    </HEAD>
    <BODY>
        <A NAME="_top"></A>
        <TABLE CELLSPACING="0" WIDTH="730">
            <TR>
                <TD WIDTH="100%" COLSPAN="2" CLASS="BANNER">parrotcode: <SPAN CLASS="title">Parrot extension interface</SPAN></TD>
            </TR>
            <TR>
                <TD WIDTH="100%" COLSPAN="2"  ID="NAV" STYLE="border-bottom: 1px solid #191970;">
                    <a href="../../html/index.html">Contents</a> | <a href="../../html/c.html">C</a>
                </TD>
            </TR>
        </TABLE>
        <DIV CLASS="pod">

<h1><a name="NAME"
>NAME <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h1>

<p>src/extend.c &#45; Parrot extension interface</p>

<h1><a name="DESCRIPTION"
>DESCRIPTION <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h1>

<p>These are the functions that parrot extensions (i.e.
parrot subroutines written in C,
or some other compiled language,
rather than in parrot bytecode) may access.</p>

<p>There is a deliberate distancing from the internals here.
Don&#39;t go peeking inside &#45;&#45; you&#39;ve as much access as bytecode does,
but no more,
so we can provide backwards compatibility for as long as we possibly can.</p>

<h2><a name="Functions"
>Functions <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h2>

<dl>
<dt><a name="int_Parrot_vfprintf"
><b><code lang='und' xml:lang='und'>int Parrot_vfprintf</b></code></a></dt><p class="pad"></p>

<dd>Writes a C string format with a varargs list to a PIO.</dd><p class="pad"></p>

<dt><a name="int_Parrot_fprintf"
><b><code lang='und' xml:lang='und'>int Parrot_fprintf</b></code></a></dt><p class="pad"></p>

<dd>Writes a C string format with varargs to a PIO.</dd><p class="pad"></p>

<dt><a name="int_Parrot_printf"
><b><code lang='und' xml:lang='und'>int Parrot_printf</b></code></a></dt><p class="pad"></p>

<dd>Writes a C string format with varargs to <code lang='und' xml:lang='und'>stdout</code>.</dd><p class="pad"></p>

<dt><a name="int_Parrot_eprintf"
><b><code lang='und' xml:lang='und'>int Parrot_eprintf</b></code></a></dt><p class="pad"></p>

<dd>Writes a C string format with varargs to <code lang='und' xml:lang='und'>stderr</code>.</dd><p class="pad"></p>

<dt><a name="Parrot_String_Parrot_PMC_get_string_intkey"
><b><code lang='und' xml:lang='und'>Parrot_String Parrot_PMC_get_string_intkey</b></code></a></dt><p class="pad"></p>

<dd>Return the integer keyed string value of the passed&#45;in PMC</dd><p class="pad"></p>

<dt><a name="void_*_Parrot_PMC_get_pointer_intkey"
><b><code lang='und' xml:lang='und'>void *Parrot_PMC_get_pointer_intkey</b></code></a></dt><p class="pad"></p>

<dd>Return a pointer to the PMC indicated by an integer key.</dd><p class="pad"></p>

<dt><a name="Parrot_PMC_Parrot_PMC_get_pmc_intkey"
><b><code lang='und' xml:lang='und'>Parrot_PMC Parrot_PMC_get_pmc_intkey</b></code></a></dt><p class="pad"></p>

<dd>Return the integer keyed PMC value of the passed&#45;in PMC</dd><p class="pad"></p>

<dt><a name="Parrot_Int_Parrot_PMC_get_intval"
><b><code lang='und' xml:lang='und'>Parrot_Int Parrot_PMC_get_intval</b></code></a></dt><p class="pad"></p>

<dd>Return the signed integer value of the value in the PMC.</dd><p class="pad"></p>

<dt><a name="Parrot_Int_Parrot_PMC_get_intval_intkey"
><b><code lang='und' xml:lang='und'>Parrot_Int Parrot_PMC_get_intval_intkey</b></code></a></dt><p class="pad"></p>

<dd>Return the keyed,
signed integer value of the value in the PMC.</dd><p class="pad"></p>

<dt><a name="Parrot_Int_Parrot_PMC_get_intval_pmckey"
><b><code lang='und' xml:lang='und'>Parrot_Int Parrot_PMC_get_intval_pmckey</b></code></a></dt><p class="pad"></p>

<dd>Return the keyed,
signed integer value of the value in the PMC.</dd><p class="pad"></p>

<dt><a name="Parrot_Float_Parrot_PMC_get_numval"
><b><code lang='und' xml:lang='und'>Parrot_Float Parrot_PMC_get_numval</b></code></a></dt><p class="pad"></p>

<dd>Return the floating&#45;point value of the PMC.</dd><p class="pad"></p>

<dt><a name="Parrot_Float_Parrot_PMC_get_numval_intkey"
><b><code lang='und' xml:lang='und'>Parrot_Float Parrot_PMC_get_numval_intkey</b></code></a></dt><p class="pad"></p>

<dd>Return the keyed,
signed integer value of the value in the PMC.</dd><p class="pad"></p>

<dt><a name="char_*_Parrot_PMC_get_cstring_intkey"
><b><code lang='und' xml:lang='und'>char *Parrot_PMC_get_cstring_intkey</b></code></a></dt><p class="pad"></p>

<dd>Return a null&#45;terminated string that represents the string value of the PMC.</dd><p class="pad"></p>

<dd>Note that you must free this string with <code lang='und' xml:lang='und'>string_cstring_free()</code>!</dd><p class="pad"></p>

<dt><a name="char_*_Parrot_PMC_get_cstring"
><b><code lang='und' xml:lang='und'>char *Parrot_PMC_get_cstring</b></code></a></dt><p class="pad"></p>

<dd>Return a null&#45;terminated string that represents the string value of the PMC.</dd><p class="pad"></p>

<dd>Note that you must free this string with <code lang='und' xml:lang='und'>string_cstring_free()</code>!</dd><p class="pad"></p>

<dt><a name="char_*_Parrot_PMC_get_cstringn"
><b><code lang='und' xml:lang='und'>char *Parrot_PMC_get_cstringn</b></code></a></dt><p class="pad"></p>

<dd>Return a null&#45;terminated string for the PMC,
along with the length.</dd><p class="pad"></p>

<dd>Yes,
right now this is a bit of a cheat.
It needs fixing,
but without disturbing the interface.</dd><p class="pad"></p>

<dd>Note that you must free the string with <code lang='und' xml:lang='und'>string_cstring_free()</code>.</dd><p class="pad"></p>

<dt><a name="char_*_Parrot_PMC_get_cstringn_intkey"
><b><code lang='und' xml:lang='und'>char *Parrot_PMC_get_cstringn_intkey</b></code></a></dt><p class="pad"></p>

<dd>Return a null&#45;terminated string for the PMC,
along with the length.</dd><p class="pad"></p>

<dd>Yes,
right now this is a bit of a cheat.
It needs fixing,
but without disturbing the interface.</dd><p class="pad"></p>

<dd>Note that you must free this string with <code lang='und' xml:lang='und'>string_cstring_free()</code>.</dd><p class="pad"></p>

<dt><a name="void_Parrot_PMC_set_string"
><b><code lang='und' xml:lang='und'>void Parrot_PMC_set_string</b></code></a></dt><p class="pad"></p>

<dd>Assign the passed&#45;in Parrot string to the passed&#45;in PMC.</dd><p class="pad"></p>

<dt><a name="void_Parrot_PMC_set_string_intkey"
><b><code lang='und' xml:lang='und'>void Parrot_PMC_set_string_intkey</b></code></a></dt><p class="pad"></p>

<dd>Assign the passed&#45;in Parrot string to the passed&#45;in PMC.</dd><p class="pad"></p>

<dt><a name="void_Parrot_PMC_set_pmc_intkey"
><b><code lang='und' xml:lang='und'>void Parrot_PMC_set_pmc_intkey</b></code></a></dt><p class="pad"></p>

<dd>Assign the passed&#45;in pmc to the passed&#45;in slot of the passed&#45;in PMC.</dd><p class="pad"></p>

<dt><a name="void_Parrot_PMC_set_pmc_pmckey"
><b><code lang='und' xml:lang='und'>void Parrot_PMC_set_pmc_pmckey</b></code></a></dt><p class="pad"></p>

<dd>Assign the passed&#45;in pmc to the passed&#45;in slot of the passed&#45;in PMC.</dd><p class="pad"></p>

<dt><a name="void_Parrot_PMC_set_pointer_intkey"
><b><code lang='und' xml:lang='und'>void Parrot_PMC_set_pointer_intkey</b></code></a></dt><p class="pad"></p>

<dd>Assign the passed&#45;in pointer to the passed&#45;in PMC.</dd><p class="pad"></p>

<dt><a name="void_Parrot_PMC_set_intval"
><b><code lang='und' xml:lang='und'>void Parrot_PMC_set_intval</b></code></a></dt><p class="pad"></p>

<dd>Assign the passed&#45;in Parrot integer to the passed&#45;in PMC.</dd><p class="pad"></p>

<dt><a name="void_Parrot_PMC_set_intval_intkey"
><b><code lang='und' xml:lang='und'>void Parrot_PMC_set_intval_intkey</b></code></a></dt><p class="pad"></p>

<dd>Assign the passed&#45;in Parrot integer to the passed&#45;in PMC.</dd><p class="pad"></p>

<dt><a name="void_Parrot_PMC_set_numval"
><b><code lang='und' xml:lang='und'>void Parrot_PMC_set_numval</b></code></a></dt><p class="pad"></p>

<dd>Assign the passed&#45;in Parrot number to the passed&#45;in PMC.</dd><p class="pad"></p>

<dt><a name="void_Parrot_PMC_set_numval_intkey"
><b><code lang='und' xml:lang='und'>void Parrot_PMC_set_numval_intkey</b></code></a></dt><p class="pad"></p>

<dd>Assign the passed&#45;in Parrot number to the passed&#45;in PMC.</dd><p class="pad"></p>

<dt><a name="void_Parrot_PMC_set_cstring"
><b><code lang='und' xml:lang='und'>void Parrot_PMC_set_cstring</b></code></a></dt><p class="pad"></p>

<dd>Assign the passed&#45;in null&#45;terminated C string to the passed&#45;in PMC.</dd><p class="pad"></p>

<dt><a name="void_Parrot_PMC_set_cstring_intkey"
><b><code lang='und' xml:lang='und'>void Parrot_PMC_set_cstring_intkey</b></code></a></dt><p class="pad"></p>

<dd>Assign the passed&#45;in null&#45;terminated C string to the passed&#45;in PMC.</dd><p class="pad"></p>

<dt><a name="void_Parrot_PMC_set_cstringn"
><b><code lang='und' xml:lang='und'>void Parrot_PMC_set_cstringn</b></code></a></dt><p class="pad"></p>

<dd>Assign the passed&#45;in length&#45;noted string to the passed&#45;in PMC.</dd><p class="pad"></p>

<dt><a name="void_Parrot_PMC_push_intval"
><b><code lang='und' xml:lang='und'>void Parrot_PMC_push_intval</b></code></a></dt><p class="pad"></p>

<dd>Push the passed&#45;in Parrot integer onto the passed in PMC</dd><p class="pad"></p>

<dt><a name="void_Parrot_PMC_push_numval"
><b><code lang='und' xml:lang='und'>void Parrot_PMC_push_numval</b></code></a></dt><p class="pad"></p>

<dd>Push the passed&#45;in Parrot number onto the passed in PMC</dd><p class="pad"></p>

<dt><a name="void_Parrot_PMC_delete_pmckey"
><b><code lang='und' xml:lang='und'>void Parrot_PMC_delete_pmckey</b></code></a></dt><p class="pad"></p>

<dd>Deletes the value associated with the passed&#45;in PMC from the PMC.</dd><p class="pad"></p>

<dt><a name="void_Parrot_PMC_set_cstringn_intkey"
><b><code lang='und' xml:lang='und'>void Parrot_PMC_set_cstringn_intkey</b></code></a></dt><p class="pad"></p>

<dd>Assign the passed&#45;in length&#45;noted string to the passed&#45;in PMC.</dd><p class="pad"></p>

<dt><a name="Parrot_PMC_Parrot_PMC_new"
><b><code lang='und' xml:lang='und'>Parrot_PMC Parrot_PMC_new</b></code></a></dt><p class="pad"></p>

<dd>Create and return a new PMC.</dd><p class="pad"></p>

<dt><a name="Parrot_Int_Parrot_PMC_typenum"
><b><code lang='und' xml:lang='und'>Parrot_Int Parrot_PMC_typenum</b></code></a></dt><p class="pad"></p>

<dd>Returns the internal identifier that represents the named class.</dd><p class="pad"></p>

<dt><a name="Parrot_PMC_Parrot_PMC_null"
><b><code lang='und' xml:lang='und'>Parrot_PMC Parrot_PMC_null</b></code></a></dt><p class="pad"></p>

<dd>Returns the special <code lang='und' xml:lang='und'>NULL</code> PMC.</dd><p class="pad"></p>

<dt><a name="void_Parrot_free_cstring"
><b><code lang='und' xml:lang='und'>void Parrot_free_cstring</b></code></a></dt><p class="pad"></p>

<dd>Deallocate a C string that the interpreter has handed to you.</dd><p class="pad"></p>

<dt><a name="void*_Parrot_call_sub"
><b><code lang='und' xml:lang='und'>void *Parrot_call_sub</b></code></a></dt><p class="pad"></p>

<dd>Call a parrot subroutine with the given function signature.
The first char in <code lang='und' xml:lang='und'>signature</code> denotes the return value.
Next chars are arguments.</dd><p class="pad"></p>

<dd>The return value of this function can be void or a pointer type.</dd><p class="pad"></p>

<dd>Signature chars are:</dd><p class="pad"></p>

<pre lang='und' xml:lang='und'>    v ... void return
    I ... Parrot_Int
    N ... Parrot_Float
    S ... Parrot_String
    P ... Parrot_PMC</pre>

<dt><a name="Parrot_Int_Parrot_call_sub_ret_int"
><b><code lang='und' xml:lang='und'>Parrot_Int Parrot_call_sub_ret_int</b></code></a></dt><p class="pad"></p>

<dd>Like <code lang='und' xml:lang='und'>Parrot_call_sub</code>, with Parrot_Int return result.</dd><p class="pad"></p>

<dt><a name="Parrot_Float_Parrot_call_sub_ret_float"
><b><code lang='und' xml:lang='und'>Parrot_Float Parrot_call_sub_ret_float</b></code></a></dt><p class="pad"></p>

<dd>Like <code lang='und' xml:lang='und'>Parrot_call_sub</code>, with Parrot_Float return result.</dd><p class="pad"></p>

<dt><a name="void_*_Parrot_call_method"
><b><code lang='und' xml:lang='und'>void *Parrot_call_method</b></code></a></dt><p class="pad"></p>

<dd>Call the parrot subroutine <code lang='und' xml:lang='und'>sub</code> as a method on PMC object <code lang='und' xml:lang='und'>obj</code>. The method should have the name <code lang='und' xml:lang='und'>method</code> as a Parrot_string, and should have a function signature <code lang='und' xml:lang='und'>signature</code>. Any arguments to the method can be passed at the end as a variadic argument list.</dd><p class="pad"></p>

<dt><a name="Parrot_Int_Parrot_call_method_ret_int"
><b><code lang='und' xml:lang='und'>Parrot_Int Parrot_call_method_ret_int</b></code></a></dt><p class="pad"></p>

<dd>Call the parrot subroutine <code lang='und' xml:lang='und'>sub</code> as a method on PMC object <code lang='und' xml:lang='und'>obj</code>. The method should have the name <code lang='und' xml:lang='und'>method</code> as a Parrot_string, and should have a function signature <code lang='und' xml:lang='und'>signature</code>. Any arguments to the method can be passed at the end as a variadic argument list.</dd><p class="pad"></p>

<dt><a name="Parrot_Float_Parrot_call_method_ret_float"
><b><code lang='und' xml:lang='und'>Parrot_Float Parrot_call_method_ret_float</b></code></a></dt><p class="pad"></p>

<dd>Call a parrot method for the given object.</dd><p class="pad"></p>

<dt><a name="Parrot_Int_Parrot_get_intreg"
><b><code lang='und' xml:lang='und'>Parrot_Int Parrot_get_intreg</b></code></a></dt><p class="pad"></p>

<dd>Return the value of an integer register.</dd><p class="pad"></p>

<dt><a name="Parrot_Float_Parrot_get_numreg"
><b><code lang='und' xml:lang='und'>Parrot_Float Parrot_get_numreg</b></code></a></dt><p class="pad"></p>

<dd>Return the value of a numeric register.</dd><p class="pad"></p>

<dt><a name="Parrot_String_Parrot_get_strreg"
><b><code lang='und' xml:lang='und'>Parrot_String Parrot_get_strreg</b></code></a></dt><p class="pad"></p>

<dd>Return the value of a string register.</dd><p class="pad"></p>

<dt><a name="Parrot_PMC_Parrot_get_pmcreg"
><b><code lang='und' xml:lang='und'>Parrot_PMC Parrot_get_pmcreg</b></code></a></dt><p class="pad"></p>

<dd>Return the value of a PMC register.</dd><p class="pad"></p>

<dt><a name="void_Parrot_set_intreg"
><b><code lang='und' xml:lang='und'>void Parrot_set_intreg</b></code></a></dt><p class="pad"></p>

<dd>Set the value of an I register.</dd><p class="pad"></p>

<dt><a name="void_Parrot_set_numreg"
><b><code lang='und' xml:lang='und'>void Parrot_set_numreg</b></code></a></dt><p class="pad"></p>

<dd>Set the value of an N register.</dd><p class="pad"></p>

<dt><a name="void_Parrot_set_strreg"
><b><code lang='und' xml:lang='und'>void Parrot_set_strreg</b></code></a></dt><p class="pad"></p>

<dd>Set the value of an S register.</dd><p class="pad"></p>

<dt><a name="void_Parrot_set_pmcreg"
><b><code lang='und' xml:lang='und'>void Parrot_set_pmcreg</b></code></a></dt><p class="pad"></p>

<dd>Set the value of a P register.</dd><p class="pad"></p>

<dt><a name="Parrot_String_Parrot_new_string"
><b><code lang='und' xml:lang='und'>Parrot_String Parrot_new_string</b></code></a></dt><p class="pad"></p>

<dd>Create a new Parrot string from a passed&#45;in buffer. Pass in a 0 for flags for right now.</dd><p class="pad"></p>

<dd>A copy of the buffer is made.</dd><p class="pad"></p>

<dt><a name="Parrot_Language_Parrot_find_language"
><b><code lang='und' xml:lang='und'>Parrot_Language Parrot_find_language</b></code></a></dt><p class="pad"></p>

<dd>Find the magic language token for a language, by language name.</dd><p class="pad"></p>

<dt><a name="void_Parrot_register_pmc"
><b><code lang='und' xml:lang='und'>void Parrot_register_pmc</b></code></a></dt><p class="pad"></p>

<dd>Add a reference of the PMC to the interpreters DOD registry. This prevents PMCs only known to extension from getting destroyed during DOD runs.</dd><p class="pad"></p>

<dt><a name="void_Parrot_unregister_pmc"
><b><code lang='und' xml:lang='und'>void Parrot_unregister_pmc</b></code></a></dt><p class="pad"></p>

<dd>Remove a reference of the PMC from the interpreters DOD registry. If the reference count reaches zero, the PMC will be destroyed during the next DOD run.</dd><p class="pad"></p>

<dt><a name="void_Parrot_PMC_set_vtable"
><b><code lang='und' xml:lang='und'>void Parrot_PMC_set_vtable</b></code></a></dt><p class="pad"></p>

<dd>Replaces the vtable of the PMC.</dd><p class="pad"></p>

<dt><a name="Parrot_VTABLE_Parrot_get_vtable"
><b><code lang='und' xml:lang='und'>Parrot_VTABLE Parrot_get_vtable</b></code></a></dt><p class="pad"></p>

<dd>Returns the vtable corresponding to the given PMC ID.</dd><p class="pad"></p>
</dl>

<h1><a name="SEE_ALSO"
>SEE ALSO <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h1>

<p>See <em lang='und' xml:lang='und'>include/parrot/extend.h</em> and <em lang='und' xml:lang='und'>docs/pdds/pdd11_extending.pod</em>.</p>

<h1><a name="HISTORY"
>HISTORY <a href='#_top'><img alt='^' border=0 src='../../resources/up.gif'></a></a></h1>

<p>Initial version by Dan Sugalski.</p>
        </DIV>
        <P>
        <TABLE BORDER="0" WIDTH="730" CELLSPACING="0" CELLPADDING="0">
            <TR ALIGN="RIGHT">
                <TD WIDTH="590" VALIGN="MIDDLE">
                    <BR>
                    <DIV CLASS="FOOTER">
                        <DIV ALIGN="LEFT">
                        </DIV>
                    </DIV>
                </TD>
                <TD VALIGN="middle" ALIGN="center">
                    <IMG BORDER=0
                        SRC="../../resources/parrot_small.png"
                        ALT="parrot">
                </TD>
            </TR>
        </TABLE>
    </BODY>
</HTML>
