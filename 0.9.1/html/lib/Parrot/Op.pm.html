<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Parrot Operation</title>
        <link rel="stylesheet" type="text/css"
            href="../../../resources/parrot.css"
            media="all">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    </head>
    <body>
        <div id="wrapper">
            <div id="header">

                <img border=0 src="../../../resources/parrot_logo.png" id="logo" alt="parrot">
            </div> <!-- "header" -->
            <div id="divider"></div>
            <div id="mainbody">
                <div id="breadcrumb">
                    <a href="../../../html/index.html">Contents</a> &raquo; <a href="../../../html/perl.html">Perl Modules</a> &raquo; Parrot Operation
                </div>

<h1><a name="NAME"
>NAME</a></h1>

<p>Parrot::Op &#45; Parrot Operation</p>

<h1><a name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>  use Parrot::Op;</pre>

<h1><a name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p><code>Parrot::Op</code> represents a Parrot operation (op, for short), as read from an ops file via <code><a href='OpsFile.pm.html'>Parrot::OpsFile</a></code>, or perhaps even generated by some other means. It is the Perl equivalent of the <code>op_info_t</code> C <code>struct</code> defined in <em>include/parrot/op.h</em>.</p>

<h2><a name="Op_Type"
>Op Type</a></h2>

<p>Ops are either <i>auto</i> or <i>manual</i>. Manual ops are responsible for having explicit next&#45;op <code>RETURN()</code> statements, while auto ops can count on an automatically generated next&#45;op to be appended to the op body.</p>

<p>Note that <em><a href="../../tools/build/ops2c.pl.html">tools/build/ops2c.pl</a></em> supplies either &#39;inline&#39; or &#39;function&#39; as the op&#39;s type, depending on whether the <code>inline</code> keyword is present in the op definition. This has the effect of causing all ops to be considered manual.</p>

<h2><a name="Op_Arguments"
>Op Arguments</a></h2>

<p>Note that argument 0 is considered to be the op itself, with arguments 1..9 being the arguments passed to the op.</p>

<p>Op argument direction and type are represented by short one or two letter descriptors.</p>

<p>Op Direction:</p>

<pre>    i   The argument is incoming
    o   The argument is outgoing
    io  The argument is both incoming and outgoing</pre>

<p>Op Type:</p>

<pre>    i   The argument is an integer register index.
    n   The argument is a number register index.
    p   The argument is a PMC register index.
    s   The argument is a string register index.
    ic  The argument is an integer constant (in&#45;line).
    nc  The argument is a number constant index.
    pc  The argument is a PMC constant index.
    sc  The argument is a string constant index.
    kc  The argument is a key constant index.
    ki  The argument is a key integer register index.
    kic  The argument is a key integer constant (in&#45;line).</pre>

<h2><a name="Class_Methods"
>Class Methods</a></h2>

<dl>
<dt><a name="new($code,_$type,_$name,_$args,_$argdirs,_$labels,_$flags)"
><b><code>new($code, $type, $name, $args, $argdirs, $labels, $flags)</b></code></a></dt>
Allocates a new bodyless op. A body must be provided eventually for the op to be usable.<code>$code</code> is the integer identifier for the op.<code>$type</code> is the type of op (see the note on op types above).<code>$name</code> is the name of the op.<code>$args</code> is a reference to an array of argument type descriptors.<code>$argdirs</code> is a reference to an array of argument direction descriptors. Element <i>x</i> is the direction of argument <code>$args&#45;&#62;[<i>x</i>]</code>.<code>$labels</code> is a reference to an array of boolean values indicating whether each argument direction was prefixed by &#39;<code>label</code>&#39;.<code>$flags</code> is a hash reference containing zero or more <i>hints</i> or <i>directives</i>.</dl>

<h2><a name="Instance_Methods"
>Instance Methods</a></h2>

<dl>
<dt><a name="code()"
><b><code>code()</b></code></a></dt>
Returns the op code.
<dt><a name="type()"
><b><code>type()</b></code></a></dt>
The type of the op, either &#39;inline&#39; or &#39;function&#39;.
<dt><a name="name()"
><b><code>name()</b></code></a></dt>
The (short or root) name of the op.
<dt><a name="full_name()"
><b><code>full_name()</b></code></a></dt>
For argumentless ops, it&#39;s the same as <code>name()</code>. For ops with arguments, an underscore followed by underscore&#45;separated argument types are appended to the name.
<dt><a name="func_name()"
><b><code>func_name()</b></code></a></dt>
The same as <code>full_name()</code>, but with &#39;<code>Parrot_</code>&#39; prefixed.
<dt><a name="arg_types()"
><b><code>arg_types()</b></code></a></dt>
Returns the types of the op&#39;s arguments.
<dt><a name="arg_type($index)"
><b><code>arg_type($index)</b></code></a></dt>
Returns the type of the op&#39;s argument at <code>$index</code>.
<dt><a name="arg_dirs()"
><b><code>arg_dirs()</b></code></a></dt>
Returns the directions of the op&#39;s arguments.
<dt><a name="labels()"
><b><code>labels()</b></code></a></dt>
Returns the labels.
<dt><a name="flags(@flags)"
><b><code>flags(@flags)</b></code></a></dt>

<dt><a name="flags()"
><b><code>flags()</b></code></a></dt>
Sets/gets the op&#39;s flags. This returns a hash reference, whose keys are any flags (passed as &#34;:flag&#34;) specified for the op.
<dt><a name="arg_dir($index)"
><b><code>arg_dir($index)</b></code></a></dt>
Returns the direction of the op&#39;s argument at <code>$index</code>.
<dt><a name="body($body)"
><b><code>body($body)</b></code></a></dt>

<dt><a name="body()"
><b><code>body()</b></code></a></dt>
Sets/gets the op&#39;s code body.
<dt><a name="jump($jump)"
><b><code>jump($jump)</b></code></a></dt>

<dt><a name="jump()"
><b><code>jump()</b></code></a></dt>
Sets/gets a string containing one or more <code>op_jump_t</code> values joined with <code>|</code> (see <em>include/parrot/op.h</em>). This indicates if and how an op may jump.
<dt><a name="full_body()"
><b><code>full_body()</b></code></a></dt>
For manual ops, <code>full_body()</code> is the same as <code>body()</code>. For auto ops this method adds a final <code>goto NEXT()</code> line to the code to represent the auto&#45;computed return value. See the note on op types above.
<dt><a name="rewrite_body($body,_$trans)"
><b><code>rewrite_body($body, $trans)</b></code></a></dt>
Performs the various macro substitutions using the specified transform, correctly handling nested substitions, and repeating over the whole string until no more substitutions can be made.<code>VTABLE_</code> macros are enforced by converting <code><i>x</i>&#45;&#62;vtable&#45;&#62;<i>method</i></code> to <code>VTABLE_<i>method</i></code>.
<dt><a name="source($trans)"
><b><code>source($trans)</b></code></a></dt>
Returns the <a href='TODO'><code>full_body()</code></a> of the op with substitutions made by <code>$trans</code> (a subclass of <code><a href='OpTrans.pm.html'>Parrot::OpTrans</a></code>).
<dt><a name="size()"
><b><code>size()</b></code></a></dt>
Returns the op&#39;s number of arguments. Note that this also includes the op itself as one argument.</dl>

<h1><a name="SEE_ALSO"
>SEE ALSO</a></h1>

<dl>
<dt><a name="Parrot::OpsFile"
><b><code><a href='OpsFile.pm.html'>Parrot::OpsFile</a></b></code></a></dt>

<dt><a name="Parrot::OpTrans"
><b><code><a href='OpTrans.pm.html'>Parrot::OpTrans</a></b></code></a></dt>

<dt><a name="tools/build/ops2c.pl"
><em><a href="../../tools/build/ops2c.pl.html">tools/build/ops2c.pl</a></em></a></dt>

<dt><a name="tools/build/ops2pm.pl"
><em><a href="../../tools/build/ops2pm.pl.html">tools/build/ops2pm.pl</a></em></a></dt>

<dt><a name="tools/build/pbc2c.pl"
><em>tools/build/pbc2c.pl</em></a></dt>
</dl>

<h1><a name="HISTORY"
>HISTORY</a></h1>

<p>Author: Gregor N. Purdy &#60;gregor@focusresearch.com&#62;</p>
            </div> <!-- "mainbody" -->
            <div id="divider"></div>
            <div id="footer">
	        Copyright &copy; 2002-2009, Parrot Foundation.
            </div>
        </div> <!-- "wrapper" -->
    </body>
</html>
