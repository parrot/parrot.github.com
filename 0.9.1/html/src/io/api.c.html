<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Parrot I/O API</title>
        <link rel="stylesheet" type="text/css"
            href="../../../resources/parrot.css"
            media="all">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    </head>
    <body>
        <div id="wrapper">
            <div id="header">

                <img border=0 src="../../../resources/parrot_logo.png" id="logo" alt="parrot">
            </div> <!-- "header" -->
            <div id="divider"></div>
            <div id="mainbody">
                <div id="breadcrumb">
                    <a href="../../../html/index.html">Contents</a> &raquo; <a href="../../../html/c.html">C</a> &raquo; Parrot I/O API
                </div>

<h1><a name="NAME"
>NAME</a></h1>

<p>src/io/api.c &#45; Parrot I/O API</p>

<h1><a name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>The Parrot I/O subsystem provides the core I/O functionality for all parts of Parrot.
This file implements the public interface to the I/O subsystem.
Common utility functions that aren&#39;t part of the public interface are defined in <em>src/io/common.c</em> and utility functions for a specific platform are in <em><a href="unix.c.html">src/io/unix.c</a></em>,
<em><a href="win32.c.html">src/io/win32.c</a></em>,
or <em><a href="portable.c.html">src/io/portable.c</a></em>.
The platform is selected in <em>include/parrot/io.h</em>,
based on #defines from the configuration process.</p>

<p>The <code>FileHandle</code> PMC provides the class&#45;based interface for filehandles that is used in Parrot ops.</p>

<h2><a name="Generic_I/O_interface"
>Generic I/O interface</a></h2>

<dl>
<dt><a name="PMC_*_Parrot_io_stdhandle"
><b><code>PMC *Parrot_io_stdhandle</b></code></a></dt>
Get the current standard IO object and optionally set a new one.
<dt><a name="PMC_*_Parrot_io_new_pmc"
><b><code>PMC *Parrot_io_new_pmc</b></code></a></dt>
Creates a new I/O filehandle object.
The value of <code>flags</code> is set in the returned PMC.
<dt><a name="PMC_*_Parrot_io_open"
><b><code>PMC *Parrot_io_open</b></code></a></dt>
Return an open filehandle for a given string path and flags.
Defaults to creating a new FileHandle PMC.
If a PMC object is passed in,
it uses that object instead of creating a new FileHandle.
<dt><a name="PMC_*_Parrot_io_fdopen"
><b><code>PMC *Parrot_io_fdopen</b></code></a></dt>
Creates and returns a <code>FileHandle</code> PMC for a given set of flags on an existing,
open file descriptor.This is used particularly to initialize the <code>STD*</code> IO handles onto the OS IO handles (0,
1,
2).
<dt><a name="INTVAL_Parrot_io_close"
><b><code>INTVAL Parrot_io_close</b></code></a></dt>
Closes the filehandle object.
<dt><a name="INTVAL_Parrot_io_is_closed"
><b><code>INTVAL Parrot_io_is_closed</b></code></a></dt>
Test whether a filehandle is closed.
<dt><a name="void_Parrot_io_flush"
><b><code>void Parrot_io_flush</b></code></a></dt>
Flushes the <code>ParrotIO</code> PMC <code>*pmc</code>.
<dt><a name="STRING_*_Parrot_io_reads"
><b><code>STRING *Parrot_io_reads</b></code></a></dt>
Return a new <code>STRING*</code> holding up to <code>len</code> bytes.
<dt><a name="STRING_*_Parrot_io_readline"
><b><code>STRING *Parrot_io_readline</b></code></a></dt>
Return a new <code>STRING*</code> holding the next line read from the file.
<dt><a name="INTVAL_Parrot_io_write"
><b><code>INTVAL Parrot_io_write</b></code></a></dt>
Writes <code>len</code> bytes from <code>*buffer</code> to <code>*pmc</code>.
<dt><a name="PIOOFF_T_Parrot_io_seek"
><b><code>PIOOFF_T Parrot_io_seek</b></code></a></dt>
Moves the read/write position of <code>*pmc</code> to offset <code>bytes</code> from the position indicated by <code>w</code>.
Typically <code>w</code> will be <code>0</code> for the start of the file,
<code>1</code> for the current position,
and <code>2</code> for the end.
<dt><a name="PIOOFF_T_Parrot_io_tell"
><b><code>PIOOFF_T Parrot_io_tell</b></code></a></dt>
Returns the current read/write position of <code>*pmc</code>.
<dt><a name="INTVAL_Parrot_io_peek"
><b><code>INTVAL Parrot_io_peek</b></code></a></dt>
Retrieve the next character in the stream without modifying the stream.
Calls the platform&#45;specific implementation of &#39;peek&#39;.
<dt><a name="INTVAL_Parrot_io_eof"
><b><code>INTVAL Parrot_io_eof</b></code></a></dt>
Returns a boolean value indication whether <code>*pmc</code>&#39;s current read/write position is <code>EOF</code>.
<dt><a name="INTVAL_Parrot_io_puts"
><b><code>INTVAL Parrot_io_puts</b></code></a></dt>
Writes <code>*s</code> tp <code>*pmc</code>.
C string version.
<dt><a name="INTVAL_Parrot_io_putps"
><b><code>INTVAL Parrot_io_putps</b></code></a></dt>
Writes <code>*s</code> to <code>*pmc</code>.
Parrot string version.
<dt><a name="INTVAL_Parrot_io_fprintf"
><b><code>INTVAL Parrot_io_fprintf</b></code></a></dt>
Writes a C string format with varargs to <code>*pmc</code>.
<dt><a name="INTVAL_Parrot_io_printf"
><b><code>INTVAL Parrot_io_printf</b></code></a></dt>
Writes a C string format with varargs to <code>stdout</code>.
<dt><a name="INTVAL_Parrot_io_eprintf"
><b><code>INTVAL Parrot_io_eprintf</b></code></a></dt>
Writes a C string format with varargs to <code>stderr</code>.
<dt><a name="PIOHANDLE_Parrot_io_getfd"
><b><code>PIOHANDLE Parrot_io_getfd</b></code></a></dt>
Returns <code>*pmc</code>&#39;s file descriptor,
or <code>0</code> if it is not defined.
<dt><a name="INTVAL_Parrot_io_is_tty"
><b><code>INTVAL Parrot_io_is_tty</b></code></a></dt>
Returns a boolean value indicating whether <code>*pmc</code> is a console/tty.</dl>

<h2><a name="Parrot_io_STD*_Functions"
><code>Parrot_io_STD*</code> Functions</a></h2>

<dl>
<dt><a name="PMC_*_Parrot_io_STDIN"
><b><code>PMC *Parrot_io_STDIN</b></code></a></dt>
Returns the <code>FileHandle</code> PMC for <code>stdin</code>.
<dt><a name="PMC_*_Parrot_io_STDOUT"
><b><code>PMC *Parrot_io_STDOUT</b></code></a></dt>
Returns the <code>FileHandle</code> PMC for <code>stdout</code>.
<dt><a name="PMC_*_Parrot_io_STDERR"
><b><code>PMC *Parrot_io_STDERR</b></code></a></dt>
Returns the <code>FileHandle</code> PMC for <code>stderr</code>.</dl>

<h2><a name="Offset_Functions"
>Offset Functions</a></h2>

<p>These are used to create offsets for the <code>seek</code> op.</p>

<dl>
<dt><a name="PIOOFF_T_Parrot_io_make_offset"
><b><code>PIOOFF_T Parrot_io_make_offset</b></code></a></dt>
Returns <code>offset</code>.
<dt><a name="PIOOFF_T_Parrot_io_make_offset32"
><b><code>PIOOFF_T Parrot_io_make_offset32</b></code></a></dt>
<code>hi</code> is shifted 32 bytes to the left and <code>or</code>ed together with <code>lo</code>.
This allows 64&#45;bit seeks with only 32&#45;bit <code>INTVALS</code>.
<dt><a name="PIOOFF_T_Parrot_io_make_offset_pmc"
><b><code>PIOOFF_T Parrot_io_make_offset_pmc</b></code></a></dt>
Returns the return value of the <code>get_integer</code> vtable method on <code>*pmc</code>.</dl>

<h1><a name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><em>io/unix.c</em>,
<em>io/win32.c</em>,
<em>io/portable.c</em>,
<em>io/io_private.h</em>.</p>
            </div> <!-- "mainbody" -->
            <div id="divider"></div>
            <div id="footer">
	        Copyright &copy; 2002-2009, Parrot Foundation.
            </div>
        </div> <!-- "wrapper" -->
    </body>
</html>
