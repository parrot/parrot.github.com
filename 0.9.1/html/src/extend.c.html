<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Parrot extension interface</title>
        <link rel="stylesheet" type="text/css"
            href="../../resources/parrot.css"
            media="all">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    </head>
    <body>
        <div id="wrapper">
            <div id="header">

                <img border=0 src="../../resources/parrot_logo.png" id="logo" alt="parrot">
            </div> <!-- "header" -->
            <div id="divider"></div>
            <div id="mainbody">
                <div id="breadcrumb">
                    <a href="../../html/index.html">Contents</a> &raquo; <a href="../../html/c.html">C</a> &raquo; Parrot extension interface
                </div>

<h1><a name="NAME"
>NAME</a></h1>

<p>src/extend.c &#45; Parrot extension interface</p>

<h1><a name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>These are the functions that parrot extensions (i.e.
parrot subroutines written in C,
or some other compiled language,
rather than in parrot bytecode) may access.</p>

<p>There is a deliberate distancing from the internals here.
Don&#39;t go peeking inside &#45;&#45; you&#39;ve as much access as bytecode does,
but no more,
so we can provide backwards compatibility for as long as we possibly can.</p>

<h2><a name="Functions"
>Functions</a></h2>

<dl>
<dt><a name="int_Parrot_vfprintf"
><b><code>int Parrot_vfprintf</b></code></a></dt>
Writes a C string format with a varargs list to a PIO.
<dt><a name="int_Parrot_fprintf"
><b><code>int Parrot_fprintf</b></code></a></dt>
Writes a C string format with varargs to a PIO.
<dt><a name="int_Parrot_printf"
><b><code>int Parrot_printf</b></code></a></dt>
Writes a C string format with varargs to <code>stdout</code>.
<dt><a name="int_Parrot_eprintf"
><b><code>int Parrot_eprintf</b></code></a></dt>
Writes a C string format with varargs to <code>stderr</code>.
<dt><a name="Parrot_String_Parrot_PMC_get_string_intkey"
><b><code>Parrot_String Parrot_PMC_get_string_intkey</b></code></a></dt>
Return the integer keyed string value of the passed&#45;in PMC
<dt><a name="void_*_Parrot_PMC_get_pointer_intkey"
><b><code>void *Parrot_PMC_get_pointer_intkey</b></code></a></dt>
Return a pointer to the PMC indicated by an integer key.
<dt><a name="Parrot_PMC_Parrot_PMC_get_pmc_intkey"
><b><code>Parrot_PMC Parrot_PMC_get_pmc_intkey</b></code></a></dt>
Return the integer keyed PMC value of the passed&#45;in PMC
<dt><a name="Parrot_Int_Parrot_PMC_get_intval"
><b><code>Parrot_Int Parrot_PMC_get_intval</b></code></a></dt>
Return the signed integer value of the value in the PMC.
<dt><a name="Parrot_Int_Parrot_PMC_get_intval_intkey"
><b><code>Parrot_Int Parrot_PMC_get_intval_intkey</b></code></a></dt>
Return the keyed,
signed integer value of the value in the PMC.
<dt><a name="Parrot_Int_Parrot_PMC_get_intval_pmckey"
><b><code>Parrot_Int Parrot_PMC_get_intval_pmckey</b></code></a></dt>
Return the keyed,
signed integer value of the value in the PMC.
<dt><a name="Parrot_Float_Parrot_PMC_get_numval"
><b><code>Parrot_Float Parrot_PMC_get_numval</b></code></a></dt>
Return the floating&#45;point value of the PMC.
<dt><a name="Parrot_Float_Parrot_PMC_get_numval_intkey"
><b><code>Parrot_Float Parrot_PMC_get_numval_intkey</b></code></a></dt>
Return the keyed,
signed integer value of the value in the PMC.
<dt><a name="char_*_Parrot_PMC_get_cstring_intkey"
><b><code>char *Parrot_PMC_get_cstring_intkey</b></code></a></dt>
Return a null&#45;terminated string that represents the string value of the PMC.Note that you must free this string with <code>Parrot_str_free_cstring()</code>!
<dt><a name="char_*_Parrot_PMC_get_cstring"
><b><code>char *Parrot_PMC_get_cstring</b></code></a></dt>
Return a null&#45;terminated string that represents the string value of the PMC.Note that you must free this string with <code>Parrot_str_free_cstring()</code>!
<dt><a name="char_*_Parrot_PMC_get_cstringn"
><b><code>char *Parrot_PMC_get_cstringn</b></code></a></dt>
Return a null&#45;terminated string for the PMC,
along with the length.Yes,
right now this is a bit of a cheat.
It needs fixing,
but without disturbing the interface.Note that you must free the string with <code>Parrot_str_free_cstring()</code>.
<dt><a name="char_*_Parrot_PMC_get_cstringn_intkey"
><b><code>char *Parrot_PMC_get_cstringn_intkey</b></code></a></dt>
Return a null&#45;terminated string for the PMC,
along with the length.Yes,
right now this is a bit of a cheat.
It needs fixing,
but without disturbing the interface.Note that you must free this string with <code>Parrot_str_free_cstring()</code>.
<dt><a name="void_Parrot_PMC_set_string"
><b><code>void Parrot_PMC_set_string</b></code></a></dt>
Assign the passed&#45;in Parrot string to the passed&#45;in PMC.
<dt><a name="void_Parrot_PMC_set_string_intkey"
><b><code>void Parrot_PMC_set_string_intkey</b></code></a></dt>
Assign the passed&#45;in Parrot string to the passed&#45;in PMC.
<dt><a name="void_Parrot_PMC_set_pmc_intkey"
><b><code>void Parrot_PMC_set_pmc_intkey</b></code></a></dt>
Assign the passed&#45;in pmc to the passed&#45;in slot of the passed&#45;in PMC.
<dt><a name="void_Parrot_PMC_set_pmc_pmckey"
><b><code>void Parrot_PMC_set_pmc_pmckey</b></code></a></dt>
Assign the passed&#45;in pmc to the passed&#45;in slot of the passed&#45;in PMC.
<dt><a name="void_Parrot_PMC_set_pointer_intkey"
><b><code>void Parrot_PMC_set_pointer_intkey</b></code></a></dt>
Assign the passed&#45;in pointer to the passed&#45;in PMC.
<dt><a name="void_Parrot_PMC_set_intval"
><b><code>void Parrot_PMC_set_intval</b></code></a></dt>
Assign the passed&#45;in Parrot integer to the passed&#45;in PMC.
<dt><a name="void_Parrot_PMC_set_intval_intkey"
><b><code>void Parrot_PMC_set_intval_intkey</b></code></a></dt>
Assign the passed&#45;in Parrot integer to the passed&#45;in PMC.
<dt><a name="void_Parrot_PMC_set_numval"
><b><code>void Parrot_PMC_set_numval</b></code></a></dt>
Assign the passed&#45;in Parrot number to the passed&#45;in PMC.
<dt><a name="void_Parrot_PMC_set_numval_intkey"
><b><code>void Parrot_PMC_set_numval_intkey</b></code></a></dt>
Assign the passed&#45;in Parrot number to the passed&#45;in PMC.
<dt><a name="void_Parrot_PMC_set_cstring"
><b><code>void Parrot_PMC_set_cstring</b></code></a></dt>
Assign the passed&#45;in null&#45;terminated C string to the passed&#45;in PMC.
<dt><a name="void_Parrot_PMC_set_cstring_intkey"
><b><code>void Parrot_PMC_set_cstring_intkey</b></code></a></dt>
Assign the passed&#45;in null&#45;terminated C string to the passed&#45;in PMC.
<dt><a name="void_Parrot_PMC_set_cstringn"
><b><code>void Parrot_PMC_set_cstringn</b></code></a></dt>
Assign the passed&#45;in length&#45;noted string to the passed&#45;in PMC.
<dt><a name="void_Parrot_PMC_push_intval"
><b><code>void Parrot_PMC_push_intval</b></code></a></dt>
Push the passed&#45;in Parrot integer onto the passed in PMC
<dt><a name="void_Parrot_PMC_push_numval"
><b><code>void Parrot_PMC_push_numval</b></code></a></dt>
Push the passed&#45;in Parrot number onto the passed in PMC
<dt><a name="void_Parrot_PMC_delete_pmckey"
><b><code>void Parrot_PMC_delete_pmckey</b></code></a></dt>
Deletes the value associated with the passed&#45;in PMC from the PMC.
<dt><a name="void_Parrot_PMC_set_cstringn_intkey"
><b><code>void Parrot_PMC_set_cstringn_intkey</b></code></a></dt>
Assign the passed&#45;in length&#45;noted string to the passed&#45;in PMC.
<dt><a name="Parrot_PMC_Parrot_PMC_new"
><b><code>Parrot_PMC Parrot_PMC_new</b></code></a></dt>
Create and return a new PMC.
<dt><a name="Parrot_Int_Parrot_PMC_typenum"
><b><code>Parrot_Int Parrot_PMC_typenum</b></code></a></dt>
Returns the internal identifier that represents the named class.
<dt><a name="Parrot_PMC_Parrot_PMC_null"
><b><code>Parrot_PMC Parrot_PMC_null</b></code></a></dt>
Returns the special <code>NULL</code> PMC.
<dt><a name="void_Parrot_free_cstring"
><b><code>void Parrot_free_cstring</b></code></a></dt>
Deallocate a C string that the interpreter has handed to you.
<dt><a name="void*_Parrot_call_sub"
><b><code>void *Parrot_call_sub</b></code></a></dt>
Call a parrot subroutine with the given function signature.
The first char in <code>signature</code> denotes the return value.
Next chars are arguments.The return value of this function can be void or a pointer type.Signature chars are:
<pre>    v ... void return
    I ... Parrot_Int
    N ... Parrot_Float
    S ... Parrot_String
    P ... Parrot_PMC</pre>

<dt><a name="Parrot_Int_Parrot_call_sub_ret_int"
><b><code>Parrot_Int Parrot_call_sub_ret_int</b></code></a></dt>
Like <code>Parrot_call_sub</code>, with Parrot_Int return result.
<dt><a name="Parrot_Float_Parrot_call_sub_ret_float"
><b><code>Parrot_Float Parrot_call_sub_ret_float</b></code></a></dt>
Like <code>Parrot_call_sub</code>, with Parrot_Float return result.
<dt><a name="void_*_Parrot_call_method"
><b><code>void *Parrot_call_method</b></code></a></dt>
Call the parrot subroutine <code>sub</code> as a method on PMC object <code>obj</code>. The method should have the name <code>method</code> as a Parrot_string, and should have a function signature <code>signature</code>. Any arguments to the method can be passed at the end as a variadic argument list.
<dt><a name="Parrot_Int_Parrot_call_method_ret_int"
><b><code>Parrot_Int Parrot_call_method_ret_int</b></code></a></dt>
Call the parrot subroutine <code>sub</code> as a method on PMC object <code>obj</code>. The method should have the name <code>method</code> as a Parrot_string, and should have a function signature <code>signature</code>. Any arguments to the method can be passed at the end as a variadic argument list.
<dt><a name="Parrot_Float_Parrot_call_method_ret_float"
><b><code>Parrot_Float Parrot_call_method_ret_float</b></code></a></dt>
Call a parrot method for the given object.
<dt><a name="Parrot_Int_Parrot_get_intreg"
><b><code>Parrot_Int Parrot_get_intreg</b></code></a></dt>
Return the value of an integer register.
<dt><a name="Parrot_Float_Parrot_get_numreg"
><b><code>Parrot_Float Parrot_get_numreg</b></code></a></dt>
Return the value of a numeric register.
<dt><a name="Parrot_String_Parrot_get_strreg"
><b><code>Parrot_String Parrot_get_strreg</b></code></a></dt>
Return the value of a string register.
<dt><a name="Parrot_PMC_Parrot_get_pmcreg"
><b><code>Parrot_PMC Parrot_get_pmcreg</b></code></a></dt>
Return the value of a PMC register.
<dt><a name="void_Parrot_set_intreg"
><b><code>void Parrot_set_intreg</b></code></a></dt>
Set the value of an I register.
<dt><a name="void_Parrot_set_numreg"
><b><code>void Parrot_set_numreg</b></code></a></dt>
Set the value of an N register.
<dt><a name="void_Parrot_set_strreg"
><b><code>void Parrot_set_strreg</b></code></a></dt>
Set the value of an S register.
<dt><a name="void_Parrot_set_pmcreg"
><b><code>void Parrot_set_pmcreg</b></code></a></dt>
Set the value of a P register.
<dt><a name="Parrot_String_Parrot_new_string"
><b><code>Parrot_String Parrot_new_string</b></code></a></dt>
Create a new Parrot string from a passed&#45;in buffer. Pass in a 0 for flags for right now.A copy of the buffer is made.
<dt><a name="Parrot_Language_Parrot_find_language"
><b><code>Parrot_Language Parrot_find_language</b></code></a></dt>
Find the magic language token for a language, by language name.
<dt><a name="void_Parrot_register_pmc"
><b><code>void Parrot_register_pmc</b></code></a></dt>
Add a reference of the PMC to the interpreter&#39;s GC registry. This prevents PMCs only known to extension from getting destroyed during GC runs.
<dt><a name="void_Parrot_unregister_pmc"
><b><code>void Parrot_unregister_pmc</b></code></a></dt>
Remove a reference of the PMC from the interpreter&#39;s GC registry. If the reference count reaches zero, the PMC will be destroyed during the next GC run.
<dt><a name="void_Parrot_PMC_set_vtable"
><b><code>void Parrot_PMC_set_vtable</b></code></a></dt>
Replaces the vtable of the PMC.
<dt><a name="Parrot_VTABLE_Parrot_get_vtable"
><b><code>Parrot_VTABLE Parrot_get_vtable</b></code></a></dt>
Returns the vtable corresponding to the given PMC ID.</dl>

<h1><a name="SEE_ALSO"
>SEE ALSO</a></h1>

<p>See <em>include/parrot/extend.h</em> and <em>docs/pdds/pdd11_extending.pod</em>.</p>

<h1><a name="HISTORY"
>HISTORY</a></h1>

<p>Initial version by Dan Sugalski.</p>
            </div> <!-- "mainbody" -->
            <div id="divider"></div>
            <div id="footer">
	        Copyright &copy; 2002-2009, Parrot Foundation.
            </div>
        </div> <!-- "wrapper" -->
    </body>
</html>
