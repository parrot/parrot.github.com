<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Untitled</title>
        <link rel="stylesheet" type="text/css"
            href="../../../resources/parrot.css"
            media="all">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    </head>
    <body>
        <div id="wrapper">
            <div id="header">

                <img border=0 src="../../../resources/parrot_logo.png" id="logo" alt="parrot">
            </div> <!-- "header" -->
            <div id="divider"></div>
            <div id="mainbody">
                <div id="breadcrumb">
                    <a href="../../../html/index.html">Contents</a> &raquo; <a href="../../../html/languages.html">Language Implementations</a> &raquo; <a href="../../../html/pynie.html">Pynie</a> &raquo; Untitled
                </div>

<h1><a name="Pynie_&#45;_A_Python_compiler_for_Parrot"
>Pynie &#45; A Python compiler for Parrot</a></h1>

<p>This is a Pynie parser/compiler,
an early version (no version numbers yet).
It&#39;s still very early,
only simple expressions and functions are available.</p>

<p>However,
even though this is not a complete compiler yet,
you can still see how programs are parsed,
help us create test cases,
and extend/improve the grammar and runtime to cover more of Python.
Here&#39;s how the system currently works:</p>

<h2><a name="Compiling"
>Compiling</a></h2>

<p>Pynie lives in pynie.pbc.
To create this file,
simply issue the command</p>

<pre>  $ make</pre>

<p>To invoke pynie on a Python program from a shell prompt, use:</p>

<pre>  $ parrot pynie.pbc foo.py</pre>

<p>To run interactively, entering single&#45;line statements:</p>

<pre>  $ parrot pynie.pbc</pre>

<p>Note that pynie&#39;s interactive mode is not yet up to spec with Python&#39;s interactive mode (it doesn&#39;t handle blocks yet).</p>

<p>To display the parse tree, add the &#34;&#45;&#45;target=parse&#34; option:</p>

<pre>  $ parrot pynie.pbc &#45;&#45;target=parse foo.py</pre>

<p>Or, to display the abstract syntax tree, the opcode syntax tree, or the generated PIR code, use &#34;&#45;&#45;target=PAST&#34;, &#34;&#45;&#45;target=POST&#34;, or &#34;&#45;&#45;target=PIR&#34;.</p>

<pre>  $ parrot pynie.pbc</pre>

<h2><a name="Files"
>Files</a></h2>

<p>The &#34;top&#34; file for the parser is <em>pynie.pir</em> which is used to create the <em>pynie.pbc</em> file. It initializes the overall parsing system and registers the parser as a Parrot &#34;Pynie&#34; compiler.</p>

<p>The other files needed for the compiler are in the <em>src/</em> subdirectory.</p>

<p>The <em>src/parser/Grammar.pg</em> file defines the tokens, rules, and protos for Python. Much of this has been taken from the &#34;Python Language Reference Manual (release 2.3)&#34; by Guido van Rossum (Fred L. Drake, Jr., editor). PGE&#39;s &#34;Perl6Grammar.pbc&#34; compiler is then used to compile the two grammar files into <em>src/parser/Grammar_gen.pir</em>, which is included by <em>pynie.pir</em>. (See Synopsis 5 for more details on Perl 6 rules syntax, and <em>compilers/pge/</em> for more details about PGE.)</p>

<p>The <em>src/parse.pir</em> file defines a few special&#45;purpose rules needed to support parsing that are better written directly in PIR instead of using the rules or token syntax. Currently this file defines the <code>&#60;expression&#62;</code> rule, which just calls into the operator precedence parser.</p>

<p>The file <em>src/parser/Actions.pm</em> defines the actions that are invoked during the parse. These actions construct the Parrot AST (PAST) nodes. At the end of the parse, the whole PAST is constructed and handed off to the next compilation phases (PAST&#45;&#62;POST&#45;&#62;PIR)</p>

<p>The file <em>src/PAST/Grammar.tg</em> is a tree grammar that specifies how to convert the parse tree into the abstract syntax tree (PAST). This file is no longer used in the current implementation.</p>

<p>The PIR files in <em>src/builtins</em> are included as part of compiling <em>pynie.pir</em> to produce <em>pynie.pbc</em>.</p>

<p>The <em>pynie.pbc</em> file can also be used to compile Python code from PIR:</p>

<pre>    load_bytecode &#39;pynie.pbc&#39;
    $S0 = &#39;print &#34;hello world&#34;&#39;          # source code to compile
    $P0 = compreg(&#39;Pynie&#39;)               # obtain the compiler
    $P1 = $P0($S0)                       # compile source code
    $P1()                                # execute</pre>

<p>One can also provide the &#34;target&#34; option to the compiler:</p>

<pre>    $P1 = $P0($S0, &#39;target&#39;=&#62;&#39;parse&#39;)    # obtain parse tree
    $P1 = $P0($S0, &#39;target&#39;=&#62;&#39;PAST&#39;)     # get AST
    $P1 = $P0($S0, &#39;target&#39;=&#62;&#39;POST&#39;)     # get OST
    $P1 = $P0($S0, &#39;target&#39;=&#62;&#39;PIR&#39;)      # get PIR</pre>

<h1><a name="Submitting_Bugs/Patches"
>Submitting Bugs/Patches</a></h1>

<p>Patches/bugs/suggestions can be sent to &#60;<a href="http://launchpad.net/pynie">http://launchpad.net/pynie</a>&#62;.</p>

<h1><a name="AUTHOR"
>AUTHOR</a></h1>

<p>Patrick Michaud &#60;pmichaud@pobox.com&#62; is the current author and maintainer.</p>
            </div> <!-- "mainbody" -->
            <div id="divider"></div>
            <div id="footer">
	        Copyright &copy; 2002-2009, Parrot Foundation.
            </div>
        </div> <!-- "wrapper" -->
    </body>
</html>
